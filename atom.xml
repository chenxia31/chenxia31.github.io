<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Chenxia&#39;s blog</title>
  
  
  <link href="https://blog.tjdata.site/atom.xml" rel="self"/>
  
  <link href="https://blog.tjdata.site/"/>
  <updated>2023-05-17T06:52:33.916Z</updated>
  <id>https://blog.tjdata.site/</id>
  
  <author>
    <name>chenxia</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>çŸ¥è¯†ç®¡ç†çš„ä¸€äº›æƒ³æ³•</title>
    <link href="https://blog.tjdata.site/posts/d49191c7.html"/>
    <id>https://blog.tjdata.site/posts/d49191c7.html</id>
    <published>2023-05-17T05:55:36.000Z</published>
    <updated>2023-05-17T06:52:33.916Z</updated>
    
    <content type="html"><![CDATA[<p>ä½œä¸ºä¸€æšINFJï¼Œç»å¸¸ä¼šå¯¹æ•ˆç‡å·¥å…·è¿›è¡Œåæ€ã€‚ä»Šå¤©çœ‹äº†ä¸€æœ¬å’ŒçŸ¥è¯†ç®¡ç†è”ç³»ä¸å¤§çš„ã€Šå¦‚ä½•æœ‰æ•ˆé˜…è¯»ä¸€æœ¬ä¹¦ã€‹ï¼Œç„¶åå¯¹è‡ªå·±ç°æœ‰çš„çŸ¥è¯†ç®¡ç†ç³»ç»Ÿä¸­å¤‡å¿˜å½•+æ—¥å†+æé†’äº‹é¡¹ï¼Œé…åˆShortCutå¿«é€Ÿè¾“å…¥ã€Cuboxèšé›†ã€Notionæ•´ç†çš„ä¸€å¥—ç³»ç»Ÿè¿›è¡Œæ•´ç†å’Œåæ€ã€‚ç»™å‡ºä¸‰ä¸ªæ ¸å¿ƒçš„è§‚ç‚¹ã€‚</p><span id="more"></span><h2 id="0x01-ç°æœ‰å·¥å…·ä½¿ç”¨æµç¨‹"><a class="markdownIt-Anchor" href="#0x01-ç°æœ‰å·¥å…·ä½¿ç”¨æµç¨‹"></a> 0x01 ç°æœ‰å·¥å…·ä½¿ç”¨æµç¨‹</h2><p>å¯¹äºç°ä»£äº’è”ç½‘çš„å·¥å…·çš„æ„Ÿå—æ˜¯ï¼Œå®ƒæ— å¤„ä¸åœ¨ï¼Œä½†æ˜¯åœ¨å…‰é²œäº®ä¸½çš„è¦†ç›–ç‡ä¹‹ä¸‹åè€Œæ›´åŠ æš´éœ²äº†å„ç§ä¿¡æ¯äº¤æ¢ä¸æµç•…çš„é—®é¢˜ã€‚ä½ åœ¨Appleæ—¥å†ä¸­è®¾ç½®çš„äº‹é¡¹å¾ˆéš¾åœ¨å®‰å“æ‰‹æœºä¸Šçœ‹åˆ°ï¼Œä½ åœ¨æ¨ç‰¹å‘çš„æ¨æ–‡å¾ˆéš¾è¢«åŒæ­¥åˆ°ä½ çš„å¤‡å¿˜å½•ï¼Œä½ åœ¨è±†ç“£æ”¶è—çš„ä¹¦ç±ä¹Ÿä¸ä¼šå‡ºç°åœ¨äºšé©¬é€Šçš„è´­ç‰©ä¸­ï¼Œä½ åœ¨PDFä¸­åšå‡ºçš„æ‰¹æ³¨ä¹Ÿéš¾å¯¼å‡ºåˆ°ä½ çš„Notionä¸­â€¦</p><p>ä¸ºäº†è§£å†³è¿™äº›ä¿¡æ¯äº¤æµçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦ç¡®å®šè‡ªå·±çš„å·¥ä½œæµWorkflowã€‚é€šè¿‡è‡ªèº«çš„æ§åˆ¶æ¥æ›´å¥½çš„ä½¿ç”¨å·¥å…·ã€‚å½“ç„¶å½“ä¸€ä¸ªé«˜æ•ˆçš„å·¥å…·å‡ºç°çš„æ—¶å€™ä½ ä¹Ÿä¼šå¼€å¿ƒçš„ï¼Œæ¯”å¦‚çœ‹åˆ°Warpä»£æ›¿iTermï¼Œæ—¶ä»£æ¯•ç«Ÿæ˜¯åœ¨å‘å±•çš„ã€‚ç”µå­å·¥å…·çš„ç”¨é€”ä¸»è¦æœ‰ä¸‰ä¸ªï¼š1. GTDæ—¥ç¨‹ç®¡ç†ã€2. ä¿¡æ¯æ”¶é›†ã€3. ä¿¡æ¯å¤„ç†</p><pre><code class=" mermaid">graphclassDef someclass fill:#f96A[GTD : Get thing done]:::someclassC(Calendar:Event)R(Reminder:ToDo Schedule)N(Notes)C--&gt;AR--&gt;AN--&gt;AN--&gt;CN--&gt;RB[çŸ¥è¯†æ”¶é›† Cubox]:::someclassW(Wechat Helper)API(Cubox API)ALF(Alfred)S(Short Cut)W--&gt;BAPI--&gt;BALF--&gt;BS--&gt;BNO[çŸ¥è¯†æ•´ç† Notion]:::someclassDB(Database)BD(Database2)DB--&gt;NOBD--&gt;NOOUTPUT(Blog):::someclassA--&gt;B--&gt;NO--&gt;OUTPUT</code></pre><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/image-20230517141343789.png" alt="æ€»çš„çŸ¥è¯†ç®¡ç†" /></p><p>æ¥ä¸‹æ¥ä»‹ç»ä¸€äº›åŸåˆ™ï¼š</p><ol><li>ä¸€å…ƒåŒ–åŸåˆ™ï¼šå¦‚æœåœ¨è¿™ä¸ªåœ°æ–¹æ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆå…¶ä»–åœ°æ–¹ä¹Ÿæ‰¾ä¸åˆ°</li><li>é¿å…æ— ç©·åŸåˆ™ï¼šæ”¶è—å¾ˆç®€å•ï¼Œä½†æ˜¯æ¸…ç©ºå¾ˆéš¾</li><li>å¤šæ€è€ƒï¼Œå¤šè¾“å‡ºï¼šä¸€ä»¶äº‹æƒ…åªæœ‰æˆ‘ä»¬ç»™åˆ«äººèƒ½å¤Ÿè®²æ¸…æ¥šçš„æ—¶å€™ï¼Œæˆ‘ä»¬è‡ªå·±æ‰èƒ½æ˜ç™½</li></ol><h2 id="0x02-ä¸€å…ƒåŒ–åŸåˆ™-gtdç³»ç»Ÿçš„å¯é æ€§"><a class="markdownIt-Anchor" href="#0x02-ä¸€å…ƒåŒ–åŸåˆ™-gtdç³»ç»Ÿçš„å¯é æ€§"></a> 0x02 ä¸€å…ƒåŒ–åŸåˆ™ â€“ GTDç³»ç»Ÿçš„å¯é æ€§</h2><p>GTDæ˜¯åœ¨ä¸€æœ¬ä¹¦ä¸­æå‡ºçš„æ¦‚å¿µï¼Œç”¨äºä¸ªäººçš„ä»»åŠ¡ç®¡ç†çš„ä¸€ç§æ–¹æ³•è®ºã€‚åŒæ ·è¿™é‡Œè¿˜ä¼šæœ‰å…¶ä»–å¾ˆå¤šçš„ä»»åŠ¡ç®¡ç†çš„æ–¹æ³•ã€‚æœ€æ ¸å¿ƒçš„è¦ç´ æ˜¯Get thing doneã€‚é‚£ä¹ˆå¦‚ä½•çŸ¥é“è‡ªå·±åšä»€ä¹ˆï¼Ÿä»€ä¹ˆæ—¶å€™å»åšå‘¢ï¼ŸåŸä¹¦ç»™å‡ºä½œè€…æ€è€ƒçš„è¿‡ç¨‹ï¼Œè¿™é‡Œä»‹ç»æˆ‘ç›®å‰æ‘¸ç´¢çš„å¯¹äºæ—¥å¸¸äº‹åŠ¡çš„åˆ†ç±»æ–¹æ³•å’Œå®è·µè§„åˆ™ã€‚</p><p>é¦–å…ˆäº‹é¡¹æ ¹æ®ä¸»è§‚å’Œå®¢è§‚å¯ä»¥åˆ†ä¸ºCalendarå’ŒReminderï¼Œè¿™ä¹Ÿæ˜¯ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«ï¼š</p><ol><li>Calendarï¼šæ—¥å†ä¸­å‘ç”Ÿçš„å¾€å¾€æ˜¯ä¸€ä»¶Eventsï¼ˆè¿™ä¹Ÿæ˜¯macOSä¸­çš„è‹±æ–‡ï¼‰ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ç§ä¸éšä¸ªäººæ„å¿—å‘ç”Ÿçš„äº‹æƒ…ã€‚æ¯”å¦‚å›½åº†èŠ‚ã€æ¯”å¦‚æœ‹å‹çš„ç”Ÿæ—¥ã€æ¯”å¦‚ä¸Šè¯¾ã€æ¯”å¦‚ä¸Šè¯¾çš„DDLã€‚è¿™äº›äº‹æƒ…çš„æœ€å¤§ç‰¹ç‚¹æ˜¯å‘ç”Ÿå®Œå°±ç»“æŸäº†ï¼Œä¸ä¼šæœ‰ä¸»åŠ¨æ‹–å»¶è¿™ä¸ªæ¦‚å¿µã€‚æ‰€ä»¥è¿™ä¸ªé€šå¸¸éœ€è¦ç¡®å®šä¸€ä¸ªæ—¶é—´ç‚¹</li><li>Reminderï¼šè¿™ä¸ªå‘ç”Ÿçš„æ˜¯æˆ‘ä»¬ä¸»è§‚æƒ³å»åšçš„äº‹æƒ…ï¼ˆItemï¼‰ï¼Œè¿™äº›äº‹é¡¹å¯ä»¥æ˜¯â€œå»ä¹°ä¸ªä¾¿åˆ©è´´â€â€œå®ŒæˆæŸä¸€ä»¶ä½œä¸šâ€â€œåœ¨DDLä¹‹å‰åšå®ŒPPTâ€</li></ol><p>ä½†æ˜¯å¯¹äºä¸åŒçš„æé†’äº‹é¡¹ä¹Ÿå¯ä»¥è¿›è¡Œåˆ†ç±»ï¼Œç»è¿‡å¯ä»¥ç»éªŒå¯ä»¥åˆ†ä¸º</p><ol><li>Scheduleï¼šæŒ‰ç…§æ—¶é—´æ’åºã€‚è§„åˆ’å¥½æ—¶é—´çš„äº‹æƒ…ï¼Œæ¯”å¦‚â€œæ˜å¤©æ—©ä¸Š9ç‚¹æ–°å»ºä¸€ä¸ªè®ºæ–‡æ–‡ä»¶å¤¹â€ã€‚åœ¨ä¹‹å‰å»ºç«‹ç³»ç»Ÿçš„æ—¶å€™ï¼Œå‡å¦‚scheduleè®¾ç½®å¤ªå¤šï¼Œå¾€å¾€ä¼šå¯¼è‡´è‡ªå·±å®Œä¸æˆè€Œé€æ¸æ‹–å»¶ï¼Œæ‰€ä»¥è¿™é‡Œå»ºè®®è®¡åˆ’ä¸€ä¸ªæ˜ŸæœŸä¼šæ¯”è¾ƒå¥½</li><li>To Do Listï¼šæŒ‰ç…§ä¼˜å…ˆçº§æ’åºã€‚è¿™é‡Œæ˜¯æƒ³åšçš„ï¼Œä½†æ˜¯æ²¡æœ‰è§„åˆ’å¥½æ—¶é—´çš„äº‹æƒ…ï¼Œæ¯”å¦‚è¯´â€œçœ‹ã€Šå¥¥æœ¬æµ·é»˜ã€‹â€ï¼Œè¿™ç±»äº‹æƒ…å¾€å¾€éœ€è¦æ„å»ºä¸€ä¸ªä¼˜å…ˆçº§ï¼Œå½“è‡ªå·±çš„Scheduleåšå®Œçš„æ—¶å€™ï¼Œå¯ä»¥ä»TODOä¸­åšèµ·ä¼˜å…ˆçº§é«˜çš„äº‹æƒ…</li><li>Deadlineï¼šæŒ‰ç…§æ—¶é—´æ’åºã€‚è¿™é‡Œå¾€å¾€æ˜¯ä¸€ä»¶äº‹æƒ…çš„ç»“æŸã€‚ä»£è¡¨çš„æ˜¯ä¸€ä¸ªè¿‡ç¨‹ã€‚æ¯”å¦‚â€œä¸‹å‘¨ä¸€äº¤ä½œä¸šâ€ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦æˆ‘ä»¬åœ¨â€œä¸‹å‘¨ä¸€â€è¿™ä¸ªæ—¶é—´ç‚¹å®Œæˆä½œä¸šï¼Œå¹¶æäº¤ï¼Œæˆ‘ä»¬ä¸å¯èƒ½ç­‰åˆ°ä¸‹å‘¨ä¸€å†å»å®Œæˆä½œä¸šã€‚æ‰€ä»¥è¿™ä¸ªå»ºè®®è®¾ç½®Flag</li></ol><p>åˆ°æ­¤ä¸ºæ­¢æˆ‘ä»¬çš„GTDç³»ç»Ÿå·²ç»å¯ä»¥å»ºç«‹èµ·æ¥äº†ï¼Œä½†æ˜¯è¿™ä¸ªç³»ç»Ÿå¾€å¾€ä¼šå—åˆ°å†²å‡»ï¼š</p><ol><li>ä¸å¯é æ€§ï¼Œæ”¶é›†åœ¨Calendarå’ŒReminderä¸­çš„äº‹é¡¹å¹¶ä¸å®Œå…¨ã€‚å¯¼è‡´æˆ‘ä»¬å¯¹ç³»ç»Ÿçš„ä¿¡ä»»åº¦ä¸é«˜ï¼Œç»å¸¸è¿˜ä¼šä¾é è‡ªå·±çš„å¤§è„‘æ¥å›å¿†äº‹æƒ…ã€‚</li><li>æ‡’æƒ°æ€§ï¼Œå‡å¦‚Scheduleçš„ä¸œè¥¿å¤ªå¤šï¼Œè€Œè‡ªå·±ä¸å»å®Œæˆï¼Œä¼šå¯¼è‡´ç³»ç»Ÿçš„ä»»åŠ¡è¶Šæ¥è¶Šå¤šè€Œå´©æºƒ</li><li>ç¼ºä¹æ¿€åŠ±æ€§ï¼Œæ²¡æœ‰åŠæ³•ç»™è‡ªå·±æ­£åé¦ˆï¼Œå¯¼è‡´ç³»ç»Ÿç»´æŠ¤å›°éš¾ã€‚</li></ol><p>è¿™é‡Œç»™å‡ºä¸€ä¸ªå»ºè®®ï¼šåœ¨å®è·µä¸­æˆ‘ä»¬è¦åšæŒä¸€å…ƒåŒ–çš„åŸåˆ™ï¼Œä¹Ÿå°±æ˜¯åœ¨å¾®ä¿¡æˆ–è€…å£å¤´ä¸Šè·å–ä¸€ä¸ªäº‹ä»¶ï¼Œå¯ä»¥ç«‹é©¬å°†å…¶æ·»åŠ åˆ°è‡ªå·±çš„inboxï¼Œç„¶åå†å¯¹å…¶åˆ†ç±»æ•´ç†ã€‚æˆ‘ä»¬è¦å……åˆ†ä¿¡ä»»è‡ªå·±çš„ç³»ç»Ÿï¼Œå› ä¸ºGTDä¸ä»…æ˜¯è®°å½•æˆ‘ä»¬åšäº†ä»€ä¹ˆï¼Œè¿˜æ˜¯ä¸€ä¸ªå¸®åŠ©æˆ‘ä»¬å¤§è„‘è®°å¿†çš„ç³»ç»Ÿã€‚å¦‚æœæˆ‘ä»¬é™·å…¥å›å¿†è‡ªå·±éœ€è¦åšä»€ä¹ˆçš„é­”å’’ä¸­ï¼Œå¾€å¾€ä¼šæ¶ˆè€—å¤§é‡çš„ç²¾åŠ›å’Œæ—¶é—´ã€‚</p><pre><code class=" mermaid">graph cal[Calendar] re[Reminder] E(Event sorted by time) S(Schedule sorted by time) T(To Do List sorted by priority) D(DeadLine sorted by time) cal --&gt; E re--&gt;S re--&gt;T re--&gt;D</code></pre><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/image-20230517143808590.png" alt="GTDç³»ç»Ÿ" /></p><h2 id="0x03-é¿å…æ— ç©·æ”¶è—cubox"><a class="markdownIt-Anchor" href="#0x03-é¿å…æ— ç©·æ”¶è—cubox"></a> 0x03 é¿å…æ— ç©·æ”¶è—ï¼šCubox</h2><p>äº’è”ç½‘å°†çŸ¥è¯†ä¸²è”åœ¨ä¸€èµ·çš„åæœæ˜¯æˆ‘ä»¬å¯ä»¥æ— é™çš„æ»‘åŠ¨ï¼Œæˆ‘ä»¬æ°¸è¿œçœ‹ä¸å®ŒGoogleæœç´¢çš„ç»“æœã€çœ‹ä¸å®Œå¾®åšçš„å¸–å­ã€çœ‹ä¸å®Œå•†å“çš„ç®€ä»‹â€¦åœ¨çŸ¥è¯†ç®¡ç†ä¹Ÿæ˜¯è¿™æ ·ã€‚äº’è”ç½‘å¸¦æ¥çš„æœ‰ç”¨çš„çŸ¥è¯†ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå½“æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªæœ‰æ„æ€çš„å¾®ä¿¡æ–‡ç« ã€æˆ–è€…è¯±äººçš„åšå®¢ã€æˆ–è€…æ˜¯Bç«™å¤§å­¦çš„è¯¾ç¨‹ï¼Œå¾€å¾€ä¼šä¸¢åˆ°è‡ªå·±çš„æ”¶è—å¤¹ä¸­ï¼Œç„¶åä¸åŒè½¯ä»¶ä¸­çš„æ”¶è—å¤¹å¹¶ä¸ä¼šäº’ç›¸æ²Ÿé€šï¼Œå”¯ä¸€çš„å…±åŒç‚¹æ˜¯é€æ¸å¢åŠ ä½†æ˜¯ä»ä¸æ¸…ç©ºã€‚</p><p>æ‰€ä»¥å°†æ”¶é›†ç®±å¡«æ»¡åªæ˜¯èµ·ç‚¹ï¼Œç»ˆç‚¹æ˜¯è®©æ”¶é›†ç®±å›å½’ç©ºçš„çŠ¶æ€ã€‚åŒæ ·ä¸ºäº†éµå¾ªâ€œä¸€å…ƒåŒ–â€åŸåˆ™ï¼Œå¸Œæœ›å¯ä»¥å°†æ‰€æœ‰çš„çŸ¥è¯†å’Œè‡ªå·±çš„æƒ³æ³•æ”¶é›†åˆ°ä¸€ä¸ªåœ°æ–¹ã€‚å¹¶ä¸æƒ³å‘ç”Ÿåœ¨å¾®ä¿¡æ”¶è—çœ‹æ–‡ç« ã€åœ¨Bç«™çœ‹è§†é¢‘ã€åœ¨å¾®ä¿¡è¯»ä¹¦è¯»æƒ³è¯»çš„ä¹¦ã€åœ¨æµè§ˆå™¨çœ‹è‡ªå·±çš„read listï¼Œè¿™æ ·çš„åŠ£åŠ¿æ˜¯ä¸èƒ½æ•´ç†ã€‚ä»¿ä½›çœ‹å®Œä¹‹åå°±ç»“æŸäº†ã€‚</p><p>å€ŸåŠ©Cuboxå¯ä»¥é€šè¿‡éšæœºå›é¡¾æ¥çœ‹è‡ªå·±æ›¾ç»åšè¿‡ä»€ä¹ˆæ‰¹æ³¨ï¼Œå¯ä»¥å°†çœ‹å®Œçš„ä¸œè¥¿åˆ†ç±»æ”¾åˆ°æ¶å­ï¼ˆæ–‡ä»¶å¤¹ï¼‰ä¸­æ—¥åæµè§ˆï¼Œä¹Ÿå¯ä»¥å°†æ²¡æœ‰è¥å…»çš„å½’æ¡£æˆ–è€…åˆ é™¤ã€‚Reviewæ‰æ˜¯ç»ˆç‚¹ï¼</p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/image-20230517144317271.png" alt="Cubox å¿«æ·æŒ‡ä»¤" /></p><h2 id="0x04-è¾“å‡ºå’Œall-in-onenotion"><a class="markdownIt-Anchor" href="#0x04-è¾“å‡ºå’Œall-in-onenotion"></a> 0x04 è¾“å‡ºå’ŒAll in oneï¼šNotion</h2><p>é¦–å…ˆNotionä½œä¸ºçŸ¥è¯†ç®¡ç†çš„ç»ˆç‚¹ç«™åœ¨äºå…¶å¼€æ”¾ï¼Œå®ƒå…·æœ‰å’Œå…¶ä»–ç³»ç»Ÿè”åˆå¹¶å¼€æ”¾APIï¼Œè¿™æ ·çš„å¼€æ”¾æ€§å¯¼è‡´å…¶å¯ä»¥ç»¼åˆå…¶ä»–å†…å®¹ã€‚ç”±æ­¤å¾—åˆ°çš„åæœæ˜¯å…¶å¯ä»¥ä½œä¸ºæ‰€æœ‰çŸ¥è¯†æ”¶é›†å·¥å…·çš„ç»ˆç‚¹ï¼ŒåŒæ ·å®ƒä¹Ÿæ˜¯éå¸¸å¥½çš„ç¼–è¾‘å™¨ã€‚</p><p>Databseæ˜¯å…¶æœ€å…·ç‰¹è‰²çš„ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒçš„å±æ€§æ¥å¯¹é¡µé¢è¿›è¡Œåˆ†ç±»æ•´ç†ï¼Œå°†å…·æœ‰å…³ç³»çš„é¡µé¢æ ¹æ®Filteræˆ–Groupæ¥é›†èšï¼Œæ¥è¾¾åˆ°è‡ªå·±ç³»ç»Ÿç®¡ç†çš„ç›®çš„ã€‚</p><p>ä½†æ˜¯åŒæ ·çš„åœ¨æœ€ç»ˆï¼Œåœ¨æ˜ç™½äº†è‡ªå·±éœ€è¦åšä»€ä¹ˆã€åœ¨è‡ªå·±æ”¶é›†å¾ˆå¤šçŸ¥è¯†ä¹‹åï¼Œè€ƒè™‘å¦‚ä½•å°†å…¶è®²æ˜ç™½ï¼Œå†™å‡ºä¸€ä»½ç»™åˆ«äººçœ‹çš„åšå®¢æ‰æ˜¯è·å–çŸ¥è¯†çš„æœ€ç»ˆé€”å¾„ï½</p><p>å…±å‹‰</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä½œä¸ºä¸€æšINFJï¼Œç»å¸¸ä¼šå¯¹æ•ˆç‡å·¥å…·è¿›è¡Œåæ€ã€‚ä»Šå¤©çœ‹äº†ä¸€æœ¬å’ŒçŸ¥è¯†ç®¡ç†è”ç³»ä¸å¤§çš„ã€Šå¦‚ä½•æœ‰æ•ˆé˜…è¯»ä¸€æœ¬ä¹¦ã€‹ï¼Œç„¶åå¯¹è‡ªå·±ç°æœ‰çš„çŸ¥è¯†ç®¡ç†ç³»ç»Ÿä¸­å¤‡å¿˜å½•+æ—¥å†+æé†’äº‹é¡¹ï¼Œé…åˆShortCutå¿«é€Ÿè¾“å…¥ã€Cuboxèšé›†ã€Notionæ•´ç†çš„ä¸€å¥—ç³»ç»Ÿè¿›è¡Œæ•´ç†å’Œåæ€ã€‚ç»™å‡ºä¸‰ä¸ªæ ¸å¿ƒçš„è§‚ç‚¹ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Memo" scheme="https://blog.tjdata.site/categories/Memo/"/>
    
    
    <category term="çŸ¥è¯†ç®¡ç†" scheme="https://blog.tjdata.site/tags/%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäºJSçš„Mermaidä½¿ç”¨æ•™ç¨‹</title>
    <link href="https://blog.tjdata.site/posts/3be9bc5f.html"/>
    <id>https://blog.tjdata.site/posts/3be9bc5f.html</id>
    <published>2023-05-16T01:25:31.000Z</published>
    <updated>2023-05-16T03:28:41.541Z</updated>
    
    <content type="html"><![CDATA[<p>å…³äºæµç¨‹å›¾çš„ç»˜åˆ¶ä¸­æœ‰å¾ˆå¤šå·¥å…·ï¼Œæ¯”å¦‚å¾®è½¯çš„visio æˆ–è€… PowerPointã€è´å°”çš„Graphvizã€Lucidchartã€OmniGraffleã€<a href="http://Draw.io">Draw.io</a>ã€processOnã€Latexçš„tikZï¼›ä½†æ˜¯è¿™ç§åŸºäºå›¾å½¢ç•Œé¢çš„æ“ä½œå¾€å¾€ä¼šå—é™äºäººæœ¬èº«çš„ä¸ç²¾ç¡®å¯¼è‡´ä¸å¥½çœ‹ã€‚æ‰€ä»¥å¸Œæœ›å€ŸåŠ©ä»£ç ç”Ÿæˆæµç¨‹å›¾æ¥å°½å¯èƒ½ä¿æŒåè°ƒä¸€è‡´çš„ç¾è§‚ã€‚</p><span id="more"></span><h2 id="0x01-ä½¿ç”¨æ•™ç¨‹"><a class="markdownIt-Anchor" href="#0x01-ä½¿ç”¨æ•™ç¨‹"></a> 0x01 ä½¿ç”¨æ•™ç¨‹</h2><p>å¯ä»¥ç›´æ¥åœ¨Typoraä¸­ä½¿ç”¨ï¼Œåªéœ€è¦è¾“å…¥å³å¯</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">``` mermaid<br></code></pre></td></tr></table></figure><p>ä»€ä¹ˆæ˜¯<a href="https://mermaid.js.org/intro/">Mermaid</a>ï¼ŒæŒ‰ç…§å®˜ç½‘çš„å®šä¹‰æ˜¯<strong>åŸºäºJavaScript</strong>çš„å›¾è¡¨å·¥å…·ï¼Œå¯ä»¥æ¸²æŸ“å—markdownå¯å‘çš„æ–‡æœ¬å®šä¹‰ï¼Œç”¨äºåŠ¨æ€åˆ›å»ºå’Œä¿®æ”¹å›¾è¡¨ã€‚å…¶åŸºæœ¬çš„è¯­æ³•ç»“æ„åŒ…æ‹¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs merm"># Diagrams definitions begin with a declaration of the diagram type<br># Define the blocks<br># Link the blocks<br><br></code></pre></td></tr></table></figure><pre><code class=" mermaid">erDiagram          CUSTOMER &#125;|..|&#123; DELIVERY-ADDRESS : has          CUSTOMER ||--o&#123; ORDER : places          CUSTOMER ||--o&#123; INVOICE : &quot;liable for&quot;          DELIVERY-ADDRESS ||--o&#123; ORDER : receives          INVOICE ||--|&#123; ORDER : covers          ORDER ||--|&#123; ORDER-ITEM : includes          PRODUCT-CATEGORY ||--|&#123; PRODUCT : contains          PRODUCT ||--o&#123; ORDER-ITEM : &quot;ordered in&quot;</code></pre><p>å¸¸è§çš„è¡¨æ ¼å¯ä»¥åˆ†ä¸ºï¼šæµç¨‹å›¾Flowchartã€é¡ºåºå›¾Sequence Diagramã€ç±»å›¾Class Diagramã€çŠ¶æ€å›¾State Diagramã€å®ä½“å…³ç³»å›¾Entity Relationship Diagramã€ç”˜ç‰¹å›¾Ganttã€é¥¼å›¾Pie chartã€éœ€æ±‚å›¾Requirement Diagramã€GitGraphã€C4Cå›¾ã€æ€ç»´å¯¼å›¾Mindmapsã€æ—¶é—´çº¿Timelines</p><h2 id="0x02-æµç¨‹å›¾-flowchart"><a class="markdownIt-Anchor" href="#0x02-æµç¨‹å›¾-flowchart"></a> 0x02 æµç¨‹å›¾ Flowchart</h2><p>æµç¨‹å›¾ç”±èŠ‚ç‚¹ (Nodes)ã€å½¢çŠ¶ (Edges)ã€ç®­å¤´ ï¼ˆArrowsï¼‰å’Œçº¿æ¡ï¼ˆLinesï¼‰ç»„æˆï¼Œåº”ç”¨ç¤ºä¾‹</p><pre><code class=" mermaid">flowchart id1(This is the text in the node1)id2[This is the text in the node2]db1[(database)]id1 --&gt; id2db1 --&gt; id1</code></pre><pre><code class=" mermaid">%% TB : top to bottom,TD%% BT: bottom to top%% RL: right to left%% LR: left to rightflowchart LR  subgraph BT[Define of the nodes]      id1(åœ†è§’)      id2([æ›´å¤§çš„åœ†è§’])      id3[é•¿æ–¹å½¢]      id4[(æ•°æ®åº“)]      id5((åœ†å½¢))      id6&gt;what]      id7&#123;æ–¹å½¢&#125;      id8&#123;&#123;è§’&#125;&#125;      id10[\æ¢¯å½¢ Trapezoid alt/] end  subgraph LR[define of the linkes]    id11[node1]    id12[node2]    id11 --&gt; id12    id11 --- id12    id11 -- Text ---id12    id11 ---|Text|id12    id11--&gt;|Text|id12    id11 -.-&gt; id12    id11 -. text .-&gt; id12    A == text ==&gt; id12    a --&gt;b &amp; c--&gt;d end  subgraph LR B[start] C&#123;Is it?&#125; B --&gt;|yes|C C--&gt;D[rethink] D--&gt;B B--&gt;|No|E[End] E[perhaps?]   end</code></pre><h2 id="0x03-æ—¶åºå›¾-sequence-diagrams"><a class="markdownIt-Anchor" href="#0x03-æ—¶åºå›¾-sequence-diagrams"></a> 0x03 æ—¶åºå›¾ Sequence diagrams</h2><p>æ—¶åºå›¾è¡¨ç¤ºç”¨æˆ·ä¹‹é—´ç›¸äº’äº¤æµçš„è¿‡ç¨‹çš„å›¾è¡¨ï¼Œå…¶ä¸­çš„è¯­æ³•ä¸»è¦åŒ…æ‹¬ï¼šå‚ä¸è€…ï¼ˆParticipantï¼‰ã€æ¼”å‘˜ï¼ˆActorï¼‰ã€åˆ«åï¼ˆAliasï¼‰ã€åˆ†ç»„ï¼ˆGroup and boxï¼‰ã€ä¿¡æ¯ï¼ˆArrows and linesï¼‰ã€æ¿€æ´»ï¼ˆActivateï¼‰ã€å¤‡æ³¨ï¼ˆNotesï¼‰ã€å¾ªç¯ï¼ˆLoopï¼‰</p><pre><code class=" mermaid">sequenceDiagram  participant A as Alice    participant B as Bob    participant J as JohnA-&gt;&gt;B:hello JohnB-&gt;&gt;J:Great!</code></pre><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs diff">[Actor][Arrow][Actor]:Message Text<br><span class="hljs-deletion">-&gt; å®çº¿</span><br><span class="hljs-deletion">--&gt; æ²¡æœ‰ç®­å¤´çš„ç‚¹ç”»çº¿</span><br><span class="hljs-deletion">-&gt;&gt; ç®­å¤´çº¿</span><br><span class="hljs-deletion">--&gt;&gt; ç®­å¤´ç‚¹ç”»çº¿</span><br><span class="hljs-deletion">-X corss</span><br><span class="hljs-deletion">--X ç‚¹çº¿å¸¦cross</span><br><span class="hljs-deletion">-ï¼‰</span><br><span class="hljs-deletion">--ï¼‰</span><br></code></pre></td></tr></table></figure><pre><code class=" mermaid">sequenceDiagram    Alice-&gt;John: Hello John, how are you?    activate John    loop Every minute        John--&gt;Alice: Great!    end    deactivate John</code></pre><p>åˆæ¬¡ä¹‹å¤–é¡ºåºå›¾è¿˜éœ€è¦è¡¨ç¤ºä¸€äº›åŸºæœ¬çš„é€»è¾‘æ¦‚å¿µï¼Œæ¯”å¦‚æ¿€æ´»ï¼ˆActivateï¼‰ã€å¾ªç¯ï¼ˆLoopï¼‰ã€æ›¿ä»£ï¼ˆAltï¼‰ã€å¹³è¡Œï¼ˆParï¼‰ã€å…³é”®åŒºåŸŸï¼ˆCriticalï¼‰ã€Breakã€é«˜äº®æ˜¾ç¤ºï¼ˆRectï¼‰</p><pre><code class=" mermaid">sequenceDiagram    participant Alice    participant John    rect rgb(191, 223, 255)    note right of Alice: Alice calls John.    Alice-&gt;&gt;+John: Hello John, how are you?    rect rgb(200, 150, 255)    Alice-&gt;&gt;+John: John, can you hear me?    John--&gt;&gt;-Alice: Hi Alice, I can hear you!    end    John--&gt;&gt;-Alice: I feel great!    end    Alice -&gt;&gt;+ John: Did you want to go to the game tonight?    John --&gt;&gt;- Alice: Yeah! See you there.</code></pre><pre><code class=" mermaid">sequenceDiagramparticipant C as Clientparticipant S as Serverautonumbernote left of C: é€‰æ‹©åˆå§‹seq number=x&lt;br/&gt;å‘é€å®¢æˆ·ç«¯çš„TCP SYNæ®µC-&gt;&gt;S:SYNbit=1,Seq=Xnote right of S:é€‰æ‹©åˆå§‹seq number=y&lt;br/&gt;å‘é€æœåŠ¡ç«¯TCP SYNä¿¡æ¯&lt;br/&gt;åˆ©ç”¨SYN+1ä½œä¸ºå›å¤S-&gt;&gt;C:SYNbit=1,Seq=Y&lt;br/&gt;ACKbit=1,ACKnum=x+1note left of C:æ”¶åˆ°SYNACK(x),ç¡®è®¤æœåŠ¡å™¨å­˜åœ¨&lt;br/&gt;å‘é€ACKå›å¤SYNACK&lt;br/&gt;ä¸åŒ…å«client-to-serveræ•°æ®C-&gt;&gt;S:ACKbit=1,ACKnum=y+1note right of S:æ”¶åˆ° ACK(y)&lt;br/&gt;ç¡®è®¤ç”¨æˆ·å­˜åœ¨</code></pre><p><a href="https://zhuanlan.zhihu.com/p/53374516">https://zhuanlan.zhihu.com/p/53374516</a></p><h2 id="0x04-gitgraph"><a class="markdownIt-Anchor" href="#0x04-gitgraph"></a> 0x04 GitGraph</h2><pre><code class=" mermaid">gitGraphcommit id: &quot;Set up folder&quot;branch releasebranch developmentcheckout developmentcommitbranch feature01commit id:&quot;feature1 add&quot;commit id:&quot;feature1 add2&quot;checkout developmentbranch feature02commit id:&quot;fixed feature2&quot;checkout developmentmerge feature02commit id:&quot;feature1 add3&quot;checkout developmentmerge feature01commitcheckout mainmerge development tag:&quot;Beta1.0&quot;checkout releasemerge main tag:&quot;V1.0&quot;</code></pre>]]></content>
    
    
    <summary type="html">&lt;p&gt;å…³äºæµç¨‹å›¾çš„ç»˜åˆ¶ä¸­æœ‰å¾ˆå¤šå·¥å…·ï¼Œæ¯”å¦‚å¾®è½¯çš„visio æˆ–è€… PowerPointã€è´å°”çš„Graphvizã€Lucidchartã€OmniGraffleã€&lt;a href=&quot;http://Draw.io&quot;&gt;Draw.io&lt;/a&gt;ã€processOnã€Latexçš„tikZï¼›ä½†æ˜¯è¿™ç§åŸºäºå›¾å½¢ç•Œé¢çš„æ“ä½œå¾€å¾€ä¼šå—é™äºäººæœ¬èº«çš„ä¸ç²¾ç¡®å¯¼è‡´ä¸å¥½çœ‹ã€‚æ‰€ä»¥å¸Œæœ›å€ŸåŠ©ä»£ç ç”Ÿæˆæµç¨‹å›¾æ¥å°½å¯èƒ½ä¿æŒåè°ƒä¸€è‡´çš„ç¾è§‚ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Baseline" scheme="https://blog.tjdata.site/categories/Baseline/"/>
    
    
    <category term="chart" scheme="https://blog.tjdata.site/tags/chart/"/>
    
  </entry>
  
  <entry>
    <title>GITç®¡ç†å’Œå¸¸è§æ“ä½œ</title>
    <link href="https://blog.tjdata.site/posts/cd758988.html"/>
    <id>https://blog.tjdata.site/posts/cd758988.html</id>
    <published>2023-05-09T07:24:09.000Z</published>
    <updated>2023-05-13T13:48:46.048Z</updated>
    
    <content type="html"><![CDATA[<p>ä»<a href="https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell">Git - Branches in a Nutshell</a>ä¸­çœ‹Gitçš„ä¸€äº›å¸¸è§æ“ä½œï¼Œä¸»è¦æ˜¯è®¾è®¡ç†å¿µå’Œæœ¬åœ°çš„æ“ä½œã€‚æ›´å¤æ‚çš„è¿œç¨‹åä½œå’Œé¡¹ç›®ç®¡ç†åç»­ç»™å‡ºã€‚</p><span id="more"></span><p>Git PRO</p><h2 id="what-is-git"><a class="markdownIt-Anchor" href="#what-is-git"></a> What is git</h2><p>åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆå…·æœ‰å¾ˆå¤šä¼˜ç‚¹å·´æ‹‰å·´æ‹‰ï¼‰</p><p>å‡ ä¸ªæ˜¾è‘—çš„æŠ€æœ¯ä¸Šçš„ç‰¹ç‚¹ï¼š</p><ol><li>snapshotï¼Œnot differencesï¼Œno delta- based system<ol><li>Git thinks of tis data more like a series of a snapshots of a miniature filesystem</li><li>every time you commit, or save the state of your project, Git basically takes a picture of what all your files look like at that moment and stores a reference to that snapshot. If the data is not changed , Git doesnâ€™t store the file again.</li></ol></li><li>Nearly every operation is local<ol><li>you have the entire history of the project right there on your local disk, most operations seem almost instantaneous</li><li>commit to local copy util you get to a network connection to upload</li></ol></li><li>Git has integrity<ol><li>you will see these hash values all over the place in Git because it uses them so much. In fact, Git stores everything in its database not by file name but 40 cahrs</li></ol></li><li>Git generally only adds data<ol><li>When you do actions in Git, nearly all over the place in Git because it uses them so much.  It is hard to get the system to do anything that is not undoable or to make it erase in any way</li></ol></li><li>three state<ol><li>modified</li><li>staged</li><li>committed</li></ol></li></ol><p>åŸºæœ¬çš„å·¥ä½œæµç¨‹å¯ä»¥çœ‹ä½œï¼š</p><ol><li>ä¿®æ”¹working directoryçš„æ–‡ä»¶</li><li>å½“æ—¶è§‰å¾—åšçš„å¤Ÿå¥½ä¹‹åï¼Œadd changed to the staging area</li><li>å°†æ‰€æœ‰æš‚å­˜åŒºçš„æ–‡ä»¶æäº¤ï¼Œstores that snapshot permanently to your Git directory</li></ol><h3 id="getting-start-first-time-git-setup"><a class="markdownIt-Anchor" href="#getting-start-first-time-git-setup"></a> Getting start â€”- First time git setup</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># git config å­˜å‚¨çš„ä¸‰ä¸ªåœ°æ–¹</span><br>[path]/etc/gitconfigï¼šåŒ…å«åº”ç”¨äºç³»ç»Ÿä¸Šæ¯ä¸ªç”¨æˆ·åŠå…¶æ‰€æœ‰å­˜å‚¨åº“çš„å€¼ï¼Œå¦‚æœä½ è®²é€‰é¡¹ systemä¼ é€’ç»™<br>å®ƒä¼šä»ä¸“é—¨çš„æ–‡ä»¶ä¸­è¯»å–å’Œå†™å…¥<br><br>~/.gitconfig æˆ–è€… ï½/.config/git/config ç‰¹å®šç”¨æˆ·ä¸ªäººçš„åº“<br><br>config å½“å‰å­˜å‚¨ç›®å½•çš„å‘ƒè®¾ç½®<br></code></pre></td></tr></table></figure><h2 id="basic-topic"><a class="markdownIt-Anchor" href="#basic-topic"></a> Basic topic</h2><h3 id="31-è·å–gitä»“åº“"><a class="markdownIt-Anchor" href="#31-è·å–gitä»“åº“"></a> 3.1 è·å–Gitä»“åº“</h3><p>ä¸€ç§æ–¹å¼æ˜¯å°†å½“å‰ä¸å—ç‰ˆæœ¬æ§åˆ¶çš„æœ¬åœ°ç›®å½•è½¬æ¢ä¸ºGitå­˜å‚¨åº“</p><p>ç¬¬äºŒç§æ–¹å¼æ˜¯ä»å…¶ä»–åœ°æ–¹cloneç°æœ‰çš„Gitä»“åº“</p><h3 id="32-è®°å½•æ›´æ”¹"><a class="markdownIt-Anchor" href="#32-è®°å½•æ›´æ”¹"></a> 3.2 è®°å½•æ›´æ”¹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">git status<br>git status -s <span class="hljs-comment"># for short</span><br></code></pre></td></tr></table></figure><p>å·¥ä½œç›®å½•ä¸­æ¯ä¸ªæ–‡ä»¶éƒ½å­˜åœ¨ tracked or  untracked</p><p>ä»ç”Ÿå‘½å‘¨æœŸæ¥çœ‹ï¼Œæ–‡ä»¶å¯ä»¥åˆ†ä¸ºuntrackedã€unmodifiedã€modifiedã€staged</p><aside> ğŸ’¡ Githubå°†é»˜è®¤è½¬æ¢ä¸ºmainã€ä½†æ˜¯gité»˜è®¤ä¾æ—§æ˜¯master</aside><p>åŒæ—¶å¯ä»¥è®¾ç½®gitignoreæ¥ä¸å¸Œæœ›Gitè‡ªåŠ¨æ·»åŠ ï¼Œç”šè‡³é™åˆ¶æ‚¨æœªè¿½è¸ª</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å¸¸è§çš„gitignoreè§„åˆ™</span><br><span class="hljs-number">1.</span> å¿½ç•¥ç©ºç™½è¡Œæˆ–è€… <span class="hljs-comment">#</span><br><span class="hljs-number">2.</span> åœ¨æ•´ä¸ªå·¥ä½œç›®å½•ä¸­é€’å½’<br><span class="hljs-number">3.</span> å¯ä»¥ä½¿ç”¨æ­£æ–œæ  / å¼€å§‹æ¨¡å¼<br><span class="hljs-number">4.</span> å¯ä»¥ä½¿ç”¨æ­£æ–œæ  / ç»“æŸæ¨¡å¼æ¥æŒ‡å®šç›®å½•<br><span class="hljs-number">5.</span> å¯ä»¥é€šè¿‡æ„Ÿå¹å· ï¼ æ¥å¦å®šæ¨¡å¼<br></code></pre></td></tr></table></figure><p>GitHubä¸­ç»´æŠ¤äº†ä¸€ä¸ªéå¸¸å¥½çš„ç¤ºä¾‹<a href="https://github.com/github/gitignore">https://github.com/github/gitignore</a></p><p>ä»…ä»…æŸ¥çœ‹æ›´æ”¹è®°å½•ä¸å¤Ÿï¼Œä½ å¸Œæœ›æ£€æŸ¥æ›´æ”¹äº†å“ªäº›ä¸œè¥¿</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">git diff <span class="hljs-comment"># æŸ¥çœ‹æ›´æ”¹ä½†æ˜¯æœªæš‚å­˜</span><br>git diff --staged <span class="hljs-comment"># æŸ¥çœ‹å·²ç»æäº¤ä¸‹ä¸€ä¸ªé˜¶æ®µçš„å†…å®¹ï¼Œæˆ–è€…-- cached</span><br></code></pre></td></tr></table></figure><p>æäº¤è®°å½•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">git commit<br></code></pre></td></tr></table></figure><p>ä»Gitä¸­åˆ é™¤æ–‡ä»¶å¿…é¡»å°†å…¶ä»trackedæ–‡ä»¶ä¸­åˆ é™¤ï¼Œä¹Ÿå°±æ˜¯éœ€è¦ä»æš‚å­˜åŒºä¸­åˆ é™¤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">git rm<br>git rm - cached FILENAME <span class="hljs-comment"># å°†æ–‡ä»¶ä¿å­˜åœ¨ç›®å½•ä¸­ï¼Œä¾æ—§ä¿ç•™åœ¨ç¡¬ç›˜ã€‚ä½†æ˜¯ä»æš‚å­˜åŒºä¸­åˆ é™¤ã€‚</span><br>git mv <span class="hljs-comment"># é‡å‘½åæ–‡ä»¶</span><br></code></pre></td></tr></table></figure><h3 id="33-æŸ¥çœ‹æäº¤çš„å†å²è®°å½•"><a class="markdownIt-Anchor" href="#33-æŸ¥çœ‹æäº¤çš„å†å²è®°å½•"></a> 3.3 æŸ¥çœ‹æäº¤çš„å†å²è®°å½•</h3><p>ä¸Šè¿°æ“ä½œå¯ä»¥å®ŒæˆåŸºæœ¬çš„å·¥ä½œæµã€‚åœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œåˆ›å»ºå¾ˆå¤šæ¬¡æäº¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç°æœ‰æäº¤å†å²è®°å½•çš„å­˜å‚¨åº“ï¼Œå›é¡¾ä¸€ä¸‹å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨git log</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">git log <span class="hljs-comment"># æŒ‰ç…§åå‘æ—¶é—´é¡ºåºåˆ—å‡ºæäº¤çš„æ›´æ”¹ã€‚åŒæ—¶ä¹Ÿå…·æœ‰å¤§é‡é€‰é¡¹</span><br>git log -p <span class="hljs-comment"># æ˜¾ç¤ºæ¯ä¸ªæäº¤ä¸­å¼•å…¥çš„å·®å¼‚</span><br>git log --stat <span class="hljs-comment"># ç¼©å†™çš„ç»Ÿè®¡ä¿¡æ¯</span><br>git log --pretty=oneline <span class="hljs-comment"># å°†æ—¥å¿—è¾“å‡ºæ›´æ”¹ä¸ºé»˜è®¤æ ¼å¼ä»¥ä¸ºçš„æ ¼å¼</span><br>git log --pretty=<span class="hljs-built_in">format</span> --graph<br></code></pre></td></tr></table></figure><h3 id="34-æ’¤é”€æ“ä½œ"><a class="markdownIt-Anchor" href="#34-æ’¤é”€æ“ä½œ"></a> 3.4 æ’¤é”€æ“ä½œ</h3><p>åœ¨ä»»ä½•stagedï¼Œä½ éƒ½å›°éš¾æƒ³æ’¤é”€ä¸€äº›äº‹æƒ…ï¼Œé€šè¿‡å›é¡¾ä¸€äº›åŸºæœ¬å·¥å…·æ¥ä¿å­˜æ’¤é”€çš„æ›´æ”¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">git commit -amend <span class="hljs-comment"># å¦‚æœä½ æƒ³é‡åšè¯¥æäº¤ï¼Œè¯·ä½ å¿˜è®°é¢å¤–çš„æ›´æ”¹ï¼Œæš‚å­˜ä»–ä»¬</span><br></code></pre></td></tr></table></figure><p>åŠ å…¥åœ¨ä¿®æ”¹ä¸¤ä¸ªæ–‡ä»¶ä¹‹åï¼Œä¸å°å¿ƒadd * åˆ°æš‚å­˜åŒº</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">$ git add *<br>$ git status<br>On branch master<br>Changes to be committed:<br>  (use <span class="hljs-string">&quot;git restore --staged &lt;file&gt;...&quot;</span> to unstage)<br>modified:   CONTRIBUTING.md<br>renamed:    README.md -&gt; README<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯åªæƒ³commitå…¶ä¸­çš„ä¸€ä¸ªï¼Œé‚£ä¹ˆéœ€è¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">git reset HEAD [filename you <span class="hljs-keyword">not</span> to commit]<br></code></pre></td></tr></table></figure><p>æ³¨æ„resetæ˜¯éå¸¸å±é™©çš„å‘½ä»¤ï¼Œcheckoutä¹Ÿå¯ä»¥å®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">git checkout --&lt;file&gt; <span class="hljs-comment"># å¯¹æ–‡ä»¶æ‰€åšçš„ä»»ä½•æœ¬åœ°æ›´æ”¹éƒ½å·²ç»æ¶ˆå¤±ï¼Œæ›¿æ¢æˆä¸ºæœ€åä¸€ä¸ªåˆ†é˜¶æ®µæˆ–è€…æäº¤çš„ç‰ˆæœ¬ã€‚</span><br></code></pre></td></tr></table></figure><p>åœ¨ä¹‹åå¸¸ç”¨git restoreè€Œä¸æ˜¯git reset</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">git restore --staged &lt;file&gt; <span class="hljs-comment"># å–æ¶ˆæš‚å­˜</span><br></code></pre></td></tr></table></figure><h3 id="35-è¿œç¨‹æ“ä½œ"><a class="markdownIt-Anchor" href="#35-è¿œç¨‹æ“ä½œ"></a> 3.5 è¿œç¨‹æ“ä½œ</h3><p>originæ˜¯Gitèµ‹äºˆæ‚¨å…‹éš†çš„æœåŠ¡å™¨çš„é»˜è®¤åç§°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">git clone [your-git-url]<br>git remote <span class="hljs-comment"># show your remote git name</span><br>git remote -v <span class="hljs-comment"># æ˜¾ç¤ºå­˜å‚¨çš„URL</span><br>git remote add shortname url <span class="hljs-comment"># git remote add pb &lt;https://github.com/chenxia31/blog&gt;</span><br><span class="hljs-comment">#  common lineä¸­å¯ä»¥ä½¿ç”¨short nameæ¥ä»£æ›¿url</span><br></code></pre></td></tr></table></figure><p>ä»è¿œç¨‹ä»“åº“è¿æ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">git fetch &lt;remote&gt; <span class="hljs-comment"># ä»è¿œç¨‹ä»“åº“è·å–æ•°æ®</span><br>git push origin master <span class="hljs-comment"># æ¨é€æœ¬åœ°çš„masteråˆ†æ”¯</span><br>git remote show origin <span class="hljs-comment"># æ˜¾ç¤ºä¸€äº›å¸¸è§çš„ä¿¡æ¯</span><br>git remote rename [oldname] [newname]<br>git remote remove [url]<br></code></pre></td></tr></table></figure><h3 id="36-æ ‡ç­¾"><a class="markdownIt-Anchor" href="#36-æ ‡ç­¾"></a> 3.6 æ ‡ç­¾</h3><p>å’Œbranchè·Ÿè¸ªæ¯æ¬¡æœ€æ–°çš„commit ç›¸åï¼Œtagæ˜¯è·Ÿè¸ªæŸä¸€ä¸ªç‰¹å®šcommitçš„ä½ç½®ï¼Œå¦‚æœä¸éœ€è¦æ”¹åŠ¨è€Œä»…æŸ¥çœ‹çš„æ—¶å€™å¯ä»¥ç›´æ¥ä½¿ç”¨tagã€‚æ¨é€åˆ°è¿œç¨‹æœåŠ¡å™¨éœ€è¦æ˜¾å¼çš„è¡¨è¾¾å‡ºtagname</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">git tag<br>git tag -l <span class="hljs-string">&#x27;v1.8.5.*&#x27;</span><br><br><span class="hljs-comment"># æ ‡ç­¾åˆ†ä¸ºè½»é‡çº§å’Œæ³¨é‡Š</span><br>git tag -a v1<span class="hljs-number">.4</span> -m <span class="hljs-string">&#x27;my version 1.4&#x27;</span><br><br>git tag v1<span class="hljs-number">.4</span><br><br>git push origin [tagname] <span class="hljs-comment"># git push origin v1.5</span><br>git push origin --tags<br><br><span class="hljs-comment"># åˆ é™¤æ ‡ç­¾</span><br>git tag -d v1<span class="hljs-number">.4</span> <span class="hljs-comment"># ä½†æ˜¯è¿™æ ·ä¸ä¼šä»ä»»ä½•è¿œç¨‹æœåŠ¡å™¨åˆ é™¤æ ‡ç­¾</span><br>git push origin --delete &lt;tagname&gt;<br><br><span class="hljs-comment"># æŸ¥çœ‹tag</span><br>git checkout v2<span class="hljs-number">.0</span> <span class="hljs-comment">#è¿™ç§ä¼šå¯¼è‡´ä»“åº“å¤„äºâ€œåˆ†ç¦»çš„HEADçŠ¶æ€â€œï¼Œå¦‚æœè¿›è¡Œæ›´æ”¹ã€åˆ›å»ºæäº¤ã€æ ‡ç­¾å°†ä¿æŒä¸å˜</span><br></code></pre></td></tr></table></figure><h3 id="37-åˆ«å-alias"><a class="markdownIt-Anchor" href="#37-åˆ«å-alias"></a> 3.7 åˆ«å alias</h3><p>åˆ›å»ºè‡ªå·±snippets</p><h3 id="381-éå¸¸é‡è¦åˆ†æ”¯æ¨¡å¼"><a class="markdownIt-Anchor" href="#381-éå¸¸é‡è¦åˆ†æ”¯æ¨¡å¼"></a> 3.8.1 ï¼ˆéå¸¸é‡è¦ï¼‰åˆ†æ”¯æ¨¡å¼</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">git add [filename]<br>git commit -m <span class="hljs-string">&#x27;message&#x27;</span><br><br><span class="hljs-comment">#gitçš„é»˜è®¤åˆ†æ”¯åç§°æ˜¯masterï¼Œåªä¸è¿‡å¾ˆå¤šäººæ‡’å¾—æ”¹</span><br>git branch testing<br>git log --oneline --decorate<br>git checkout testing <span class="hljs-comment"># æ›´æ¨ègit switch</span><br>git commit -a -m <span class="hljs-string">&#x27;new commit&#x27;</span><br>git checkout master<br>git commit -a -m <span class="hljs-string">&#x27;new commit2&#x27;</span><br>git log --oneline -decorate --graph --asll<br></code></pre></td></tr></table></figure><p>ååºæŸ¥çœ‹ä¸€äº›åŸºæœ¬åˆ†æ”¯å’Œåˆå¹¶çš„å…·ä½“æ“ä½œã€‚æƒ³è±¡ä¸€ä¸ªå·¥ä½œæµç¨‹ï¼Œåœ¨ç½‘ç«™ä¸Šåšä¸€äº›å·¥ä½œï¼Œä¸ºä¸€ä¸ªæ–°çš„æ•…äº‹åˆ›å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä¹‹ååœ¨å¦å¤–åˆ†æ”¯åšä¸€äº›å·¥ä½œã€‚å› æ­¤å¯ä»¥å‚è€ƒä¸€ä¸‹çš„è¿‡ç¨‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">git checkout -b [NewBranchName] <span class="hljs-comment"># git branch and git checkout ç¼©å†™</span><br><span class="hljs-comment"># æ³¨æ„åœ¨ç­¾å‡ºçš„åˆ†æ”¯å†²çªæœªæäº¤æ›´æ”¹ï¼Œä½†æ˜¯å¯ä»¥å…è®¸ stashing and cleaningä¸­äº†è§£</span><br>git checkout master <span class="hljs-comment"># ä¸“æ³¨ä½ çš„ä¸»çº¿ä»»åŠ¡</span><br>git checkout -b <span class="hljs-string">&#x27;newfeature2&#x27;</span><br><br><span class="hljs-comment"># ~~ newfeature2ç»“æŸ</span><br>git checkout master<br>git merge newfeature2<br><span class="hljs-comment"># åˆ é™¤åˆ†æ”¯</span><br>git branch -d hotfix<br><span class="hljs-comment"># å¤„ç†</span><br>git checkout NewBranchName<br><span class="hljs-comment"># å†æ¬¡åˆå¹¶</span><br>git checkout master<br>git merge master<br><br><span class="hljs-comment"># ä¸¤ä¸ªåˆå¹¶å‡ºç°å†²çª</span><br>git status <span class="hljs-comment">#æŸ¥çœ‹</span><br><span class="hljs-comment"># æ‰‹åŠ¨æ‰“å¼€æ–‡ä»¶ï¼Œå¤„ç†å†²çª</span><br>git mergetool<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°å¯¼è‡´å·²ç»ä¼šåˆ›å»ºã€åˆå¹¶ã€åˆ é™¤ä¸€äº›åˆ†æ”¯ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€äº›åˆ†æ”¯ç®¡ç†å·¥å…·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">git branch -V <span class="hljs-comment"># æŸ¥çœ‹æ¯ä¸ªåˆ†æ”¯çš„æœ€åä¸€æ¬¡æäº¤</span><br>git branch --merged <span class="hljs-keyword">or</span> --no-merged<span class="hljs-comment"># è¿‡æ»¤æ‚¨å·²ç»æˆ–å°šæœªåˆå¹¶åˆ°æ‚¨å½“å‰ä½¿ç”¨çš„åˆ†æ”¯ä¸­çš„åˆ†æ”¯</span><br>git brach --move <span class="hljs-comment"># æœ¬åœ°é‡å‘½ååˆ†æ”¯</span><br>git push --<span class="hljs-built_in">set</span>-upstream origin main<br></code></pre></td></tr></table></figure><h3 id="382-åˆ†æ”¯å·¥ä½œæµç¨‹"><a class="markdownIt-Anchor" href="#382-åˆ†æ”¯å·¥ä½œæµç¨‹"></a> 3.8.2 åˆ†æ”¯å·¥ä½œæµç¨‹</h3><p>å·²ç»æœ‰branchå’Œmergeçš„åŸºç¡€çŸ¥è¯†ï¼Œåº”è¯¥ç”¨æ­¤åšäº›ä»€ä¹ˆï¼Ÿè¿™é‡Œå°†è½»é‡çº§åˆ†æ”¯çš„å¸¸è§çš„å·¥ä½œæµç¨‹å±•ç¤ºï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦å°†å…¶çº³å…¥è‡ªå·±çš„å¼€å‘å‘¨æœŸ</p><p><a href="https://git-scm.com/book/en/v2/Git-Branching-Branching-Workflows">Git - Branching Workflows</a></p><p>å¸¸è§çš„åˆ†ç±»åŒ…æ‹¬</p><ul><li>master åˆ†æ”¯ä¸­å®Œå…¨ç¨³å®šçš„ä»£ç </li><li>developæˆ–next å·¥ä½œä¸­ç”¨äºæµ‹è¯•ç¨³å®šæ€§ï¼Œä¸ä¸€å®šæ€»æ˜¯ç¨³å®šçš„ã€‚å½“å®ƒç¨³å®šä¹‹åå¯ä»¥åˆå¹¶åˆ°master</li><li>proposed åè®®æ›´æ–°</li><li>topic çŸ­ç”Ÿå‘½å‘¨æœŸçš„åˆ†æ”¯ï¼Œç”¨äºå¤„ç†ä¸€äº›ç®€å•çš„feature add</li></ul><h3 id="383-è¿œç¨‹åˆ†æ”¯"><a class="markdownIt-Anchor" href="#383-è¿œç¨‹åˆ†æ”¯"></a> 3.8.3 è¿œç¨‹åˆ†æ”¯</h3><ul><li>[ ]  å¾…å®š</li></ul><p><a href="https://git-scm.com/book/en/v2/Git-Branching-Remote-Branches">Git - Remote Branches</a></p><h3 id="384-åˆ†æ”¯ç®¡ç†"><a class="markdownIt-Anchor" href="#384-åˆ†æ”¯ç®¡ç†"></a> 3.8.4 åˆ†æ”¯ç®¡ç†</h3><h3 id="39-git-æœåŠ¡å™¨"><a class="markdownIt-Anchor" href="#39-git-æœåŠ¡å™¨"></a> 3.9 Git æœåŠ¡å™¨</h3><h3 id="310-åˆ†å¸ƒå¼å·¥ä½œæµ"><a class="markdownIt-Anchor" href="#310-åˆ†å¸ƒå¼å·¥ä½œæµ"></a> 3.10 åˆ†å¸ƒå¼å·¥ä½œæµ</h3>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä»&lt;a href=&quot;https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell&quot;&gt;Git - Branches in a Nutshell&lt;/a&gt;ä¸­çœ‹Gitçš„ä¸€äº›å¸¸è§æ“ä½œï¼Œä¸»è¦æ˜¯è®¾è®¡ç†å¿µå’Œæœ¬åœ°çš„æ“ä½œã€‚æ›´å¤æ‚çš„è¿œç¨‹åä½œå’Œé¡¹ç›®ç®¡ç†åç»­ç»™å‡ºã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="CS" scheme="https://blog.tjdata.site/categories/CS/"/>
    
    
    <category term="git" scheme="https://blog.tjdata.site/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>å®˜æ–¹æ–‡æ¡£_Pandasé˜…è¯»å’Œæ„Ÿæ‚Ÿ</title>
    <link href="https://blog.tjdata.site/posts/9f94980a.html"/>
    <id>https://blog.tjdata.site/posts/9f94980a.html</id>
    <published>2023-05-07T05:42:41.000Z</published>
    <updated>2023-05-13T13:52:06.562Z</updated>
    
    <content type="html"><![CDATA[<p>å®˜æ–¹æ–‡æ¡£æ˜¯å¼€å‘è€…å¯¹è‡ªå·±ä»£ç çš„è§£é‡Šã€‚å¯¹äºæˆç†Ÿçš„æ¡†æ¶ï¼Œå®˜æ–¹æ–‡æ¡£å¯ä»¥æœ€å‡†ç¡®ã€æƒå¨çš„èµ„æ–™ã€‚å¦‚ä½•é˜…è¯»è‹±æ–‡çš„å®˜æ–¹æ–‡æ¡£ä¸€ç›´æ˜¯ä½œä¸ºCoder weakerå’ŒEnglish weakerçš„å¿ƒé­”ï¼Œè¿™é‡Œä»¥Pandasæ–‡æ¡£ä¸ºä¾‹å­ï¼Œå°è¯•ç»™å‡ºè‡ªå·±å¯¹äºé˜…è¯»å®˜æ–¹æ–‡æ¡£ã€å®˜æ–¹æ–‡æ¡£çš„æŸ¥è¯¢å·¥å…·ã€ä»£ç æ³¨é‡Šå’ŒPandasæ–‡æ¡£çš„æ€»ç»“ã€‚</p><span id="more"></span><h2 id="0x01-why-é˜…è¯»å®˜æ–¹æ–‡æ¡£"><a class="markdownIt-Anchor" href="#0x01-why-é˜…è¯»å®˜æ–¹æ–‡æ¡£"></a> 0x01 Why é˜…è¯»å®˜æ–¹æ–‡æ¡£</h2><p>å¯¹äºè´¨é‡æ¯”è¾ƒé«˜çš„é¡¹ç›®ï¼Œå…¶å®˜æ–¹æ–‡æ¡£å¾€å¾€èƒ½åæ˜ å¼€å‘è€…çš„æœ€ç›´æ¥çš„æ€æƒ³ï¼Œè€Œäº’è”ç½‘ä¸Šç»è¿‡è®¸å¤šäººçš„ç¼–ç å’Œè§£ç ï¼Œå¯¼è‡´æœ€åçš„æ„æ€å¯èƒ½å’Œæœ¬æ„ç›¸å·®å·¨å¤§ã€‚è™½ç„¶å¯èƒ½å­˜åœ¨å…¶ä»–æ›´å¥½çš„æ•™ç¨‹ï¼Œä½†æ˜¯å®˜æ–¹æ–‡æ¡£ç»™å‡ºçš„æ€æƒ³ä¸€å®šæ˜¯æœ€å‡†ç¡®ã€æƒå¨çš„ã€‚</p><blockquote><p>ä¹‹å‰ä¸€ç›´ä¸çŸ¥é“GitHubåœ¨å›½å†…ä¸ºä»€ä¹ˆè®¿é—®è¿™ä¹ˆæ…¢ã€‚</p><p>åœ¨ç½‘ä¸Šæ‰¾åˆ°å¾ˆå¤šç­”æ¡ˆï¼Œæ¯”å¦‚ä¿®æ”¹DNSçš„ã€ä¿®æ”¹Hostsçš„ã€ä¿®æ”¹é•œåƒæºæˆ–è€…å¢åŠ ä»£ç†çš„ï¼Œä½†å…¶å®æœ¬è´¨çš„é—®é¢˜æ˜¯GitHub.comçš„åŸŸåè§£æåœ¨å›½å†…å¾€å¾€éœ€è¦å¤šå±‚ä¸­è½¬è¿›è€Œå› ä¸ºæ±¡æŸ“ç­‰åŸå› é€ æˆé€Ÿåº¦è¾ƒæ…¢ï¼Œå› æ­¤ä¸Šè¿°æ–¹æ³•å¯¹åº”çš„æ˜¯ä¿®æ”¹DNSã€æœ¬æœºè§£æã€è®¾ç½®é•œåƒã€èµ°ä»£ç†ç­‰å¤šç§æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•éƒ½æ²¡æœ‰é”™ã€‚ä½†æ˜¯åªæ˜¯ç»™å‡ºè¿™äº›æ–¹æ³•ä¼šè®©äººä¸èƒ½ä¸€è§ˆèƒŒåçš„æ€æƒ³è€Œå›°æƒ‘ã€‚</p></blockquote><h2 id="0x02-what-å®˜æ–¹æ–‡æ¡£"><a class="markdownIt-Anchor" href="#0x02-what-å®˜æ–¹æ–‡æ¡£"></a> 0x02 What å®˜æ–¹æ–‡æ¡£</h2><p>ä»¥Pandasä¸ºä¾‹å­ï¼Œæ–‡æ¡£é€šå¸¸å¯ä»¥åˆ†ä¸º</p><ul><li>Getting startï¼šæ–°æ‰‹æ•™ç¨‹ï¼Œä¸€èˆ¬ä¼šæ•™ä½ å¦‚ä½•æ­å»ºä¸€ä¸ªç®€å•çš„åº”ç”¨ç¤ºä¾‹ã€‚</li><li>User guideï¼šä½¿ç”¨æ•™ç¨‹ï¼Œä»‹ç»æŠ€æœ¯çš„å…³é”®çŸ¥è¯†ã€æ€æƒ³å’Œæ¦‚å¿µã€‚</li><li>API referenceï¼šAPIæ–‡æ¡£ï¼ŒåŒ…æ‹¬å…·ä½“çš„APIä½¿ç”¨ç»†èŠ‚ä»¥åŠæœºåˆ¶</li><li>Developer guideï¼šå¼€å‘æ–‡æ¡£</li></ul><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/image-20230507140000120.png" alt="image-20230507140000120" style="zoom: 25%;" /><p>æ¨èä½¿ç”¨  <a href="https://kapeli.com/dash">Dash gives your Mac instant offline access to 200+ API documentation sets.</a>  æ¥è¿›è¡Œå®˜æ–¹APIæ–‡æ¡£çš„ç®¡ç†ã€‚ä½œä¸ºä¸€ä¸ªAPIæ–‡æ¡£æµè§ˆå™¨(API documentation brower)å’Œä»£ç ç‰‡æ®µç®¡ç†ï¼ˆCode snippet managerï¼‰ï¼Œå¯ä»¥æä¾›çš„å¸®åŠ©æœ‰</p><ol><li>è¿…é€Ÿ</li><li>ç›´æ¥</li><li>æœ¬åœ°</li><li>Alfredåä½œ</li></ol><p>å½“ç„¶å¸¸è§çš„å‡½æ•°ç”¨æ³•å¯ä»¥ç›´æ¥é€šè¿‡å‘½ä»¤æ¥è·å–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> module_name <span class="hljs-comment">#such as import math</span><br><span class="hljs-built_in">help</span>(module_name) <span class="hljs-comment">#æ¨¡å—å¸®åŠ©æŸ¥è¯¢</span><br><span class="hljs-built_in">dir</span>(module_name) <span class="hljs-comment"># æŸ¥è¯¢æ¨¡å—ä¸‹æ‰€æœ‰çš„å‡½æ•°</span><br><span class="hljs-built_in">help</span>(module_name.func_name) <span class="hljs-comment">#æŸ¥è¯¢å…·ä½“å‡½æ•°çš„ç”¨æ³•</span><br><span class="hljs-built_in">print</span>(func_name.__doc__) <span class="hljs-comment"># æ‰“å°å‡½æ•°çš„ç”¨æ³•</span><br></code></pre></td></tr></table></figure><h2 id="0x03-pandas-æ–°æ‰‹æ•™ç¨‹"><a class="markdownIt-Anchor" href="#0x03-pandas-æ–°æ‰‹æ•™ç¨‹"></a> 0x03 Pandas æ–°æ‰‹æ•™ç¨‹</h2><p>é¦–å…ˆä»‹ç»pandasæ˜¯ä»€ä¹ˆï¼š</p><blockquote><p>Pandas is a <a href="https://www.python.org/">Python</a> package providing fast, flexible, and expressive data structures designed to make working with â€œrelationalâ€ or â€œlabeledâ€ data both easy and intuitive.</p><p>It aims to be the fundamental high-level building block for doing practical, <strong>real-world</strong> data analysis in Python.</p></blockquote><p>å…¶ä¸­åŸºæœ¬çš„æ•°æ®ç±»å‹å¯ä»¥åˆ†ä¸ºSerieså’ŒDataFrameä¸¤ç§ï¼ŒåŸºäºNumPyæ„å»ºã€‚æ–°æ‰‹æ•™ç¨‹ç»™å‡ºå¸¸è§çš„Pandasä½¿ç”¨çš„Topicã€‚åŒ…æ‹¬</p><h3 id="31-åˆ›å»ºæ•°æ®-æŸ¥çœ‹æ•°æ®-ç´¢å¼•æ•°æ®"><a class="markdownIt-Anchor" href="#31-åˆ›å»ºæ•°æ®-æŸ¥çœ‹æ•°æ®-ç´¢å¼•æ•°æ®"></a> 3.1 åˆ›å»ºæ•°æ®ã€æŸ¥çœ‹æ•°æ®ã€ç´¢å¼•æ•°æ®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Series ä¸€ç»´æ ‡è®°æ•°ç»„ï¼Œå¯ä»¥å®¹çº³å„ç§æ•°æ®ç±»å‹(intã€floatã€stringã€chatã€python object)</span><br><span class="hljs-comment"># Pandas äºŒç»´æ ‡è®°æ•°æ®æ¡†æ¶ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€å¼ æ•°æ®è¡¨æ ¼ï¼Œæˆ–è€…æ˜¯SQLè¡¨æ ¼</span><br><span class="hljs-comment"># Insight01ï¼šPandasä¸­çš„æ•°æ®ç»“æ„å¯ä»¥çœ‹ä½œæ˜¯ndarrayæ–¹å¼çš„æ ‡é‡ï¼ˆé€šè¿‡indexç´¢å¼•ï¼‰ï¼Œä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯dictæ–¹å¼çš„å­—å…¸ï¼ˆå¯ä»¥é€šè¿‡keyç´¢å¼•ï¼‰</span><br><span class="hljs-comment"># Attention01:Pandasæ•°æ®ä¹‹é—´çš„è¿ç®—é€šå¸¸æ˜¯æŒ‰ç…§å…ƒç´ çš„ï¼Œå¹¶ä¸”æ˜¯broadcastingçš„ã€‚å¯¹äºç¼ºå¤±å€¼é€šå¸¸ä½¿ç”¨numpy.nanå¡«è¡¥</span><br><br><span class="hljs-comment"># åˆ›å»ºæ•°æ®ï¼Œå¯ä»¥æ¥è‡ªäº 1. ndarrayã€2. dictã€3. scalarã€4. tuple of dict</span><br>d = &#123;<br>    <span class="hljs-string">&quot;one&quot;</span>: pd.Series([<span class="hljs-number">1.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>], index=[<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>]),<br>    <span class="hljs-string">&quot;two&quot;</span>: pd.Series([<span class="hljs-number">1.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">4.0</span>], index=[<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;d&quot;</span>]),<br>&#125;<br><br>d = &#123;<span class="hljs-string">&quot;one&quot;</span>: [<span class="hljs-number">1.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">4.0</span>], <span class="hljs-string">&quot;two&quot;</span>: [<span class="hljs-number">4.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">1.0</span>]&#125;<br>pd.DataFrame(d, index=[<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;d&quot;</span>])<br><br>data2 = [&#123;<span class="hljs-string">&quot;a&quot;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&quot;b&quot;</span>: <span class="hljs-number">2</span>&#125;, &#123;<span class="hljs-string">&quot;a&quot;</span>: <span class="hljs-number">5</span>, <span class="hljs-string">&quot;b&quot;</span>: <span class="hljs-number">10</span>, <span class="hljs-string">&quot;c&quot;</span>: <span class="hljs-number">20</span>&#125;]<br>pd.DataFrame(data2, index=[<span class="hljs-string">&quot;first&quot;</span>, <span class="hljs-string">&quot;second&quot;</span>])<br><br>data3= &#123;<br>        (<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>): &#123;(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;B&quot;</span>): <span class="hljs-number">1</span>, (<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;C&quot;</span>): <span class="hljs-number">2</span>&#125;,<br>        (<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>): &#123;(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;C&quot;</span>): <span class="hljs-number">3</span>, (<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;B&quot;</span>): <span class="hljs-number">4</span>&#125;,<br>        (<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>): &#123;(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;B&quot;</span>): <span class="hljs-number">5</span>, (<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;C&quot;</span>): <span class="hljs-number">6</span>&#125;,<br>        (<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>): &#123;(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;C&quot;</span>): <span class="hljs-number">7</span>, (<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;B&quot;</span>): <span class="hljs-number">8</span>&#125;,<br>        (<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>): &#123;(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;D&quot;</span>): <span class="hljs-number">9</span>, (<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;B&quot;</span>): <span class="hljs-number">10</span>&#125;,<br>    &#125;<br>pd.DataFrame(data3)<br><br><span class="hljs-comment"># æŸ¥çœ‹æ•°æ®</span><br>.head() <span class="hljs-comment">#æŸ¥çœ‹dataframeçš„é¡¶éƒ¨</span><br>.tail() <span class="hljs-comment">#æŸ¥çœ‹dataframeçš„åº•éƒ¨</span><br>.columns()<br>.index()<br>.to_numpy() <span class="hljs-comment">#æ³¨æ„è¿™ä¸ªå¯èƒ½æ˜¯ä¸€ä¸ªæ˜‚è´µçš„æ“ä½œ</span><br>.describe() <span class="hljs-comment"># æ˜¾ç¤ºæ•°æ®çš„å¿«é€Ÿæ‘˜è¦</span><br>.T <span class="hljs-comment"># è½¬ç½®</span><br><br>df.sort_index(axis=<span class="hljs-number">1</span>, ascending=<span class="hljs-literal">False</span>) <span class="hljs-comment">#æŒ‰ç…§è½´è¿›è¡Œæ’åº</span><br>df.sort_values(by=<span class="hljs-string">&quot;B&quot;</span>)<br><br><span class="hljs-comment"># æ›´æ”¹æ§åˆ¶å°æ˜¾ç¤º</span><br>info() <span class="hljs-comment"># ç”¨äºå¿«é€Ÿæ˜¾ç¤ºdataframeä¿¡æ¯</span><br>baseball.info()<br><br>to_string() <span class="hljs-comment"># ä»¥è¡¨æ ¼çš„å½¢å¼è¿”å›dataframeçš„å­—ç¬¦ä¸²è¡¨ç¤º</span><br><span class="hljs-built_in">print</span>(baseball.iloc[-<span class="hljs-number">20</span>:, :<span class="hljs-number">12</span>].to_string())<br>display.width <span class="hljs-comment"># æ›´æ”¹å•è¡Œçš„æ‰“å°é‡</span><br>pd.set_option(<span class="hljs-string">&quot;display.width&quot;</span>, <span class="hljs-number">40</span>)  <span class="hljs-comment"># default is 80</span><br>pd.set_option(<span class="hljs-string">&quot;display.max_colwidth&quot;</span>, <span class="hljs-number">30</span>)<br>pd.DataFrame(np.random.randn(<span class="hljs-number">3</span>, <span class="hljs-number">12</span>))<br><br><span class="hljs-comment"># ç´¢å¼•æ•°æ®</span><br><span class="hljs-comment"># ç»§æ‰¿seriesçš„ç´¢å¼•</span><br>df[<span class="hljs-string">&quot;one&quot;</span>]<br>df[<span class="hljs-string">&quot;three&quot;</span>] = df[<span class="hljs-string">&quot;one&quot;</span>] * df[<span class="hljs-string">&quot;two&quot;</span>]<br>df[<span class="hljs-string">&quot;flag&quot;</span>] = df[<span class="hljs-string">&quot;one&quot;</span>] &gt; <span class="hljs-number">2</span><br><span class="hljs-keyword">del</span> df[<span class="hljs-string">&quot;two&quot;</span>]<br>three = df.pop(<span class="hljs-string">&quot;three&quot;</span>)<br>df[<span class="hljs-string">&quot;foo&quot;</span>] = <span class="hljs-string">&quot;bar&quot;</span> <span class="hljs-comment">#è‡ªåŠ¨broadcasting</span><br>df[<span class="hljs-string">&quot;one_trunc&quot;</span>] = df[<span class="hljs-string">&quot;one&quot;</span>][:<span class="hljs-number">2</span>] <span class="hljs-comment"># è‡ªåŠ¨ç¬¦åˆindex</span><br>df.insert(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;bar&quot;</span>, df[<span class="hljs-string">&quot;one&quot;</span>])<br><br><span class="hljs-comment"># assign() å§‹ç»ˆè¿”å›æ•°æ®çš„å‰¯æœ¬ï¼Œä½†æ˜¯åŸå§‹çš„dataframeå¹¶ä¸ä¼šä¿®æ”¹</span><br>iris.assign(sepal_ratio=<span class="hljs-keyword">lambda</span> x: (x[<span class="hljs-string">&quot;SepalWidth&quot;</span>] / x[<span class="hljs-string">&quot;SepalLength&quot;</span>])).head()<br>df.loc <span class="hljs-comment">#æ ¹æ®æ ‡ç­¾é€‰æ‹©</span><br>df.iloc <span class="hljs-comment">#æ ¹æ®ä¸‹æ ‡é€‰æ‹©</span><br>df[<span class="hljs-number">5</span>:<span class="hljs-number">10</span>] <span class="hljs-comment"># åˆ‡ç‰‡è¡Œ</span><br>df[<span class="hljs-built_in">bool</span>] <span class="hljs-comment"># åˆ‡ç‰‡è¡Œ</span><br><br></code></pre></td></tr></table></figure><h3 id="32-æ•°æ®ç¼ºå¤±å¤„ç†-è¿ç®—å‡½æ•°"><a class="markdownIt-Anchor" href="#32-æ•°æ®ç¼ºå¤±å¤„ç†-è¿ç®—å‡½æ•°"></a> 3.2 æ•°æ®ç¼ºå¤±å¤„ç†ã€è¿ç®—å‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">np.nan <span class="hljs-comment">#è¡¨ç¤ºä¸¢å¤±çš„æ•°æ®ç±»å‹</span><br><br>df.reindex() <span class="hljs-comment"># å…è®¸æ›´æ”¹ã€æ·»åŠ å’Œåˆ é™¤æŒ‡å®šè½´ä¸Šçš„ç´¢å¼•ï¼ŒåŒæ—¶è¿”å›æ•°æ®å‰¯æœ¬</span><br>df1 = df.reindex(index=dates[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>], columns=<span class="hljs-built_in">list</span>(df.columns) + [<span class="hljs-string">&quot;E&quot;</span>])<br>df1.loc[dates[<span class="hljs-number">0</span>] : dates[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;E&quot;</span>] = <span class="hljs-number">1</span><br><br>df.dropna() <span class="hljs-comment"># åˆ é™¤ä»»ä½•ç¼ºå°‘æ•°æ®çš„è¡Œ</span><br>df.fillna() <span class="hljs-comment"># å¡«å……ç¡®å®çš„æ•°æ®</span><br>isna() <span class="hljs-comment">#è·å–å€¼æ˜¯å¦ä¸ºnan</span><br><br>é»˜è®¤æŒ‰ç…§broadcastingè¿›è¡Œè®¡ç®—<br>df.mean() <span class="hljs-comment"># è®¡ç®—å¹³å‡å€¼</span><br>df.mean(<span class="hljs-number">1</span>) <span class="hljs-comment"># å¦å¤–ä¸€ä¸ªæ–¹å‘</span><br>df.apply() <span class="hljs-comment"># å°†ç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°åº”ç”¨äºæ•°æ®</span><br>df.apply(np.cumsum)<br>df.apply(<span class="hljs-keyword">lambda</span> x: x.<span class="hljs-built_in">max</span>() - x.<span class="hljs-built_in">min</span>())<br><br>values_count()<br>df.<span class="hljs-built_in">str</span>.ufunc() <span class="hljs-comment"># åœ¨strå±æ€§ä¸‹ï¼Œå¯ä»¥è°ƒç”¨éœ€è¦å…¶ä»–çš„å­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure><h3 id="33-é›†åˆä¹‹é—´çš„å¤„ç†åˆå¹¶-åˆ†ç»„-é‡å¡‘å’Œå¤šç´¢å¼•"><a class="markdownIt-Anchor" href="#33-é›†åˆä¹‹é—´çš„å¤„ç†åˆå¹¶-åˆ†ç»„-é‡å¡‘å’Œå¤šç´¢å¼•"></a> 3.3 é›†åˆä¹‹é—´çš„å¤„ç†ï¼šåˆå¹¶ã€åˆ†ç»„ã€é‡å¡‘å’Œå¤šç´¢å¼•</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.concat([df1,df2,df3]) <span class="hljs-comment"># æŒ‰ç…§axisè¿›è¡Œåˆå¹¶ï¼Œjoinå‚æ•°ä¸ºouteræˆ–è€…innerï¼Œignore_indeé‡å»ºç´¢å¼•</span><br>pd.merge(df1,df2,key) <span class="hljs-comment"># ç±»ä¼¼SQLä¸­çš„è¿æ¥ï¼Œå¯ä»¥æ ¹æ®ä¸€ä¸ªæˆ–è€…å¤šä¸ªé”®å°†ä¸åŒçš„dataframeè¿æ¥èµ·æ¥</span><br>pd.join() <span class="hljs-comment"># ç”¨äºkeyçš„åˆå¹¶</span><br><br>df.groupby(<span class="hljs-string">&quot;A&quot;</span>)[[<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;D&quot;</span>]].<span class="hljs-built_in">sum</span>() <span class="hljs-comment"># ç±»ä¼¼SQLä¸­çš„group by</span><br><br><span class="hljs-comment"># é‡å¡‘å’Œå¤šç´¢å¼•çœ‹ä¸æ‡‚ï½</span><br></code></pre></td></tr></table></figure><h3 id="34æ—¶é—´åºåˆ—å¤„ç†å‡½æ•°ä¸“é¢˜"><a class="markdownIt-Anchor" href="#34æ—¶é—´åºåˆ—å¤„ç†å‡½æ•°ä¸“é¢˜"></a> 3.4æ—¶é—´åºåˆ—å¤„ç†å‡½æ•°ä¸“é¢˜</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">resample() <span class="hljs-comment">#å°†ç¬¬äºŒåˆ—æ•°æ®è½¬æ¢æˆ5minï¼Œæœ‰ç‚¹æ„æ€</span><br>series.tz_localize() <span class="hljs-comment"># å°†æ—¶é—´åºåˆ—è½¬æ¢æˆä¸ºæœ¬åœ°æ—¶åŒº</span><br>series.tz_convert() <span class="hljs-comment"># å°†æ—¶åŒºæ„ŸçŸ¥æ—¶é—´åºåˆ—è½¬æ¢æˆä¸ºå¦ä¸€ä¸ªæ—¶åŒº</span><br>.to_period() <span class="hljs-comment"># è½¬æ¢æˆä¸ºæ—¶é—´è·¨åº¦</span><br>.to_timestamp() <span class="hljs-comment"># è½¬æ¢æˆä¸ºæ—¶é—´æˆ³</span><br></code></pre></td></tr></table></figure><h2 id="0x04-pandas-ç”¨æˆ·æ•™ç¨‹"><a class="markdownIt-Anchor" href="#0x04-pandas-ç”¨æˆ·æ•™ç¨‹"></a> 0x04 Pandas ç”¨æˆ·æ•™ç¨‹</h2><p>åœ¨ç”¨æˆ·æ•™ç¨‹ä¸­ï¼ŒPandasæä¾›äº†ä¸€äº›æ›´åŠ ç»†è‡´çš„ä¸“é¢˜ã€‚è¿™é‡Œåªç»™å‡ºæœ‰è¶£çš„è¯é¢˜</p><h3 id="41-æ•°æ®ç»“æ„ç®€ä»‹-intro-to-data-structure"><a class="markdownIt-Anchor" href="#41-æ•°æ®ç»“æ„ç®€ä»‹-intro-to-data-structure"></a> 4.1 æ•°æ®ç»“æ„ç®€ä»‹ intro to data structure</h3><p>å’Œç¬¬ä¸‰ç« çš„ç±»ä¼¼</p><h3 id="42-å…³é”®åŸºç¡€å‡½æ•°-essential-basic-functionality"><a class="markdownIt-Anchor" href="#42-å…³é”®åŸºç¡€å‡½æ•°-essential-basic-functionality"></a> 4.2 å…³é”®åŸºç¡€å‡½æ•° essential basic functionality</h3><p>Attention02:å¯¹äºdataframeçš„æ“ä½œå¯ä»¥ä¸‰ä¸ªç»´åº¦ï¼šå…ƒç´ çš„ç»´åº¦ã€è¡Œæˆ–è€…åˆ—çš„ç»´åº¦ã€æ•´ä¸ªDataFrameçš„ç»´åº¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æŸ¥çœ‹</span><br>.head()<br>.tail()<br><br>.shape<br>.index<br>.columns<br><br>.to_numpy()<br>.array()<br><span class="hljs-comment"># Attention03:æ›´åŠ æ¨èä½¿ç”¨è¿™ä¸¤ä¸ªï¼Œè€Œä¸æ˜¯ä½¿ç”¨valuesæ¥ç´¢å¼•ã€‚å› ä¸ºdataframeä¸­å¸¸è§çš„æ“ä½œåŒ…æ‹¬æ‰©å±•ç±»å‹ï¼Œæˆ–è€…ä¸åŒç±»å‹ï¼Œä½¿ç”¨valueså¯èƒ½ä¼šå‡ºç°æ€§èƒ½ä¸Šçš„é—®é¢˜</span><br><br><span class="hljs-comment"># è¿ç®—ï¼ˆelementLevelï¼‰</span><br>df1 &gt; df2<br>df1*df2<br>df1+df2<br><br><span class="hljs-comment"># äºŒç»´è¿ç®—ï¼Œè¿™é‡Œéœ€è¦é‡è§† 1.é«˜ç»´å’Œä½ç»´ä¹‹é—´å­˜åœ¨broadcasting 2.è®¡ç®—ä¸­æ•°æ®ä¸¢å¤±çš„æƒ…å†µ</span><br>.add() <span class="hljs-comment"># ç›¸åŠ ï¼Œå¯ä»¥è®¾ç½®axiså‡½æ•°</span><br>.sub() <span class="hljs-comment"># ç›¸å‡ï¼Œå¯ä»¥è®¾ç½®axis</span><br>.mul() <span class="hljs-comment"># ç›¸ä¹˜ï¼Œå¯ä»¥è®¾ç½®axis</span><br>.div() <span class="hljs-comment"># ç›¸é™¤ï¼Œå¯ä»¥è®¾ç½®axis</span><br><br>.radd()<br>.rsub()<br>.<span class="hljs-built_in">divmod</span>() <span class="hljs-comment"># å•†ï¼Œå’Œä½™</span><br><br><span class="hljs-comment"># ç¼ºå¤±å€¼æ“ä½œ</span><br>fill_value=<span class="hljs-number">0</span> <span class="hljs-comment">#å¯é€‰å‚æ•°</span><br>.fill_na() <span class="hljs-comment">#åˆ©ç”¨å‡½æ•°å¡«è¡¥</span><br><br><span class="hljs-comment"># äºŒè¿›åˆ¶æ¯”è¾ƒæ–¹æ³• eq ne lt qt le ge</span><br><span class="hljs-comment"># å¸ƒå°”è¿ç®—ç¬¦å·</span><br>.empty() <span class="hljs-comment"># æµ‹è¯•å¯¹è±¡æ˜¯å¦ä¸ºç©º</span><br>.<span class="hljs-built_in">all</span>() <span class="hljs-comment"># æµ‹è¯•å¹¶</span><br>.<span class="hljs-built_in">any</span>() <span class="hljs-comment"># æµ‹è¯•æˆ–</span><br>.<span class="hljs-built_in">bool</span>() <span class="hljs-comment"># æµ‹è¯•å•ä¸ªå…ƒç´ </span><br><br><span class="hljs-comment">#Attention 04ï¼šä¸å¯ä»¥ä½¿ç”¨ if df:...ï¼Œè¿™æ ·ä¸ç¬¦åˆå¸ƒå°”é€»è¾‘</span><br><br><span class="hljs-comment"># æè¿°æ€§åˆ†æ</span><br><span class="hljs-built_in">sum</span>()<br>mean()<br>quantile()<br>cumsum()<br>cumprod()<br><br>describe()<br>idxmin() <span class="hljs-comment"># å¯»æ‰¾æœ€å°å€¼ä¸‹æ ‡ argmin</span><br>idxmax() <span class="hljs-comment"># å¯»æ‰¾æœ€å¤§å€¼ä¸‹æ ‡ argmax</span><br>res=df.value_counts()<br>mode()<br><br><span class="hljs-comment"># discretization and quantiling</span><br>cut() <span class="hljs-comment">#åŸºäºå€¼çš„bin</span><br>qcut() <span class="hljs-comment">#åŸºäºåˆ†ä½æ•°çš„bin</span><br><br><span class="hljs-comment"># å‡½æ•°åº”ç”¨ï¼špipeline(),apply(),applymap(); èšåˆå‡½æ•°agg() and transform()</span><br><br><span class="hljs-comment"># å°è¯•æƒ³è±¡ä¸€ä¸‹å¦‚ä½•æ–°å¢ä¸¤ä¸ªåˆ—</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extractCityName</span>(<span class="hljs-params">df</span>):<br>df[<span class="hljs-string">&#x27;cityName&#x27;</span>]=df[<span class="hljs-string">&#x27;cityAndCode&#x27;</span>].<span class="hljs-built_in">str</span>.aplit(<span class="hljs-string">&quot;,&quot;</span>).<span class="hljs-built_in">str</span>.get(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">return</span> df<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">addCountryName</span>(<span class="hljs-params">df,countryName=<span class="hljs-literal">None</span></span>):<br>col=<span class="hljs-string">&#x27;cityName&#x27;</span><br>df[<span class="hljs-string">&#x27;cityAndCounty&#x27;</span>]=df[col]+countryName<br>df_p=pd.Dataframe(&#123;<span class="hljs-string">&#x27;cityAndCode&#x27;</span>:[<span class="hljs-string">&#x27;chicago&#x27;</span>,<span class="hljs-string">&#x27;IL&#x27;</span>]&#125;)<br><span class="hljs-comment"># ç°åœ¨å¯ä»¥æœ‰ä¸¤ç§æ–¹å¼æ¥æ–°å¢å¿ƒå¾—countryName</span><br>addCounryName(extractCityName(df_p),country_name=<span class="hljs-string">&#x27;US&#x27;</span>)<span class="hljs-comment">#æ³•1</span><br>df_p.pipeline(extractCityName).pipe(addCountryName,countryName=<span class="hljs-string">&#x27;US&#x27;</span>)<span class="hljs-comment">#æ³•2:æˆ–è€…ä½¿ç”¨pipeline</span><br><br><span class="hljs-comment"># é‡ç´¢å¼• reindex</span><br><br><span class="hljs-comment"># è¿­ä»£ iteration</span><br><span class="hljs-keyword">for</span> label,ser <span class="hljs-keyword">in</span> df.items():<br>  <span class="hljs-built_in">print</span>(label)<br>  <span class="hljs-built_in">print</span>(ser)<br><span class="hljs-keyword">for</span> row_index,row <span class="hljs-keyword">in</span> df.iterrows():<br>  <span class="hljs-built_in">print</span>(row)<br><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> df.itertuples():<br>  <span class="hljs-built_in">print</span>(row)<br><br><span class="hljs-comment"># æ’åºè®¿é—®</span><br>.sort_index()<br>.sort_values()<br></code></pre></td></tr></table></figure><h3 id="45-ç´¢å¼•å’Œé€‰æ‹©æ•°æ®-indexing-and-selecting-data"><a class="markdownIt-Anchor" href="#45-ç´¢å¼•å’Œé€‰æ‹©æ•°æ®-indexing-and-selecting-data"></a> 4.5 ç´¢å¼•å’Œé€‰æ‹©æ•°æ® Indexing and selecting data</h3><p>å’Œæ–°æ‰‹æ•™ç¨‹å·®ä¸å¤š</p><h3 id="46-å¤šé‡ä¸‹æ ‡å’Œé«˜çº§ç´¢å¼•-multiindex-and-advanced-indexing"><a class="markdownIt-Anchor" href="#46-å¤šé‡ä¸‹æ ‡å’Œé«˜çº§ç´¢å¼•-multiindex-and-advanced-indexing"></a> 4.6 å¤šé‡ä¸‹æ ‡å’Œé«˜çº§ç´¢å¼• MultiIndex and advanced indexing</h3><p>å’Œæ–°æ‰‹æ•™ç¨‹å·®ä¸å¤š</p><h3 id="465-merge-join-concatenate-compare"><a class="markdownIt-Anchor" href="#465-merge-join-concatenate-compare"></a> 4.6.5 Mergeã€joinã€concatenateã€compare</h3><p>å’ŒSQLæ•™ç¨‹å·®ä¸å¤š</p><h3 id="47-é‡å¡‘å’Œæ•°æ®é€è§†è¡¨"><a class="markdownIt-Anchor" href="#47-é‡å¡‘å’Œæ•°æ®é€è§†è¡¨"></a> 4.7 é‡å¡‘å’Œæ•°æ®é€è§†è¡¨</h3><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/reshaping_pivot.png" alt="../_images/reshaping_pivot.png" /></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># pivot() æ¥æŒ‰ç…§å…ƒç´ è¿›è¡Œå †å ,å¯ä»¥é€‰æ‹©stackæˆ–è€…unstack</span><br>         date variable     value<br><span class="hljs-number">0</span>  <span class="hljs-number">2000</span>-01-03        A  <span class="hljs-number">0.469112</span><br><span class="hljs-number">1</span>  <span class="hljs-number">2000</span>-01-04        A -<span class="hljs-number">0.282863</span><br><span class="hljs-number">2</span>  <span class="hljs-number">2000</span>-01-05        A -<span class="hljs-number">1.509059</span><br><span class="hljs-number">3</span>  <span class="hljs-number">2000</span>-01-03        B -<span class="hljs-number">1.135632</span><br><span class="hljs-number">4</span>  <span class="hljs-number">2000</span>-01-04        B  <span class="hljs-number">1.212112</span><br><span class="hljs-number">5</span>  <span class="hljs-number">2000</span>-01-05        B -<span class="hljs-number">0.173215</span><br><span class="hljs-number">6</span>  <span class="hljs-number">2000</span>-01-03        C  <span class="hljs-number">0.119209</span><br><span class="hljs-number">7</span>  <span class="hljs-number">2000</span>-01-04        C -<span class="hljs-number">1.044236</span><br><span class="hljs-number">8</span>  <span class="hljs-number">2000</span>-01-05        C -<span class="hljs-number">0.861849</span><br><span class="hljs-number">9</span>  <span class="hljs-number">2000</span>-01-03        D -<span class="hljs-number">2.104569</span><br><span class="hljs-number">10</span> <span class="hljs-number">2000</span>-01-04        D -<span class="hljs-number">0.494929</span><br><span class="hljs-number">11</span> <span class="hljs-number">2000</span>-01-05        D  <span class="hljs-number">1.071804</span><br><br>pivoted = df.pivot(index=<span class="hljs-string">&quot;date&quot;</span>, columns=<span class="hljs-string">&quot;variable&quot;</span>, values=<span class="hljs-string">&quot;value&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/reshaping_stack.png" alt="../_images/reshaping_stack.png" /></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/reshaping_unstack.png" alt="../_images/reshaping_unstack.png" /></p><p>å‰©ä½™çš„å¤ªç†è®ºäº†ï½</p><h2 id="0x05-å¿ƒå¾—"><a class="markdownIt-Anchor" href="#0x05-å¿ƒå¾—"></a> 0x05 å¿ƒå¾—</h2><p>æ–‡æ¡£å¾ˆå¤šï¼Œä½†æ˜¯å…¶ä¸­ç»™å‡ºå¼€å‘è€…çš„defaultçš„é€‰é¡¹ï¼Œå¯ä»¥æé«˜å¯¹å…¶çš„ç†è§£ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;å®˜æ–¹æ–‡æ¡£æ˜¯å¼€å‘è€…å¯¹è‡ªå·±ä»£ç çš„è§£é‡Šã€‚å¯¹äºæˆç†Ÿçš„æ¡†æ¶ï¼Œå®˜æ–¹æ–‡æ¡£å¯ä»¥æœ€å‡†ç¡®ã€æƒå¨çš„èµ„æ–™ã€‚å¦‚ä½•é˜…è¯»è‹±æ–‡çš„å®˜æ–¹æ–‡æ¡£ä¸€ç›´æ˜¯ä½œä¸ºCoder weakerå’ŒEnglish weakerçš„å¿ƒé­”ï¼Œè¿™é‡Œä»¥Pandasæ–‡æ¡£ä¸ºä¾‹å­ï¼Œå°è¯•ç»™å‡ºè‡ªå·±å¯¹äºé˜…è¯»å®˜æ–¹æ–‡æ¡£ã€å®˜æ–¹æ–‡æ¡£çš„æŸ¥è¯¢å·¥å…·ã€ä»£ç æ³¨é‡Šå’ŒPandasæ–‡æ¡£çš„æ€»ç»“ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Baseline" scheme="https://blog.tjdata.site/categories/Baseline/"/>
    
    
    <category term="pandas" scheme="https://blog.tjdata.site/tags/pandas/"/>
    
  </entry>
  
  <entry>
    <title>macOSä½¿ç”¨æŠ€å·§_é¢„è§ˆPreview</title>
    <link href="https://blog.tjdata.site/posts/de0c5bf1.html"/>
    <id>https://blog.tjdata.site/posts/de0c5bf1.html</id>
    <published>2023-05-04T05:39:12.000Z</published>
    <updated>2023-05-13T13:49:54.370Z</updated>
    
    <content type="html"><![CDATA[<p>é¢„è§ˆPreview</p><span id="more"></span><p>åœ¨Mç³»åˆ—çš„macä¸Šï¼Œé¢„è§ˆçš„å¯ä»¥å°†æ‰«æçš„PDFä¸­çš„æ–‡å­—è½¬æ¢æˆä¸ºå¯ç¼–è¾‘çŠ¶æ€ã€‚è½¬æ¢æ—¶é—´å¤§æ¦‚200é¡µçš„PDFéœ€è¦5åˆ†é’Ÿï½</p><p>exportå°±ä¼šæœ‰ä¸‹åˆ—é€‰é¡¹</p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/image-20230504134518543.png" alt="image-20230504134518543" /></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;é¢„è§ˆPreview&lt;/p&gt;</summary>
    
    
    
    <category term="Memo" scheme="https://blog.tjdata.site/categories/Memo/"/>
    
    
    <category term="ä½¿ç”¨æŠ€å·§" scheme="https://blog.tjdata.site/tags/%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>CS229-10-problemSet01</title>
    <link href="https://blog.tjdata.site/posts/7b309918.html"/>
    <id>https://blog.tjdata.site/posts/7b309918.html</id>
    <published>2023-01-10T01:03:17.000Z</published>
    <updated>2023-05-13T13:47:47.454Z</updated>
    
    <content type="html"><![CDATA[<p>Problem set00 æ˜¯å…³äºçº¿æ€§ä»£æ•°å’Œå¤šå…ƒå¾®ç§¯åˆ†å­¦çš„åŸºæœ¬çŸ¥è¯†ï¼ŒProblem set 01ä¸»è¦æ˜¯ç›‘ç£å­¦ä¹ ã€‚ä½œä¸šè¦æ±‚æœ€å¥½ä½¿ç”¨LaTexè¿›è¡Œç¼–å†™ï¼ŒåŒæ—¶éœ€è¦å°†libraryä¿å­˜åˆ°environment.ymlæ–‡ä»¶ä¸­ï¼Œå¹¶ä¿è¯run.pyè„šæœ¬å¯ä»¥æ­£å¸¸è¿è¡Œã€‚</p><span id="more"></span><h2 id="0x01-çº¿æ€§åˆ†ç±»é€»è¾‘å›å½’å’Œå¹¿ä¹‰çº¿æ€§æ¨¡å‹"><a class="markdownIt-Anchor" href="#0x01-çº¿æ€§åˆ†ç±»é€»è¾‘å›å½’å’Œå¹¿ä¹‰çº¿æ€§æ¨¡å‹"></a> 0x01 çº¿æ€§åˆ†ç±»ï¼ˆé€»è¾‘å›å½’å’Œå¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼‰</h2><h3 id="11-é—®é¢˜å›é¡¾"><a class="markdownIt-Anchor" href="#11-é—®é¢˜å›é¡¾"></a> 1.1 é—®é¢˜å›é¡¾</h3><p>Linear classifiers ( logistic regression and GDA)</p><p>åœ¨æœ¬æ¬¡ä½œä¸šä¸­å°†å›é¡¾ä¹‹å‰çš„æ¦‚ç‡çº¿æ€§åˆ†ç±»å™¨ï¼Œ</p><ol><li>åˆ¤åˆ«çº¿æ€§åˆ†ç±» (discriminative linear classifier) ï¼šé€»è¾‘å›å½’</li><li>ç”Ÿæˆçº¿æ€§åˆ†ç±» ï¼ˆgenerative linear classifierï¼‰ï¼šé«˜æ–¯åˆ¤åˆ«æ¨¡å‹</li></ol><p>ä¸¤è€…å‡å¯ä»¥å°†ä¸€ä¸ªæ•°æ®é›†åˆ†æˆä¸¤ç±»ï¼Œä½†æ˜¯åŸºäºä¸åŒçš„å‡è®¾ï¼Œæœ¬æ¬¡é—®é¢˜çš„ç›®çš„æ˜¯æ‰¾åˆ°ä¸¤è€…çš„ç›¸åŒç‚¹å’Œå·®å¼‚ã€‚</p><h3 id="12-å®é™…é—®é¢˜"><a class="markdownIt-Anchor" href="#12-å®é™…é—®é¢˜"></a> 1.2 å®é™…é—®é¢˜</h3><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301100927616.png" alt="é—®é¢˜1-(a)" /></p><p>æ³¨æ„HessiançŸ©é˜µä¸ºPSDï¼Œåˆ™è¯´æ˜æŸå¤±å‡½æ•°æ˜¯å‡¸ï¼ˆconvexï¼‰çš„ï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨æå€¼ç‚¹</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>y</mi><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mi>h</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>)</mo><mo>=</mo><mi>p</mi><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mi>h</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>)</mo><mi mathvariant="normal">/</mi><mi>p</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mi>h</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>)</mo><mo>=</mo><mi>p</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mi>h</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi mathvariant="normal">âˆ£</mi><mi>y</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi>y</mi><mo>)</mo><mi mathvariant="normal">/</mi><mi>p</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mi>h</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(y|x,theta)=p(y,x,theta)/p(x,theta)=p(x,theta|y)p(y)/p(x,theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">t</span><span class="mord mathit">h</span><span class="mord mathit">e</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">t</span><span class="mord mathit">h</span><span class="mord mathit">e</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mord mathrm">/</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">t</span><span class="mord mathit">h</span><span class="mord mathit">e</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">t</span><span class="mord mathit">h</span><span class="mord mathit">e</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathrm">âˆ£</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord mathrm">/</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit">t</span><span class="mord mathit">h</span><span class="mord mathit">e</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span></span></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301101647405.png" alt="1-b" /></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301101647666.png" alt="1-c" /></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301101650344.png" alt="1-c(2)" /></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301101650705.png" alt="1-d" /></p><h3 id="13-é—®é¢˜æ±‚è§£"><a class="markdownIt-Anchor" href="#13-é—®é¢˜æ±‚è§£"></a> 1.3 é—®é¢˜æ±‚è§£</h3><p>ç”±äºå…¬å¼è¾ƒå¤šï¼Œåªèƒ½ç»™å‡ºæ€è·¯</p><p>ï¼ˆ1ï¼‰ å±•å¼€æ±‚å¯¼å°±èƒ½å‘ç°æ˜¯å¤§äº0</p><p>ï¼ˆ2ï¼‰codingå°±å®Œäº‹äº†ï¼Œnumpyçš„MATLABçš„çŸ©é˜µè®¡ç®—æ–¹å¼</p><p>ï¼ˆ3ï¼‰GDAæŒ‰ç…§è´å¶æ–¯å±•å¼€å°±è¡Œäº†</p><p>ï¼ˆ4ï¼‰ å‘ç°æ˜¯ç›¸åŒçš„</p><p>ï¼ˆ5ï¼‰ï¼ˆ6ï¼‰ï¼ˆ7ï¼‰ï¼ˆ8ï¼‰æ˜¯ä¸€äº›å¯è§†åŒ–çš„ä¸œè¥¿</p><h2 id="0x02-ä¸å®Œæ•´-åªæœ‰æ­£æ ‡ç­¾incompletepositive-only-labels"><a class="markdownIt-Anchor" href="#0x02-ä¸å®Œæ•´-åªæœ‰æ­£æ ‡ç­¾incompletepositive-only-labels"></a> 0x02 ä¸å®Œæ•´ã€åªæœ‰æ­£æ ‡ç­¾ï¼šIncompleteï¼ŒPositive- only labels</h2><h3 id="21-é—®é¢˜å›é¡¾"><a class="markdownIt-Anchor" href="#21-é—®é¢˜å›é¡¾"></a> 2.1 é—®é¢˜å›é¡¾</h3><p>å‡è®¾åœ¨æˆ‘ä»¬æ²¡æœ‰å¾—åˆ°å®Œæ•´çš„æ ‡ç­¾çš„æƒ…å†µä¸‹çš„ï¼Œåªèƒ½ç¡®å®šæ€§å¾—åˆ°éƒ¨åˆ†çš„æ­£æ ·æœ¬ï¼Œè€Œä¸èƒ½å¾—åˆ°å…¶ä»–æ ·æœ¬çš„æ ‡ç­¾ã€‚ä¹Ÿå°±æ˜¯æ‰€æœ‰è´Ÿæ ·æœ¬å’Œå‰©ä½™çš„æ­£æ ·æœ¬æ˜¯æ²¡æœ‰æ ‡ç­¾çš„ã€‚</p><p>è¿™é“é¢˜çš„é—®é¢˜è®¾ç½®æ›´åƒæ˜¯ä¸€ç§å¼•å¯¼ï¼Œå¦‚ä½•ç†è§£è¿™ç§æƒ…å†µä¸‹å¦‚ä½•æ„å»ºæ¨¡å‹</p><h3 id="22-é—®é¢˜"><a class="markdownIt-Anchor" href="#22-é—®é¢˜"></a> 2.2 é—®é¢˜</h3><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301101657770.png" alt="2-a" /></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301101657662.png" alt="2-b" /></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301101657533.png" alt="2-c" /></p><p>åç»­æ˜¯é‚£ä¸ªcoding problem</p><h3 id="23-é—®é¢˜è§£ç­”"><a class="markdownIt-Anchor" href="#23-é—®é¢˜è§£ç­”"></a> 2.3 é—®é¢˜è§£ç­”</h3><p>ï¼ˆ1ï¼‰ ç®€å•éšæœºæ ·æœ¬æŠ½æ ·</p><h2 id="0x03-æ³Šæ¾åˆ†å¸ƒçš„æ‹Ÿåˆ"><a class="markdownIt-Anchor" href="#0x03-æ³Šæ¾åˆ†å¸ƒçš„æ‹Ÿåˆ"></a> 0x03 æ³Šæ¾åˆ†å¸ƒçš„æ‹Ÿåˆ</h2><p>é‡æ–°å›å½’GLMä¸­çš„ä¸‰ä¸ªåŸºæœ¬å‡è®¾ï¼š</p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301102059026.png" alt="GLM-assumption" /></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301102059330.png" alt="GLM-assumption02" /></p><p>æœ¬é‡æ–°è®¤è¯†åˆ°ï¼š</p><ol><li>ç¬¬ä¸€ä¸ªassumptionç»™å‡ºäº†yçš„åˆ†å¸ƒï¼è¿™å¯ä»¥ç”¨æ¥è®¡ç®—ä¼¼ç„¶å‡½æ•°</li><li>ç¬¬äºŒä¸ªassumptionç»™å‡ºå¦‚ä½•ç¡®å®šhypothesisï¼Œä¹Ÿå°±æ˜¯æ¨¡å‹</li><li>ç¬¬ä¸‰ä¸ªassumptionä¼¼ä¹æ˜¯äººä»¬è®¾è®¡å¥½çš„ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å¯¹ä¸€äº›çº¿æ€§æ¨¡å‹åšå‡è®¾</li></ol><h2 id="0x04-å¹¿ä¹‰çº¿æ€§æ¨¡å‹çš„convexç›¸å…³çš„ç ”ç©¶"><a class="markdownIt-Anchor" href="#0x04-å¹¿ä¹‰çº¿æ€§æ¨¡å‹çš„convexç›¸å…³çš„ç ”ç©¶"></a> 0x04 å¹¿ä¹‰çº¿æ€§æ¨¡å‹çš„convexç›¸å…³çš„ç ”ç©¶</h2><p>å¤ªç†è®ºäº†çœ‹ä¸ä¸‹å»ï½</p><h2 id="0x05-åŠ æƒçº¿æ€§å›å½’"><a class="markdownIt-Anchor" href="#0x05-åŠ æƒçº¿æ€§å›å½’"></a> 0x05 åŠ æƒçº¿æ€§å›å½’</h2><p>é™¤äº† åˆ©ç”¨gradient descentæ±‚è§£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨normal equationæ¥è¿›è¡Œå‚æ•°çš„æ±‚è§£ï¼›éå¸¸çš„å¥‡å¦™ï¼</p><p>æ³¨æ„è¿™éƒ¨åˆ†å’Œåé¢çš„attentionæœ‰å…³ç³»</p><p>åé¢çš„å…¬å¼å¤ªå¤šäº†ä¸æƒ³æ‰“ï¼Œ</p><h2 id="0x06-æ„Ÿæ‚Ÿ"><a class="markdownIt-Anchor" href="#0x06-æ„Ÿæ‚Ÿ"></a> 0x06 æ„Ÿæ‚Ÿ</h2><p>åŠ¨æ‰‹æ‰èƒ½å‘ç°å­¦ä¹ çš„é—®é¢˜æ‰€åœ¨ï¼ŒåŠ¨æ‰‹æ‰èƒ½çŸ¥é“ä»£ç åº”è¯¥å¦‚ä½•å®è·µï¼</p><p>å¯¹äºç°å®ä¸–ç•Œçš„æŠ½è±¡å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›ä¸€æ­¥å­¦ä¹ å’Œç ”ç©¶ï¼Œè™½ç„¶çŸ©é˜µçš„å®šä¹‰å¾ˆç®€å•ï¼Œä½†æ˜¯åªæœ‰åœ¨è¿™ä¸ªæŠ½è±¡å®šä¹‰çš„åŸºç¡€ä¸Šæ‰èƒ½å‘å±•å‡ºçº¿æ€§ä»£æ•°è¿™é—¨å­¦ç§‘ï¼Œæ‰èƒ½ç”¨æ­¤è§£å†³é—®é¢˜ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Problem set00 æ˜¯å…³äºçº¿æ€§ä»£æ•°å’Œå¤šå…ƒå¾®ç§¯åˆ†å­¦çš„åŸºæœ¬çŸ¥è¯†ï¼ŒProblem set 01ä¸»è¦æ˜¯ç›‘ç£å­¦ä¹ ã€‚ä½œä¸šè¦æ±‚æœ€å¥½ä½¿ç”¨LaTexè¿›è¡Œç¼–å†™ï¼ŒåŒæ—¶éœ€è¦å°†libraryä¿å­˜åˆ°environment.ymlæ–‡ä»¶ä¸­ï¼Œå¹¶ä¿è¯run.pyè„šæœ¬å¯ä»¥æ­£å¸¸è¿è¡Œã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="ML&amp;DL" scheme="https://blog.tjdata.site/categories/ML-DL/"/>
    
    
    <category term="CS229" scheme="https://blog.tjdata.site/tags/CS229/"/>
    
  </entry>
  
  <entry>
    <title>CS229-10-problemSet00</title>
    <link href="https://blog.tjdata.site/posts/c37a98e.html"/>
    <id>https://blog.tjdata.site/posts/c37a98e.html</id>
    <published>2023-01-09T02:11:12.000Z</published>
    <updated>2023-05-13T13:47:43.837Z</updated>
    
    <content type="html"><![CDATA[<p>CS229çš„homeworkä¹‹å‰ä¸€ç›´æ²¡æœ‰å†™ï¼Œè¶è¿™ä¸ªå¯’å‡ç»“æŸæ‰å®ƒï¼å¦‚æœ‰é”™è¯¯æ¬¢è¿æŒ‡æ­£ï¼</p><span id="more"></span><h2 id="0x01-gradients-and-hessiansæ±‚å¯¼å’Œæµ·æ£®çŸ©é˜µ"><a class="markdownIt-Anchor" href="#0x01-gradients-and-hessiansæ±‚å¯¼å’Œæµ·æ£®çŸ©é˜µ"></a> 0x01 Gradients and Hessiansï¼š<a href="https://en.wikipedia.org/wiki/Gradient">æ±‚å¯¼</a>å’Œ<a href="https://zh.m.wikipedia.org/zh-hans/%E9%BB%91%E5%A1%9E%E7%9F%A9%E9%99%A3">æµ·æ£®çŸ©é˜µ</a></h2><h3 id="11-å®šä¹‰å›é¡¾"><a class="markdownIt-Anchor" href="#11-å®šä¹‰å›é¡¾"></a> 1.1 å®šä¹‰å›é¡¾</h3><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301091015744.png" alt="å¤šå…ƒå‡½æ•°ä¸€é˜¶å¯¼" /></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301091016793.png" alt="å¤šå…ƒå‡½æ•°äºŒé˜¶å¯¼" /></p><p><a href="https://zh.m.wikipedia.org/zh-hans/%E5%B0%8D%E7%A8%B1%E7%9F%A9%E9%99%A3">Symmetric</a>: å¯¹ç§°çŸ©é˜µ</p><h3 id="12-é—®é¢˜"><a class="markdownIt-Anchor" href="#12-é—®é¢˜"></a> 1.2 é—®é¢˜</h3><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301091018345.png" alt="é—®é¢˜" /></p><h3 id="13-è§£ç­”"><a class="markdownIt-Anchor" href="#13-è§£ç­”"></a> 1.3 è§£ç­”</h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>1</mn><mo>)</mo><mi mathvariant="normal">âˆ‡</mi><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mi>A</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">(1)\nabla f(x)=Ax+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mord mathrm">âˆ‡</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">A</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">b</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>2</mn><mo>)</mo><mi mathvariant="normal">âˆ‡</mi><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msup><mi>g</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>(</mo><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>)</mo><mi mathvariant="normal">âˆ‡</mi><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(2)\nabla f(x)=g&#x27;(h(x)) \nabla h(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.801892em;"></span><span class="strut bottom" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">2</span><span class="mclose">)</span><span class="mord mathrm">âˆ‡</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord mathrm">âˆ‡</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>3</mn><mo>)</mo><msup><mi mathvariant="normal">âˆ‡</mi><mn>2</mn></msup><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msup><mi>A</mi><mi>T</mi></msup><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">(3)\nabla^2f(x)=A^T=A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">3</span><span class="mclose">)</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">A</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>4</mn><mo>)</mo><msup><mi mathvariant="normal">âˆ‡</mi><mn>2</mn></msup><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msup><mi>g</mi><mrow><mi mathvariant="normal">â€²</mi><mi mathvariant="normal">â€²</mi></mrow></msup><mo>(</mo><msup><mi>a</mi><mi>T</mi></msup><mi>x</mi><mo>)</mo><msup><mi>a</mi><mi>T</mi></msup><mi>a</mi></mrow><annotation encoding="application/x-tex">(4) \nabla^2 f(x)=g&#x27;&#x27;(a^Tx)a^Ta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">4</span><span class="mclose">)</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">a</span></span></span></span></span></p><h2 id="0x02-positive-definite-matrices-æ­£å®šçŸ©é˜µ"><a class="markdownIt-Anchor" href="#0x02-positive-definite-matrices-æ­£å®šçŸ©é˜µ"></a> 0x02 Positive definite matrices : æ­£å®šçŸ©é˜µ</h2><h3 id="21-å®šä¹‰å›é¡¾"><a class="markdownIt-Anchor" href="#21-å®šä¹‰å›é¡¾"></a> 2.1 å®šä¹‰å›é¡¾</h3><p>positive semi-definite(PSD): åŠæ­£å®šçŸ©é˜µ</p><p><a href="https://zh.wikipedia.org/wiki/%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5">positive definite: æ­£å®šçŸ©é˜µï¼Œegï¼šå•ä½é˜µ</a></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301091027124.png" alt="æ­£å®šçŸ©é˜µå®šä¹‰" /></p><p><a href="https://zh.wikipedia.org/wiki/%E9%9B%B6%E7%A9%BA%E9%97%B4">Null-space:</a> æ ¸ï¼Œè¡¨ç¤ºä¸€ä¸ªç®—å­çš„é›¶ç©ºé—´æ˜¯æ–¹ç¨‹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>V</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">AV=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>çš„æ‰€æœ‰è§£<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>çš„é›†åˆ</p><p><a href="https://zh.wikipedia.org/wiki/%E7%A7%A9_(%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0)">Rank</a>: çŸ©é˜µAçš„åˆ—ç§©æ˜¯Açº¿æ€§æ— å…³çš„çºµåˆ—çš„æå¤§æ•°ç›®ï¼›å¯ä»¥ç”¨äºè®¡ç®—çº¿æ€§æ–¹ç¨‹ç»„è§£çš„æ ‘æœ¨ã€ä¹Ÿå¯ä»¥ç”¨æ¥ç¡®å®šçº¿æ€§ç³»ç»Ÿæ˜¯å¦ä¸ºå¯æ§åˆ¶çš„ã€å¯è§‚å¯Ÿçš„</p><h3 id="22-é—®é¢˜"><a class="markdownIt-Anchor" href="#22-é—®é¢˜"></a> 2.2 é—®é¢˜</h3><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301091028776.png" alt="2.2 é—®é¢˜" /></p><h3 id="23-è§£ç­”"><a class="markdownIt-Anchor" href="#23-è§£ç­”"></a> 2.3 è§£ç­”</h3>(a) A^T=(zz^T)=z^Tz=zz^T=A\\x^Tzz^Tx=(x^Tz)(x^Tz)^T \geq0(b) Nullï¼ˆAï¼‰=\{x \in Z;Ax=0\}<p>ä¸¤è¾¹åŒæ—¶ä¹˜<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">x^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mi>T</mi></msup><mi>z</mi><msup><mi>z</mi><mi>T</mi></msup><mi>x</mi><mo>=</mo><mo>(</mo><msup><mi>z</mi><mi>T</mi></msup><mi>x</mi><msup><mo>)</mo><mi>T</mi></msup><mo>(</mo><msup><mi>z</mi><mi>T</mi></msup><mi>x</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x^Tzz^Tx=(z^Tx)^T(z^Tx)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">x</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">x</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span></span></p><p>å¯ä»¥åŒ–ç®€ä¸º</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mi>u</mi><mi>l</mi><mi>l</mi><mo>(</mo><mi>A</mi><mo>)</mo><mo>=</mo><mi>N</mi><mi>u</mi><mi>l</mi><mi>l</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>=</mo><mrow><mi>x</mi><mo>âˆˆ</mo><mi>z</mi><mo separator="true">,</mo><msup><mi>z</mi><mi>x</mi></msup><mo>=</mo><mn>0</mn></mrow></mrow><annotation encoding="application/x-tex">Null(A)=Null(z)={x \in z, z^x=0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathit">A</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">x</span><span class="mrel">âˆˆ</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">x</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span></span></span></p><p>å› ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mi>a</mi><mi>n</mi><mi>k</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>â‰¤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Rank(z) \leq 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mrel">â‰¤</span><span class="mord mathrm">1</span></span></span></span>,ä½†æ˜¯zéé›¶;ç»“åˆ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mi>u</mi><mi>l</mi><mi>l</mi><mo>(</mo><mi>A</mi><mo>)</mo><mo>=</mo><mi>N</mi><mi>u</mi><mi>l</mi><mi>l</mi><mo>(</mo><mi>z</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Null(A)=Null(z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathit">A</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>(</mo><mi>A</mi><mo>)</mo><mo>=</mo><mi>R</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R(A)=R(z)=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathit">A</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>c</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span></span></p><p>ç»“åˆAçš„PSDç‰¹ç‚¹å¯ä»¥è¯æ˜ï¼Œç•¥</p><h2 id="0x03-eigenvectorseigenvaluesspectral-theoremç‰¹å¾å‘é‡-ç‰¹å¾å€¼-è°±å®šç†"><a class="markdownIt-Anchor" href="#0x03-eigenvectorseigenvaluesspectral-theoremç‰¹å¾å‘é‡-ç‰¹å¾å€¼-è°±å®šç†"></a> 0x03 Eigenvectorsï¼Œeigenvaluesï¼Œspectral theoremï¼šç‰¹å¾å‘é‡ã€ç‰¹å¾å€¼ã€è°±å®šç†</h2><h3 id="31-å®šä¹‰å›é¡¾"><a class="markdownIt-Anchor" href="#31-å®šä¹‰å›é¡¾"></a> 3.1 å®šä¹‰å›é¡¾</h3><p>Eigenvectors &amp; Eigenvaluesï¼šç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡</p><p>æ±‚è§£<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>A</mi></msub><mo>(</mo><mi>Î»</mi><mo>)</mo><mo>=</mo><mi>d</mi><mi>e</mi><mi>t</mi><mo>(</mo><mi>Î»</mi><mi>I</mi><mo>âˆ’</mo><mi>A</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p_A(\lambda)=det(\lambda I-A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">Î»</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit">t</span><span class="mopen">(</span><span class="mord mathit">Î»</span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mbin">âˆ’</span><span class="mord mathit">A</span><span class="mclose">)</span></span></span></span>æˆ–è€…<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>Î»</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Ax=\lambda x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathit">x</span><span class="mrel">=</span><span class="mord mathit">Î»</span><span class="mord mathit">x</span></span></span></span>ä¹‹é—´çš„å…³ç³»</p><p>Diagonal matrixï¼šå¯¹è§’çŸ©é˜µï¼Œå¯ä»¥ç”¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>t</mi><mo>(</mo><mi>d</mi><mn>1</mn><mo separator="true">,</mo><mi>d</mi><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">det(d1,d2,...)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit">t</span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">d</span><span class="mord mathrm">2</span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mclose">)</span></span></span></span>è¡¨ç¤º</p><p>Orthogonalï¼šæ­£äº¤çŸ©é˜µ</p><p><a href="https://zh.m.wikipedia.org/zh-hans/%E8%B0%B1%E5%AE%9A%E7%90%86">Spectral theoremï¼šè°±å®šç†</a></p><h3 id="32-é—®é¢˜"><a class="markdownIt-Anchor" href="#32-é—®é¢˜"></a> 3.2 é—®é¢˜</h3><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301091102746.png" alt="image-20230109110250716" /></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202301091102792.png" alt="image-20230109110258767" /></p><h3 id="33-è§£è¯»"><a class="markdownIt-Anchor" href="#33-è§£è¯»"></a> 3.3 è§£è¯»</h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span></span></p><p>ä¸¤è¾¹åŒä¹˜é€†</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>T</mi><mo>=</mo><mi>T</mi><mi mathvariant="normal">Î›</mi></mrow><annotation encoding="application/x-tex">AT=T\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathrm">Î›</span></span></span></span></span></p><p>åˆ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Î›</mi><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo>(</mo><msub><mi>Î»</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>Î»</mi><mi>n</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\Lambda=diag(\lambda_1,...,\lambda_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Î›</span><span class="mrel">=</span><span class="mord mathit">d</span><span class="mord mathit">i</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><msup><mi>t</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>=</mo><msub><mi>Î»</mi><mi>i</mi></msub><msup><mi>t</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">At^{(i)}=\lambda_it^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.938em;"></span><span class="strut bottom" style="height:1.0879999999999999em;vertical-align:-0.15em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">A</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><p>æ‰€ä»¥ç‰¹å¾å€¼å¯¹åº”çš„å‘é‡ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>Î»</mi><mi>i</mi></msub><mo separator="true">,</mo><msup><mi>t</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">(\lambda_i,t^{(i)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:1.138em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>b</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span></span></p><p>å› ä¸ºAæ˜¯å¯¹ç§°çŸ©é˜µï¼ŒUä¸ºæ­£äº¤çŸ©é˜µï¼ŒåŒæ—¶</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>U</mi><mo>=</mo><mi mathvariant="normal">Î›</mi><mi>U</mi></mrow><annotation encoding="application/x-tex">AU=\Lambda U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="mrel">=</span><span class="mord mathrm">Î›</span><span class="mord mathit" style="margin-right:0.10903em;">U</span></span></span></span></span></p><p>æ‰€ä»¥åŒä¸Š $$Au<sup>{(i)}=\lambda_iu</sup>{(i)}$$</p>(c)$$ æ ¹æ®è°±å®šç†å¯ä»¥å¾—åˆ°$$\Lambda=U^TAU \geq 0<p>å› æ­¤å¤§äºç­‰äº0</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;CS229çš„homeworkä¹‹å‰ä¸€ç›´æ²¡æœ‰å†™ï¼Œè¶è¿™ä¸ªå¯’å‡ç»“æŸæ‰å®ƒï¼å¦‚æœ‰é”™è¯¯æ¬¢è¿æŒ‡æ­£ï¼&lt;/p&gt;</summary>
    
    
    
    <category term="ML&amp;DL" scheme="https://blog.tjdata.site/categories/ML-DL/"/>
    
    
    <category term="CS229" scheme="https://blog.tjdata.site/tags/CS229/"/>
    
  </entry>
  
  <entry>
    <title>Paper04_Combining_Reinforcement_Learning_and Constraint_Programming_for_Combinatorial Optimization</title>
    <link href="https://blog.tjdata.site/posts/bbefc8de.html"/>
    <id>https://blog.tjdata.site/posts/bbefc8de.html</id>
    <published>2022-12-18T07:49:13.000Z</published>
    <updated>2023-05-13T13:50:37.602Z</updated>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦</p><span id="more"></span><h1 id="httpsarxivorgabs200601610"><a class="markdownIt-Anchor" href="#httpsarxivorgabs200601610"></a> <a href="https://arxiv.org/abs/2006.01610">https://arxiv.org/abs/2006.01610</a></h1><h1 id="abstract"><a class="markdownIt-Anchor" href="#abstract"></a> Abstract</h1><p><a href="https://www.notion.so/Combinatorial-Optimization-0f8d8ad2698643b1abf8e955f2a4e869">Combinatorial Optimization</a> åº”ç”¨å¹¿æ³›ï¼šä»èˆªç©ºé¢†åŸŸã€äº¤é€šè§„åˆ’ç”šè‡³åˆ°ç»æµå­¦ä¸­ï¼Œå®ƒçš„ç›®æ ‡æ˜¯åœ¨æœ‰é™çš„è§£ç©ºé—´ä¸­æ‰¾åˆ°æœ€ä¼˜è§£ï¼ˆfind an optimal solution among a finite set of possibilitiesï¼‰ï¼Œå…¶é¢ä¸´çš„æœ€ä¸¥é‡çš„æŒ‘æˆ˜ä¸º<a href="https://www.notion.so/Q-state-action-d9e8f9603c0a47f895d30615644c41d9">Q-state-actionæ–¹æ³•</a> ä¸­æåˆ°çš„ çŠ¶æ€ç©ºé—´çˆ†ç‚¸ï¼ˆState- space explosion problemï¼‰ï¼šé—®é¢˜çš„è§£ç©ºé—´å²é—®é¢˜è§„æ¨¡å¢å¤§æˆæŒ‡æ•°å‹çš„å¢å¤§ï¼Œå¯¼è‡´å¯¹äºä¸€äº›å¤§å‹çš„é—®é¢˜éš¾ä»¥æ±‚è§£ï¼›å¦ä¸€æ–¹é¢DRLï¼ˆdeep reinforcement learningï¼‰åœ¨æ±‚è§£NP-hard ç»„åˆä¼˜åŒ–é—®é¢˜è¿‡ç¨‹å¯¹è®¾è®¡å¥½çš„å¯å‘å¼æ±‚è§£ç®—æ³•å…·æœ‰æ¯”è¾ƒå¥½çš„è´¡çŒ®ï¼Œä½†æ˜¯ç°æœ‰çš„æ–¹æ³•å…·æœ‰ä¸¤ä¸ªç¼ºç‚¹</p><ol><li>ä»–ä»¬ä»…ä»…ä¸“æ³¨äºæ ‡å‡†çš„TSPé—®é¢˜ï¼Œä¸å®¹æ˜“æ‹“å±•åˆ°å…¶ä»–é—®é¢˜</li><li>é€šå¸¸åªç»™å‡ºä¸€ç§è¿‘ä¼¼è§£ï¼ˆapproximate solutionï¼‰ï¼Œè€Œæ²¡æœ‰ç»™å‡ºä¸€ç§ç³»ç»Ÿçš„æ–¹æ³•æ¥æé«˜æˆ–è€…è¯æ˜å®ƒçš„æœ€ä¼˜æ€§ï¼ˆOptimalityï¼‰</li></ol><p>åœ¨å¦å¤–ä¸€ç§æƒ…å†µä¸‹ï¼Œ<a href="https://www.notion.so/Constraint-programming-05ee88110f8b4c18ac9f9cffe6f65976">Constraint programming</a> æ˜¯è§£å†³ç»„åˆä¼˜åŒ–é—®é¢˜çš„é€šç”¨å·¥å…·ï¼ŒåŸºäºä¸€ä¸ªå®Œæ•´çš„æœç´¢è¿‡ç¨‹ï¼Œé€šå¸¸å¯ä»¥åœ¨æ¯”è¾ƒå¤§çš„è¿è¡Œæ—¶é—´ä¸­æ‰¾åˆ°æœ€ä¼˜è§£ã€‚å…¶ä¸­å†³å®šæ€§çš„ç¡®å®šæœç´¢çš„æ–¹å‘ï¼Œæˆ–è€…è¯´åˆ†æç­–ç•¥ï¼Œæˆ–è€…è¯´æ˜¯æ¢ç´¢ç­–ç•¥ã€‚</p><p>åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬æå‡ºä¸€ç§é€šç”¨å’Œæ··åˆçš„æ–¹æ³•ï¼ˆlï¼‰çš„æ–¹æ³•ï¼Œç»“åˆCPå’ŒDRLæ¥æ±‚è§£COPï¼Œä¸»è¦æ˜¯åŸºäº<a href="https://www.notion.so/Part01-dynamic-programming-8f83f0126c2447e8984b0904e305a33a">è¿ç­¹å­¦Part01â€“dynamic programming</a> ä½œä¸ºä¸¤è€…ä¹‹é—´çš„æ¡¥æ¢ï¼Œå¹¶é€šè¿‡å®éªŒæ¥è¯æ˜æ±‚è§£å™¨åœ¨ä¸¤ä¸ªæœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜ä¸Šè¿›è¡Œæ±‚è§£ï¼š<a href="https://www.notion.so/TSPTW-the-traveling-salesman-problem-with-time-windows-e46e9c09083041af998fa7a2ffe2ee1e">TSPTW the traveling salesman problem with time windows</a> å’Œ <a href="https://www.notion.so/4POP-4-moments-portfolio-optimization-problem-b67f257853f348c29fd54edd42d79092">4POP 4-moments portfolio optimization problem</a>,å®æ—¶è¯æ˜æ¯”ä¸€äº›å•ç‹¬çš„RLæˆ–è€…åˆ©ç”¨é€šç”¨æ±‚è§£å™¨æ•ˆæœæ›´å¥½</p><blockquote><p>Brief Conclusion Pï¼šå…·æœ‰å¤šé¡¹å¼æ—¶é—´ç®—æ³•ï¼Œç®—å¾—å¾ˆå¿«çš„é—®é¢˜ NPï¼šä¸ç¡®å®šéœ€è¦å¤šé•¿æ—¶é—´ï¼Œä½†æ˜¯æˆ‘ä»¬éªŒè¯å®ƒåªéœ€è¦å¤šé¡¹å¼æ—¶é—´ NP- completeï¼šå±äºNPé—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿå±äºNP-hardé—®é¢˜ NP-hardï¼šæ¯”NPé—®é¢˜éƒ½è¦éš¾çš„é—®é¢˜</p></blockquote><p>NPé—®é¢˜ æŒ‡çš„æ˜¯éç¡®å®šæ€§å¤šé¡¹å¼é—®é¢˜ï¼ˆnon- deterministic polynomial NPï¼‰ï¼Œéç¡®å®šæ€§æŒ‡çš„æ˜¯å¯ç”¨ä¸€å®šæ•°é‡çš„è¿ç®—å»è§£å†³å¤šé¡¹å¼æ—¶é—´å†…å¯è§£å†³çš„é—®é¢˜ï¼Œé€šå¸¸è§£å†³é—®é¢˜åŒ…æ‹¬ï¼šTSPã€Hamiltonå›è·¯é—®é¢˜ã€æœ€å¤§å›¢é—®é¢˜ï¼›ä½†æ˜¯å…¶å¯ä»¥åœ¨å¤šé¡¹å¼æ—¶é—´å†…å¯ä»¥è¢«éªŒè¯å…¶æ­£ç¡®å®šçš„é—®é¢˜</p><p>NP-hardé—®é¢˜ æŒ‡çš„æ˜¯non- deterministic polynomial time hardnessï¼Œå¦‚æœæ‰€æœ‰çš„NPé—®é¢˜éƒ½å¯ä»¥åœ¨å¤šé¡¹å¼æ—¶é—´è§„çº¦åˆ°æŸä¸ªé—®é¢˜ï¼Œåˆ™ç§°è¿™ä¸ªé—®é¢˜ä¸ºNPå›°éš¾</p><h1 id="introduction"><a class="markdownIt-Anchor" href="#introduction"></a> Introduction</h1><p>åœ¨ç»„åˆä¼˜åŒ–ä¸­å¤§å¤šæ•°é—®é¢˜ä¸ºNP-hardé—®é¢˜ï¼Œå¯¹å…¶é«˜æ•ˆçš„ä¼˜åŒ–ç®—æ³•çš„æ¢ç´¢ç”±æ¥å·²ä¹…ã€‚å¹¿æ³›çš„å¯ä»¥å°†å…¶åˆ†ä¸ºä¸¤ç§æ–¹æ³•</p><p><a href="https://www.notion.so/exact-algorithm-6f0de3f67ad942299d12b6e6962f9e10">ç²¾ç¡®ç®—æ³• exact algorithm</a> æ˜¯åŸºäºå¯¹æ±‚è§£ç©ºé—´çš„å®Œæ•´å¹¶ä¸”å·§å¦™çš„æšä¸¾ï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯å¯ä»¥é€‰æ‹›åˆ°æœ€ä¼˜è§£ï¼Œä½†æ˜¯åœ¨å¯¹äºä¸€äº›å¤§å‹çš„æ¡ˆä¾‹ä¸­å¾€å¾€ä¼šå‡ºç°æ±‚è§£æ—¶é—´æ‰©å¤§ã€‚ä½†ä¹Ÿæœ‰å¦å¤–çš„è¯´æ³•å¯ä»¥è®©ç²¾ç¡®ç®—æ³•åœ¨æ‰¾åˆ°æœ€ä¼˜è§£ä¹‹å‰å°±ç»ˆæ­¢çš„æ–¹å¼æ¥æ¢ç´¢å¾—åˆ°æ¬¡ä¼˜è§£ã€‚è¿™ç§çµæ´»æ€§è®©ç²¾ç¡®æ±‚è§£ç®—æ³•æ›´åŠ appealingå¹¶ä¸”practicalï¼Œä¹Ÿæ­£æ˜¯å¦‚æ­¤æ„æˆäº†ç°ä»£æ±‚è§£å™¨çš„æ ¸å¿ƒ CPLEXã€Gurobiã€Gecodeç­‰ç­‰ã€‚è¿™æ˜¯ä¸€ä¸ªCPçš„ä»‹ç»ï¼Œé€šè¿‡additional asset ç”¨æ¥æ±‚è§£éå¸¸å¤§çš„å¤æ‚æ€§çš„COPé—®é¢˜ï¼Œé€šå¸¸<a href="https://www.notion.so/mixed-integer-programming-MIP-fc936c07376b4ef098d1307191c9019e">æ··åˆæ•´æ•°è§„åˆ’mixed integer programming MIP</a> æ±‚è§£å™¨å¾€å¾€åªèƒ½æ±‚è§£çº¿æ€§é—®é¢˜æˆ–è€…æœ‰é™çš„éçº¿å½¢é—®é¢˜ã€‚</p><p><a href="https://www.elsevier.com/books/handbook-of-constraint-programming/rossi/978-0-444-52726-4">Handbook of Constraint Programming</a></p><p>è€Œåœ¨åˆ©ç”¨CPè¿›è¡Œæ±‚è§£çš„è¿‡ç¨‹ä¸­é‡è¦çš„æ˜¯branching strategyï¼Œéå¸¸è‡ªç„¶çš„ï¼Œå¥½çš„è®¾è®¡çš„å¯å‘å¼çš„æ¢ç´¢æ–¹æ³•å¯ä»¥å¾ˆå¥½çš„å‘ç°æ±‚è§£ï¼Œä½†æ˜¯å·®çš„å¯å‘å¼åˆ†æç­–ç•¥å¾€å¾€ä¼šå¯¼è‡´è¿›å…¥æ²¡æœ‰è§£çš„å­ç©ºé—´ã€‚æ‰€ä»¥åœ¨CPæ±‚è§£é—®é¢˜ä¸­bråˆ†æç­–ç•¥çš„ç ”ç©¶æ˜¯éå¸¸çƒ­é—¨çš„è¯é¢˜</p><p><a href="https://www.notion.so/heuristic-algorithm-5887d2ccbbc34a0db4eb5136ab9645ca">å¯å‘å¼ç®—æ³• heuristic algorithm</a> æ˜¯ä¸€ç§éå®Œå…¨çš„æ‰‹æ®µæ¥æ±‚è§£å¾—åˆ°æœ€ç»ˆè§£ï¼Œä½†æ˜¯ä¸èƒ½è¯æ˜è§£çš„æœ€ä¼˜æ€§ã€‚ä»–ä»¬é€šå¸¸éœ€è¦ç‰¹å®šå­é—®é¢˜çš„çŸ¥è¯†æ‰èƒ½æ„å»ºä»–ä»¬ã€‚åœ¨è¿‘å‡ å¹´ï¼Œ<a href="https://www.notion.so/Lecture01-Deep-Reinforcement-Learning-Decision-Making-and-Control-38667912b7734364a527d8ae71ff2a40">Lecture01 Deep Reinforcement Learning, Decision Making,and Control</a> åœ¨å¯¹ä¸€äº›NP-hardçš„COPé—®é¢˜çš„è¿‘ä¼¼æ±‚è§£ä¸­å–å¾—äº†éå¸¸å¥½çš„æˆæœã€‚åªè¦ä¸€ä¸ªæ¨¡å‹è®­ç»ƒå¥½ï¼Œåœ¨å®è·µä¸­çš„è¿è¡Œæ—¶é—´æ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„ï¼Œåˆ©ç”¨DRLæ±‚è§£é—®é¢˜çš„å‰ææ˜¯</p><ol><li>æˆ‘ä»¬çŸ¥é“å®é™…é—®é¢˜çš„ä¾‹å­åˆ†å¸ƒ</li><li>æˆ‘ä»¬æœ‰è¶³å¤Ÿå¤šçš„æ ·æœ¬ï¼Œå¹¶å¯ä»¥ä»ä¸­é‡‡æ ·æ¥è®­ç»ƒæ¨¡å‹</li></ol><p>ä½†æ˜¯ç°æœ‰çš„DRLåœ¨COPåº”ç”¨ä¸­å­˜åœ¨çš„ä¸€äº›é—®é¢˜è¡¨é˜”</p><ol><li>ä»…é™äºæ±‚è§£ç‰¹å®šçš„é—®é¢˜ï¼Œæ¯”å¦‚TSP</li><li>å…¶æ¬¡ï¼Œå®ƒä»¬ä»…æ—¨åœ¨å……å½“å»ºè®¾æ€§çš„å¯å‘å¼æ–¹æ³•ï¼Œå¹¶ä¸”ä¸å®Œæ•´çš„æ–¹æ³•ï¼ˆä¾‹å¦‚CPï¼‰ä¸åŒï¼Œæ²¡æœ‰ç³»ç»Ÿçš„æ–¹æ³•æ¥æ”¹è¿›æ‰€è·å¾—çš„è§£å†³æ–¹æ¡ˆã€‚</li></ol><p>ä¸Šè¿°çš„<a href="https://www.notion.so/exact-algorithm-6f0de3f67ad942299d12b6e6962f9e10">ç²¾ç¡®ç®—æ³• exact algorithm</a> å’ŒåŸºäºå­¦ä¹ çš„<a href="https://www.notion.so/heuristic-algorithm-5887d2ccbbc34a0db4eb5136ab9645ca">å¯å‘å¼ç®—æ³• heuristic algorithm</a> éƒ½å…·æœ‰å¥½å¤„å’Œåå¤„ï¼Œå¾ˆè‡ªç„¶çš„å°±æœ‰ä¸€ä¸ªé—®é¢˜</p><blockquote><p>æˆ‘ä»¬æ˜¯å¦å¯ä»¥å°†ä»–ä»¬çš„ä¼˜ç‚¹è”åˆèµ·æ¥æ¥æ±‚è§£COP</p></blockquote><p>åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬æˆæœå°†RLä¸CPåˆ©ç”¨<a href="https://www.notion.so/Part01-dynamic-programming-8f83f0126c2447e8984b0904e305a33a">è¿ç­¹å­¦Part01â€“dynamic programming</a> ç»“åˆèµ·æ¥ï¼ŒåŠ¨æ€è§„åˆ’åœ¨å¾ˆå¤šåœºåˆä¸­éƒ½å…·æœ‰å¾ˆæˆæœçš„ä½œç”¨ï¼Œæ˜¯ä¸€ç§éå¸¸å…³é”®çš„å»ºæ¨¡COPé—®é¢˜çš„æ–¹æ³•ï¼Œç®€å•æ¥è¯´DPé—®é¢˜å°†ä¸€ä¸ªé—®é¢˜åˆ†è§£æˆä¸ºå­é—®é¢˜å¹¶é€šè¿‡é€’å½’å…¬å¼ï¼ˆrecursive formulationï¼Œæ¯”å¦‚å¸¸è§çš„bellman equationç»“åˆèµ·æ¥ï¼‰ï¼Œå…¶ä¸­DPé¢ä¸´çš„è‹¦éš¾å¸¸å¸¸æ˜¯ ç»´åº¦ç¾éš¾é—®é¢˜ï¼šç”Ÿæˆçš„å­é—®é¢˜çš„æ•°é‡å‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œä»¥è‡³äºå°†å®ƒä»¬å…¨éƒ¨å­˜å‚¨åœ¨å†…å­˜ä¸­å˜å¾—ä¸å¯è¡Œã€‚</p><p>æ®æˆ‘ä»¬æ‰€çŸ¥æ˜¯ç¬¬ä¸€æ¬¡åœ¨CPæ±‚è§£å™¨ä¸­å†…ç½®å¯å­¦ä¹ çš„å¯å‘å¼æ¢ç´¢ï¼Œè¯¦ç»†çš„è´¡çŒ®å¦‚ä¸‹ï¼š</p><ol><li>å¯¹äºCOPé—®é¢˜æ–°çš„DPç¼–ç æ–¹å¼æ¥åˆ©ç”¨RLæ±‚è§£å’ŒCPæ¨¡å‹</li><li>åˆ©ç”¨ä¸¤ç§å¸¸è§çš„RLæ¨¡å‹ï¼ŒDQLã€PPOï¼Œè®­ç»ƒæ•°æ®é›†æ˜¯ä»é—®é¢˜ä¸­éšæœºæŠ½æ ·å¾—åˆ°çš„</li><li>ä¸ç°æœ‰çš„CPæ±‚è§£è¿‡ç¨‹ä¸­åˆ†æç­–ç»“åˆï¼Œå½¢æˆä¸‰ç§ brand and bound \ iterative limited discrpancy search and restart based searchä¸‰ç§</li><li>ç»™å‡ºæœ‰æ„ä¹‰çš„ç»“æœ</li><li>ä»£ç å¼€æºï¼Œä¸ºäº†ç®€åŒ–åç»­ç ”ç©¶çš„è¿›ç¨‹</li></ol><p>é€šå¸¸å¦‚æœæ²¡æœ‰å†…åœ¨çš„å‡è®¾ï¼Œæ¯”å¦‚çº¿å½¢å’Œå‡¸æ€§ï¼ŒDPä¸èƒ½ç®€å•çš„ç¼–ç ç„¶ååˆ©ç”¨æ ‡å‡†çš„MIPæ–¹æ³•æ±‚è§£ï¼Œè¿™ä¹Ÿæ˜¯é©±åŠ¨æˆ‘ä»¬æ€è€ƒå°è¯•ä½¿ç”¨CPè¿›è¡Œç¼–ç çš„åŸå› ä¹‹ä¸€</p><p>ä¸‹ä¸€ç« ç»™å‡ºæ··åˆæ•´æ•°æ±‚è§£å™¨æ±‚è§£çš„è¿‡ç¨‹</p><p>å¯¹ä¸¤ä¸ªæ¡ˆä¾‹è¿›è¡Œå®éªŒåˆ†æ</p><p>æœ€åç»™å‡ºæ€»ç»“</p><h1 id="2-æ•°æ®è¡¨å¾"><a class="markdownIt-Anchor" href="#2-æ•°æ®è¡¨å¾"></a> 2  æ•°æ®è¡¨å¾</h1><p>è¿™ä¸€éƒ¨åˆ†æ€»ç»“æˆ‘ä»¬æå‡ºçš„å®Œæ•´çš„æ¡†æ¶ï¼Œä¸€ä¸ªæ¦‚æ‹¬æ€§çš„æ¡†æ¶å›¾åœ¨å›¾ä¸€ä¸­å±•ç¤ºï¼Œåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>å­¦ä¹ éƒ¨åˆ†ï¼Œåˆ©ç”¨éšæœºç”Ÿæˆçš„ä¾‹å­é€šè¿‡unifying representationä½œä¸ºRLçš„ç¯å¢ƒè¿›è¡Œè®­ç»ƒï¼Œæœ€ç»ˆè®­ç»ƒçš„æ™ºèƒ½ä½“æ˜¯å¯¹æ±‚è§£è¿‡ç¨‹ä¸­searchçš„å¯å‘å¼åˆ†æç­–ç•¥è¿›è¡ŒåŸºäºä»·å€¼çš„é€‰æ‹©ï¼ˆæˆ–è€…è¯´æ˜¯å¼ºåŒ–å­¦ä¹ çš„æ¢ç´¢ï¼‰</li><li>æ±‚è§£éƒ¨åˆ†ï¼Œåˆ©ç”¨CPå¯¹æ¨¡å‹è¿›è¡Œæ±‚è§£ï¼ŒåŒæ—¶å¯¹æ±‚è§£çš„æ¡ˆä¾‹è¿›è¡Œè¯„ä¼°</li><li>è”åˆè¡¨ç¤ºé˜¶æ®µï¼Œè®²è¾“å…¥çš„COPé—®é¢˜ï¼Œç»“åˆDominance pruning ruleså‰ªæç­–ç•¥å¾—åˆ°åŠ¨æ€è§„åˆ’æ¨¡å‹çš„å»ºæ¨¡ï¼Œè¿™æ ·å¯ä»¥ä½œä¸ºå­¦ä¹ é˜¶æ®µçš„ç¯å¢ƒï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ±‚è§£èŠ‚ç‚¹çš„è¾“å…¥æ¨¡å‹</li></ol><p>ç»¿è‰²è¡¨ç¤ºæˆ‘ä»¬çš„åŸåˆ›å…±äº«ï¼Œè“è‰²è¡¨ç¤ºå·²ç»æœ‰çš„æ¡†æ¶</p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202212181549805.png" alt="image-20221218154958762" /></p><h2 id="21-åŠ¨æ€è§„åˆ’æ¨¡å‹"><a class="markdownIt-Anchor" href="#21-åŠ¨æ€è§„åˆ’æ¨¡å‹"></a> 2.1 åŠ¨æ€è§„åˆ’æ¨¡å‹</h2><p>åŠ¨æ€è§„åˆ’æ¨¡å‹æ˜¯ä¸€ç§å°†æ•°å­¦å»ºæ¨¡ä¸è®¡ç®—æœºç¼–ç¨‹è”ç³»èµ·æ¥æ±‚è§£å¤æ‚ä¼˜åŒ–é—®é¢˜çš„æ‰‹æ®µï¼Œç®€å•æ¥è¯´æ˜¯å°†ä¸€ä¸ªå¤§çš„é—®é¢˜è½¬æ¢æˆå¾ˆå¤šå°çš„å­é—®é¢˜ç„¶åå°†ä»–ä»¬åˆ©ç”¨recursive formulationçš„æ–¹å¼è”ç³»èµ·æ¥æœ€ç»ˆæ±‚è§£ï¼Œå…¶ä¸­åŒ…æ‹¬çš„ä¸€äº›å…³é”®çš„å½±å“å› ç´ </p><table><thead><tr><th>Q</th><th>COPé—®é¢˜</th></tr></thead><tbody><tr><td>controls</td><td>C</td></tr><tr><td>domain</td><td>D</td></tr><tr><td>transition</td><td>T</td></tr><tr><td>states</td><td>S</td></tr><tr><td>stage</td><td></td></tr><tr><td>reward</td><td>R</td></tr><tr><td>validity conditions</td><td>V</td></tr><tr><td>dominance rules</td><td>P</td></tr></tbody></table><p>å…¶ä¸­validity conditions å’Œdominance rulesä¹‹é—´çš„åŒºåˆ«åœ¨äºä¸¤è€…ä¹‹é—´çš„åŒºåˆ«åœ¨äºï¼Œæœ‰æ•ˆæ€§æ¡ä»¶æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œä»¥ç¡®ä¿DPæ¨¡å‹çš„æ­£ç¡®æ€§ï¼ˆV ï¼ˆsï¼Œ xï¼‰ = 0 â‡” Tï¼ˆsï¼Œ xï¼‰ = âŠ¥ï¼‰ï¼Œè€Œä¼˜åŠ¿è§„åˆ™ä»…ç”¨äºæ•ˆç‡ç›®çš„ï¼ˆPï¼ˆsï¼Œ xï¼‰ = 0 â‡’ Tï¼ˆsï¼Œ xï¼‰ = âŠ¥ï¼‰ï¼Œå…¶ä¸­â‡”ã€â‡’å’ŒâŠ¥è¡¨ç¤ºç­‰ä»·æ€§ã€å«ä¹‰ã€ å’Œä¸å¯è¡Œçš„çŠ¶æ€ï¼Œåˆ†åˆ«ã€‚å…¶ä¸­DPå»ºæ¨¡å¯ä»¥åŒ…æ‹¬ Sï¼ŒXï¼ŒTï¼ŒRï¼ŒVï¼ŒPï¼›æ ¹æ®è´å°”æ›¼æ–¹ç¨‹æˆ‘ä»¬å¯ä»¥ä¸€ç›´è®¡ç®—åˆ°å¼€å¤´çš„çŠ¶æ€çš„ä»·å€¼ã€‚</p><p>ä½†æ˜¯DPæ”¶åˆ°curse of dimensionalityçš„å½±å“ï¼Œåœ¨è§£å†³å¤§çš„çŠ¶æ€æˆ–è€…åŠ¨ä½œç©ºé—´ä¸‹éœ€è¦çš„å†…å­˜å¾ˆå¤šï¼Œä¸€ç§æ–¹æ³•æ˜¯å¯¹å…¶è¿›è¡Œå‰ªæå¤„ç†ï¼Œå…¶ä¸­éœ€è¦è¯„ä¼°</p><p>æ­¤é—®é¢˜çš„éƒ¨åˆ†è§£å†³æ–¹æ¡ˆæ˜¯ä¿®å‰ªä¸»å¯¼æ“ä½œ ï¼ˆPï¼ˆsï¼Œ xï¼‰ = 0ï¼‰ã€‚å¦‚æœä¸€ä¸ªåŠ¨ä½œæ ¹æ®é€’å½’å…¬å¼æ˜¯æœ‰æ•ˆçš„ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸»å¯¼çš„ï¼Œä½†ï¼ˆ1ï¼‰è¦ä¹ˆä¸¥æ ¼åœ°æ¯”å¦ä¸€ä¸ªåŠ¨ä½œå·®ï¼Œè¦ä¹ˆï¼ˆ2ï¼‰å®ƒä¸èƒ½å¯¼è‡´å¯è¡Œçš„è§£å†³æ–¹æ¡ˆã€‚åœ¨å®è·µä¸­ï¼Œä¿®å‰ªè¿™äº›ä¸»å¯¼æ“ä½œä¼šå¯¹æœç´¢ç©ºé—´çš„å¤§å°äº§ç”Ÿå·¨å¤§å½±å“ï¼Œä½†æ˜¯åœ¨å®è·µè¿‡ç¨‹ä¸­æ‰¾åˆ°è¿™æ ·çš„æ±‚è§£æ–¹æ¡ˆå¹¶ä¸æ˜¯å®¹æ˜“çš„</p><p>è€Œä¸”å°±ç®—åœ¨DPè¿‡ç¨‹ä¸­å¯¹ä¸Šè¿°çš„å­é—®é¢˜è¿›è¡Œä¿®å»ºä¹‹åä»ä¸èƒ½ç¡®ä¿è§£ç©ºé—´è¶³å¤Ÿå°</p><h2 id="22-å¼ºåŒ–å­¦ä¹ ç¼–ç "><a class="markdownIt-Anchor" href="#22-å¼ºåŒ–å­¦ä¹ ç¼–ç "></a> 2.2 å¼ºåŒ–å­¦ä¹ ç¼–ç </h2><p>ä»DPé—®é¢˜ä¸­ï¼Œç»“åˆä¸€ä¸ªå®é™…COPé—®é¢˜å¯ä»¥å®šä¹‰ä¸€ä¸ªå¼ºåŒ–å­¦ä¹ è¿‡ç¨‹ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå…³äºå¼ºåŒ–å­¦ä¹ çš„æ¦‚è¿°</p><p>ä»‹ç»å¼ºåŒ–å­¦ä¹ çš„ä½œç”¨ï¼š</p><p>ä»‹ç»ä¸€ä¸ªåŸºæœ¬çš„è¿‡ç¨‹</p><h3 id="221-state"><a class="markdownIt-Anchor" href="#221-state"></a> 2.2.1 State</h3><p>å¯¹äºDPé—®é¢˜ä¸­ä¸åŒçš„é˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼ˆQï¼Œs_iï¼‰ä½œä¸ºå½“å‰çŠ¶æ€çš„å®šä¹‰ï¼Œé€šå¸¸çŠ¶æ€è¢«embedä¸€ç§å¼ é‡ä½œä¸ºç¥ç»ç½‘ç»œçš„è¾“å…¥ï¼Œä¹ŸåŒ…æ‹¬actionï¼Œæœ€ç»ˆè¾“å‡ºæ˜¯æœ€ä¼˜çš„åŠ¨ä½œ</p><h3 id="222-action"><a class="markdownIt-Anchor" href="#222-action"></a> 2.2.2 Action</h3><p>ç»™å®šä¸€ä¸ªDPé—®é¢˜ä¸­çš„stateï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ç§ä¸€å¯¹ä¸€å…³ç³»çš„ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>å¯ä»¥è¢«é‡‡ç”¨é™¤é<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>æ˜¯æœ‰æ•ˆçš„ï¼Œé€šå¸¸å¯è¡Œçš„åŠ¨ä½œå¯ä»¥ç”±domainå’Œvalidè¿›è¡Œåˆ¤æ–­</p><h3 id="223-transition"><a class="markdownIt-Anchor" href="#223-transition"></a> 2.2.3 Transition</h3><p>è¾“å…¥å½“å‰çŠ¶æ€å’Œä¾—æ—å“¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨DPé—®é¢˜æ¥è¿›è¡Œè½¬æ¢å°±è¡Œ</p><h3 id="224-reward"><a class="markdownIt-Anchor" href="#224-reward"></a> 2.2.4 Reward</h3><p>æœ€åˆçš„æƒ³æ³•æ˜¯ä½¿ç”¨DPé—®é¢˜ä¸­å­˜åœ¨çš„å¥–åŠ±ï¼Œä½†æ˜¯è¿™æ ·å¯èƒ½ä¼šå­˜åœ¨æ²¡æœ‰è§£çš„è½¨è¿¹å¥–åŠ±è¦é«˜äºæœ‰è§£æ–¹æ¡ˆçš„å¥–åŠ±ï¼Œå› æ­¤åœ¨è®¾è®¡å¥–åŠ±çš„éœ€è¦è€ƒè™‘COPé—®é¢˜ä¸­å­˜åœ¨çš„ä¸¤ä¸ªåŸåˆ™</p><p>1ï¼Œ å¦‚æœe1æ¯”e2æ›´åï¼Œæˆ‘ä»¬éœ€è¦e1çš„å¥–åŠ±å°äºe2çš„å¥–åŠ±</p><ol><li>æ‰€æœ‰æ‰¾åˆ°å¯è¡Œè§£çš„è½¨è¿¹éœ€è¦æ¯”æ²¡æœ‰æ‰¾åˆ°å¯è¡Œè§£çš„è½¨è¿¹é«˜</li></ol><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi>Ï•</mi><mo>(</mo><mn>1</mn><mo>+</mo><mi mathvariant="normal">âˆ£</mi><mi>U</mi><mi>B</mi><mo>(</mo><msub><mi>Q</mi><mi>p</mi></msub><mo>)</mo><mi mathvariant="normal">âˆ£</mi><mo>+</mo><mi>r</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">R(s,a)=\phi(1+|UB(Q_p)|+r(s,a) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">Ï•</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">+</span><span class="mord mathrm">âˆ£</span><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathrm">âˆ£</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span></span></p><p>UBå¯¹åº”è§„åˆ’é—®é¢˜å¯èƒ½åˆ°è¾¾çš„ä¸Šé™ï¼Œç¬¬äºŒä¸ªé—®é¢˜å¼ºè¿«æ™ºèƒ½ä½“å»å¯»æ‰¾åˆ°æœ€ä½³çš„å¯è¡Œè§£ï¼Œæœ€ç»ˆçš„scaling factor é˜²æ­¢æœ€ç»ˆå¥–åŠ±è½å…¥é›¶å€¼å‘¨è¾¹</p><h2 id="23-å­¦ä¹ æ–¹æ³•"><a class="markdownIt-Anchor" href="#23-å­¦ä¹ æ–¹æ³•"></a> 2.3 å­¦ä¹ æ–¹æ³•</h2><p>DQN</p><p>PPO</p><p>æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„å‡è®¾ï¼Œåˆ©ç”¨ç”Ÿæˆå™¨å¾—åˆ°instanceçš„æ—¶å€™ï¼Œå¾—åˆ°çš„åˆ†å¸ƒä¸å®é™…é—®é¢˜ä¸­çš„é—®é¢˜æƒ³ç­‰ï¼Œè¿™ä¹Ÿæ˜¯åœ¨RLè§£å†³å…¶ä»–é—®é¢˜ä¸­å¸¸è§çš„å‡è®¾ï¼Œå¼ºåŒ–å­¦ä¹ çš„è¿‡ç¨‹æ˜¯å¸Œæœ›å­¦ä¹ å‡ºä¸åŒçŠ¶æ€å’ŒåŠ¨ä½œä¸‹å¾—åˆ°ä¸åŒçš„Qï¼Œæˆ‘ä»¬çš„ç­–ç•¥å¾€å¾€æ˜¯é‡‡ç”¨æœ€å¤§Qå€¼çš„ä¸œè¥¿ï¼Œåˆ©ç”¨DQNå¾—åˆ°Qå€¼çš„è®­ç»ƒè¿‡ç¨‹æœ‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Trainerâ€”â€”DQNï¼ˆï¼‰</span><br><span class="hljs-comment"># class Envï¼Œ</span><br><span class="hljs-comment"># class BrainDQN</span><br><span class="hljs-comment"># class TSPTW</span><br><span class="hljs-comment"># class state</span><br></code></pre></td></tr></table></figure><p>å±•ç°ä»£ç çš„è°ƒç”¨è¿‡ç¨‹</p><ol><li>è¿™ä¸€æ­¥ä»…ä»…æ˜¯å¸Œæœ›è®­ç»ƒå‡ºDQNçš„brainï¼Œè€Œæ²¡æœ‰å…¶ä»–çš„ä¸œè¥¿</li><li>é‡ç‚¹åœ¨ç¯å¢ƒç”Ÿæˆï¼Œä»¥åŠè®­ç»ƒçš„æ•´ä¸ªè¿‡ç¨‹</li></ol><p>é¦–å…ˆç¡®ä¿å¦‚ä½•ç”Ÿæˆä¸€ä¸ªTSPTWé—®é¢˜</p><p>ä¹‹åç”Ÿæˆå¤šä¸ªä½œä¸ºè®­ç»ƒçš„é›†åˆ</p><p>åŒæ—¶åœ¨æ¯æ¬¡è®­ç»ƒä¸­æé«˜</p><h2 id="24-ç½‘ç»œæ¡†æ¶"><a class="markdownIt-Anchor" href="#24-ç½‘ç»œæ¡†æ¶"></a> 2.4 ç½‘ç»œæ¡†æ¶</h2><p>ä¸ºäº†ç¡®ä¿æ¡†æ¶çš„é€šç”¨å‹å’Œæœ‰æ•ˆæ€§ï¼Œå¯¹äºç½‘ç»œæ¡†æ¶æˆ‘ä»¬éœ€è¦ç¡®ä¿ä¸¤ä»¶äº‹æƒ…</p><ol><li>å¯¹äºç›¸åŒçš„COPé—®é¢˜ï¼Œå¯ä»¥æœ‰ä¸åŒçš„è¾“å…¥å°ºå¯¸</li><li>å¯¹è¾“å…¥çš„æ’åˆ—ä¿æŒä¸å˜</li></ol><p>ä¸ºäº†ä¿è¯è¿™æ ·çš„æ¶æ„æˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨ä¸€ç§Transformeræ¶æ„ï¼Œå¯¹äºTSPé—®é¢˜å¤©ç„¶çš„æˆ‘ä»¬å¯ä»¥é‡‡ç”¨GATçš„æ–¹å¼æ¥å®ç°åºåˆ—åˆ°åºåˆ—çš„è½¬æ¢</p><p>å¯¹äºDQNç½‘ç»œä¸­æœ€åä¸€å±‚çš„è¾“å…¥æ˜¯ä¸åŒåŠ¨ä½œå¯¹åº”çš„Q- value</p><h2 id="25-cp-encoding"><a class="markdownIt-Anchor" href="#25-cp-encoding"></a> 2.5 CP Encoding</h2><p>ç°åœ¨ä»‹ç»å¦‚ä½•å°†DPè¿‡ç¨‹ç¼–ç æ”¾å…¥Constraint model</p><table><thead><tr><th></th><th>CP</th><th>DP</th></tr></thead><tbody><tr><td>variable and domains</td><td>X- decision variablesï¼Œset of the variablesï¼Œè¡¨ç¤ºåŠ¨ä½œ</td><td>X</td></tr><tr><td></td><td>X-auxiliary variablesï¼Œè¡¨ç¤ºstate</td><td>S</td></tr><tr><td></td><td>Dï¼Œset of the domain</td><td>V</td></tr><tr><td></td><td>Cï¼Œset of the constraints</td><td>P</td></tr><tr><td></td><td>Oï¼Œobjective function</td><td>åœ¨åé¢Né˜¶æ®µä¸­çš„æœ€å¤§å€¼ï¼Œè¿™é‡Œçš„åŠ¨æ€è§„åˆ’æ–¹å‘ä»…ä»…å’Œx_aæœ‰å…³</td></tr></tbody></table><h2 id="26-æœç´¢ç­–ç•¥"><a class="markdownIt-Anchor" href="#26-æœç´¢ç­–ç•¥"></a> 2.6 æœç´¢ç­–ç•¥</h2><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202212181550868.png" alt="image-20221218155022842" /></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202212181550935.png" alt="image-20221218155036915" /></p><p>ä¸DPæ–¹å¼ç›¸åŒï¼Œæˆ‘ä»¬ç”¨æ­¤æ¥æ„å»ºRLçš„ç¯å¢ƒï¼ˆå¹¶å›ºå®šCOé—®é¢˜ï¼‰æ¥å¾—åˆ°åŠ¨ä½œçš„è¾“å‡ºï¼Œæ¡†æ¶çš„ç»Ÿä¸€æ€§æ˜¯é—®é¢˜çš„æ ¸å¿ƒï¼Œè¿™ä¸€éƒ¨åˆ†å±•ç¤ºæˆ‘ä»¬å¦‚ä½•å°†å­¦ä¹ çš„æ¨¡å‹åµŒå…¥åˆ°CPæœç´¢ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘å‡ ç§å¸¸è§çš„æœç´¢æ–¹å¼</p><ol><li>Depth-first branch-and-bound search</li><li>iterative limited discrepancy search</li><li>restart based search</li></ol><p>è¿™é‡Œä»…ä»‹ç»ç¬¬ä¸€ç§æœç´¢ç­–ç•¥ä¸DQNçš„ç»“åˆï¼ŒDFSç¡®ä¿äº†å½“ä¸€ä¸ªå¯è¡Œè§£æ‰¾åˆ°ä¹‹åï¼Œä¸‹ä¸€ä¸ªè§£éœ€è¦å¥½ä¸å½“å‰çš„ï¼Œå½“é‡åˆ°æ²¡æœ‰å¯è¡Œçš„åˆ†æ”¯ä¼šå›æº¯åˆ°ä¹‹å‰çš„åˆ†æ”¯ï¼Œç”±æ­¤æ¥ç¡®ä¿æ•´ä¸ªè§£ç©ºé—´éƒ½å¾—åˆ°éå†ï¼ŒåŒæ—¶æœ€ç»ˆå¾—åˆ°çš„è§£å¯ä»¥è¢«è¯æ˜æ˜¯æœ€ä¼˜çš„optimalï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦éå¸¸å¥½çš„value- selection</p><p>åœ¨å­¦ä¹ ä¹‹åï¼ŒDQNçš„ä½œç”¨æ˜¯è¾“å…¥å½“å‰çš„çŠ¶æ€ï¼Œä»¥åŠå¯è¡Œçš„åŠ¨ä½œï¼Œè¾“å…¥ä¸åŒåŠ¨ä½œçš„æœ€å¤§å€¼ï¼Œè¿™é‡Œå¯ä»¥è´ªå¿ƒæœç´¢çš„æ–¹å¼è¿›è¡Œä¸‹å»ï¼Œå°½ç®¡å¯èƒ½ä¸æ˜¯æœ€ä¼˜çš„ï¼Œéœ€è¦ä¿è¯å’ŒDPé—®é¢˜ä¸­å­˜åœ¨çš„ä¸€è‡´æ€§ï¼Œé€šå¸¸è¿™é‡Œä¼šæœ‰ä¸€äº›è¿‘ä¼¼å˜é‡æ¥ä½œä¸ºå¯¹DPé—®é¢˜çš„å…³é”®å½±å“ï¼Œä½†æ˜¯è¿™é‡Œä¸æ˜¯é‡ç‚¹</p><p>æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹è¡¨æ‰€ç¤ºâ¬‡ï¸</p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202212181551671.png" alt="image-20221218155108646" /></p><h1 id="3-experimental-result"><a class="markdownIt-Anchor" href="#3-experimental-result"></a> 3 Experimental result</h1><p>TSPTWæ˜¯ä»ä¼ ç»Ÿçš„TSPé—®é¢˜ä¸­å¾—åˆ°çš„ï¼Œåªæ˜¯ç»™æ‰€æœ‰çš„salesmanå¢åŠ ä¸€ä¸ªæ—¶é—´çª—çš„æ¦‚å¿µï¼Œæœ€ç»ˆè§„å®šéœ€è¦åœ¨è§„å®šæ—¶é—´å†…æ²¿ç€æ‰€æœ‰çš„èŠ‚ç‚¹èµ°ä¸€åœˆã€‚</p><p><a href="https://developers.google.com/optimization/routing/vrptw">Vehicle Routing Problem with Time Windows | OR-Tools | Google Developers</a></p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202212181551430.png" alt="image-20221218155120405" /></p><p>æœ€ç»ˆè¯æ˜äº†ç»“æœ</p><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202212181551101.png" alt="image-20221218155134078" /></p><h1 id="4-discussion-and-limitation"><a class="markdownIt-Anchor" href="#4-discussion-and-limitation"></a> 4 Discussion and Limitation</h1><p>é¦–å…ˆæœ¬æ–‡å¹¶ä¸æ˜¯ç¬¬ä¸€ä¸ªå°è¯•ä½¿ç”¨MLæ¥å¼•å¯¼ä¼˜åŒ–æ±‚è§£å™¨çš„åˆ†æ”¯ï¼Œä½†æ˜¯ä»–ä»¬çš„æ–¹æ³•ä¸“æ³¨äºç›‘ç£å­¦ä¹ å¹¶ä¸”ä»…é™äºçº¿æ€§é—®é¢˜ï¼Œè¿™é‡Œæœ¬æ–‡çš„å…±äº«</p><ol><li>å…³æ³¨ä¸å°†COPé—®é¢˜å»ºæ¨¡æˆä¸ºDP</li><li>å®Œå…¨åˆ©ç”¨RLè¿›è¡Œè®­ç»ƒ</li></ol><p>åŒæ—¶ç»“åˆCPé—®é¢˜çš„å®Œæ•´æ€§ï¼Œå¯ä»¥æ›´å¥½çš„æ±‚è§£ä¸€ç³»åˆ—é—®é¢˜åŒ…æ‹¬éçº¿æ€§çº¦æŸæˆ–è€…éçº¿æ€§çº¦æŸå‡½æ•°</p><p>åŒæ—¶æˆ‘ä»¬ä¹Ÿä¸éœ€è¦ä¸€äº›å†å²æ•°æ®æˆ–è€…ä»¿çœŸç”Ÿæˆå™¨ï¼ŒåŒæ—¶æ˜¯ä¸€ç§ç«¯åˆ°ç«¯çš„æ±‚è§£å™¨ï¼Œå¹¶ä¸”å¯ä»¥è¯æ˜æ±‚è§£ç»“æœçš„æœ€ä¼˜æ€§</p><h1 id="5-conclusion"><a class="markdownIt-Anchor" href="#5-conclusion"></a> 5 Conclusion</h1><p>è¿™äº›ç»“æœè¡¨æ˜ï¼Œè¯¥æ¡†æ¶å¯èƒ½æ˜¯è§£å†³å…·æœ‰æŒ‘æˆ˜æ€§çš„ç»„åˆä¼˜åŒ–é—®é¢˜çš„ä¸€ç§æœ‰å‰é€”çš„æ–°é€”å¾„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><br></code></pre></td></tr></table></figure><p><img src="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202212181551911.png" alt="image-20221218155147889" /></p><p><a href="https://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/img/202212181553133.pdf">æ€»ç»“çš„ppt</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æ‘˜è¦&lt;/p&gt;</summary>
    
    
    
    <category term="RL" scheme="https://blog.tjdata.site/categories/RL/"/>
    
    
    <category term="paper" scheme="https://blog.tjdata.site/tags/paper/"/>
    
  </entry>
  
  <entry>
    <title>Paper03_Rainbow_Combining_Improvements_in_Deep_Reinforcement_Learning</title>
    <link href="https://blog.tjdata.site/posts/d590ba5e.html"/>
    <id>https://blog.tjdata.site/posts/d590ba5e.html</id>
    <published>2022-11-06T10:38:36.000Z</published>
    <updated>2023-05-13T13:50:20.683Z</updated>
    
    <content type="html"><![CDATA[<p>ä½œè€…ï¼šHessel, M., Modayil, J., Van Hasselt, H., Schaul, T., Ostrovski, G., Dabney, W., â€¦ &amp; Silver, D.</p><p>å®éªŒå®¤ï¼šGoogle DeepMind</p><p>è®ºæ–‡åœ°å€ï¼š<a href="https://arxiv.org/pdf/1710.02298">https://arxiv.org/pdf/1710.02298</a></p><p>å‘è¡¨ï¼š In <em>Thirty-second AAAI conference on artificial intelligence</em>.</p><span id="more"></span><h2 id="0x01-æ‘˜è¦"><a class="markdownIt-Anchor" href="#0x01-æ‘˜è¦"></a> 0x01 æ‘˜è¦</h2><h3 id="11-æ‘˜è¦èƒŒæ™¯åŠé—®é¢˜"><a class="markdownIt-Anchor" href="#11-æ‘˜è¦èƒŒæ™¯åŠé—®é¢˜"></a> 1.1 æ‘˜è¦â€“èƒŒæ™¯åŠé—®é¢˜</h3><p>ä»DQN<sup><a href="#ref1">1</a></sup>æ¨å¯¼è¿‡ç¨‹ä¸­å‘ç°ä¾æ—§å­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼Œå¸¸è§çš„æ”¹è¿›æªæ–½Double DQN<sup><a href="#ref1">2</a></sup>ã€Dueling DQN<sup><a href="#ref1">3</a></sup>ã€Prioritized replay<sup><a href="#ref1">4</a></sup>ã€Multi-step<sup><a href="#ref1">5</a></sup>ã€Distributional RL<sup><a href="#ref1">6</a></sup>ã€Noisy Net<sup><a href="#ref1">7</a></sup>ç­‰æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å¹¶ä¸æ˜¯å®Œå…¨ç‹¬ç«‹ï¼Œæ¯”å¦‚åœ¨Duelingä¸­å…¶å®å·²ç»å°†Double DQNå’ŒPrioritized replayç»“åˆèµ·æ¥ã€‚</p><h3 id="12-æ‘˜è¦æ–¹æ³•"><a class="markdownIt-Anchor" href="#12-æ‘˜è¦æ–¹æ³•"></a> 1.2 æ‘˜è¦â€“æ–¹æ³•</h3><p>æœ¬æ–‡å¸Œæœ›å°†ä¸Šè¿°å…­ç§DQNæ–¹æ³•ç»“åˆç»éªŒèåˆåœ¨ä¸€èµ·ï¼Œæ¥å¾—åˆ°ä¸€ä¸ªæ›´å¥½çš„ç½‘ç»œã€‚</p><h3 id="13-æ‘˜è¦è´¡çŒ®"><a class="markdownIt-Anchor" href="#13-æ‘˜è¦è´¡çŒ®"></a> 1.3 æ‘˜è¦â€“è´¡çŒ®</h3><ol><li>æˆä¸ºAtari 2600ä¸­SOTA</li><li>æˆ‘ä»¬è¿˜æä¾›è¯¦ç»†çš„æ¶ˆèç ”ç©¶çš„ç»“æœï¼Œè¯¥ç ”ç©¶ç»“æœæ˜¾ç¤ºäº†æ¯ä¸ªç»„ä»¶å¯¹æ•´ä½“æ€§èƒ½çš„è´¡çŒ®ã€‚</li></ol><h2 id="0x02-é—®é¢˜èƒŒæ™¯"><a class="markdownIt-Anchor" href="#0x02-é—®é¢˜èƒŒæ™¯"></a> 0x02 é—®é¢˜èƒŒæ™¯</h2><h3 id="21-rl-problem-è®°å·"><a class="markdownIt-Anchor" href="#21-rl-problem-è®°å·"></a> 2.1 RL problem &amp; è®°å·</h3><p>å¼ºåŒ–å­¦ä¹ å¸Œæœ›ä¸€ä¸ªå…·æœ‰è¡Œä¸ºï¼ˆaction)çš„æ™ºèƒ½ä½“(agent) åœ¨ä¸ç¯å¢ƒ(environment)äº¤äº’çš„è¿‡ç¨‹å¯ä»¥æœ€å¤§åŒ–å¥–åŠ±(reward),åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¹¶ä¸ä¼šç›´æ¥ç›‘ç£å¼çš„å­¦ä¹ ã€‚è¿™é‡Œåˆ†äº«å¦å¤–ä¸€ç§å®šä¹‰:</p><blockquote><p>ä¸€ã€Mathematical formalism for learning- based decision making</p><p>äºŒã€Approach for learning decision making and control form experience</p></blockquote><p>**MDP (Markov Decision Process) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><mi>S</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>r</mi><mo separator="true">,</mo><mi>Î³</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">\{S,A,T,r,\gamma\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mord mathit">A</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mclose">}</span></span></span></span> **</p><p>åœ¨ä¸åŒçš„æ—¶é—´æ­¥ä¸‹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">t=0,1,2,..</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">2</span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span></span></span></span>ï¼Œç¯å¢ƒçŠ¶æ€<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>æä¾›ç»™æ™ºèƒ½ä½“ä¸€ä¸ªè§‚æµ‹ä¿¡æ¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>O</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">O_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>,é€šå¸¸æˆ‘ä»¬ä¼šè®¤ä¸ºæ˜¯å®Œå…¨è§‚æµ‹(å³<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><msub><mi>O</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S_t=O_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>)ï¼ŒåŒæ—¶æ™ºèƒ½ä½“æ ¹æ®è§‚æµ‹ä¿¡æ¯åšå‡ºåŠ¨ä½œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>, ä¹‹åç¯å¢ƒç»™å‡ºä¸‹ä¸€ä¸ªå¥–åŠ±<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">R_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>,å¥–åŠ±çš„æŠ˜æ‰£<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Î³</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\gamma_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>ä»¥åŠæ›´æ–°çŠ¶æ€ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">S_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-033033.jpg" alt="MDP" /></p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹é€šå¸¸<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo separator="true">,</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">S,A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mord mathit">A</span></span></span></span>æ˜¯æœ‰é™çš„æƒ…å†µ,å¯¹äºç¯å¢ƒæ¥è¯´çŠ¶æ€è½¬ç§»ï¼ˆstochastic transition function)ï¼›å¥–åŠ±æ–¹ç¨‹åŒ…æ‹¬</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo><mo>=</mo><mi>P</mi><mo>[</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>=</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">T(s,a,s&#x27;)=P[S_{t+1=s&#x27;}|S_t=s,A_t=a]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.801892em;"></span><span class="strut bottom" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mclose">]</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi>E</mi><mo>[</mo><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">r(s,a)=E[R_{t+1}|S_t=s,A_t=a]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mclose">]</span></span></span></span></span></p><p>å¯¹äºæ™ºèƒ½ä½“æ¥è¯´ï¼Œæ ¹æ®çŠ¶æ€<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>ï¼ˆæˆ–è€…å®Œå…¨è§‚æµ‹ä¸‹çš„è§‚æµ‹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>O</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">O_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>)å¾—åˆ°å¾—åˆ°åŠ¨ä½œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>æ¥è‡ªäºç­–ç•¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span></span>ï¼ˆpolicy),åœ¨åºåˆ—å†³ç­–ä¸­æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–æŸä¸ªçŠ¶æ€é‡‡å–æŸä¸ªåŠ¨ä½œçš„æŠ˜æ‰£å¥–åŠ±ä¹‹å’Œ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo>)</mo><mo>=</mo><msub><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow></msub><mo>[</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mi mathvariant="normal">âˆ£</mi><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">P(A_t=a)=\pi_{\theta}[A_t=a|S_t=s]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">s</span><span class="mclose">]</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi mathvariant="normal">âˆ</mi></mrow></msubsup><msubsup><mi>r</mi><mi>t</mi><mrow><mi>k</mi></mrow></msubsup><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">max G_t=\Sigma_{k=0}^{\infty}r_t^{k}R_{t+k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8991079999999998em;"></span><span class="strut bottom" style="height:1.146108em;vertical-align:-0.247em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">âˆ</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.247em;margin-left:-0.02778em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><p>æˆ‘ä»¬åœ¨åˆ©ç”¨ç®—æ³•è¿›è¡Œæ¢¯åº¦æå‡é€šå¸¸ä¼šç»è¿‡ä¸‰ä¸ªæ­¥éª¤</p><ol><li>ç”Ÿæˆæ ·æœ¬</li><li>è¯„ä¼°æ¨¡å‹æˆ–è€…æ˜¯è®¡ç®—return</li><li>æå‡ç­–ç•¥</li></ol><h3 id="22-policy-gradientç›´æ¥æå‡policy"><a class="markdownIt-Anchor" href="#22-policy-gradientç›´æ¥æå‡policy"></a> 2.2 Policy Gradientï¼šç›´æ¥æå‡policy</h3><p>ä¸ºäº†æœ€å¤§åŒ–ç­–ç•¥çš„å›æŠ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>G</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">G_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>æœ€å¤§åŒ–ï¼ˆREINFRORCEMENTï¼‰ï¼Œæ¨å¯¼è¿‡ç¨‹ç•¥</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-101742.png" alt="REINFORCE algorithm " /></p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨baselineã€n-stepsã€discountã€import samplingçš„æ–¹æ³•å¯¹ä»–è¿›è¡Œæ”¹è¿›ã€‚</p><h3 id="23-actor-crticæ–¹æ³•returnä¸policyåˆ†å¼€"><a class="markdownIt-Anchor" href="#23-actor-crticæ–¹æ³•returnä¸policyåˆ†å¼€"></a> 2.3 <strong>Actor-Crticæ–¹æ³•</strong>ï¼šReturnä¸Policyåˆ†å¼€</h3><p>ä¹Ÿå¯ä»¥å¼•å…¥æ–°çš„çŠ¶æ€ä»·å€¼å‡½æ•°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>V</mi><mrow><mi>Ï€</mi></mrow></msup><mo>(</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">V^{\pi}(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>æ¥ç»“åˆæ‹Ÿåˆçš„æ–¹å¼è®¡ç®—<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>G</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">G_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>ä¹‹åæœ€å¤§åŒ–(A3C),ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>V</mi><mrow><mi>Ï€</mi></mrow></msup><mo>(</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">V^{\pi}(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>å’ŒåŠ¨ä½œçŠ¶æ€ä»·å€¼å‡½æ•°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mrow><mi>Ï€</mi></mrow></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q^{\pi}(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span>æ¥è¿›è¡ŒåŸºäºä»·å€¼å‡½æ•°çš„å­¦ä¹ æ–¹æ³•ã€‚</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>V</mi><mrow><mi>Ï€</mi></mrow></msup><mo>(</mo><mi>s</mi><mo>)</mo><mo>=</mo><msub><mi>E</mi><mrow><mi>Ï€</mi></mrow></msub><mo>[</mo><msub><mi>G</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">V^{\pi}(s)=E_{\pi}[G_t|S_t=s]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">s</span><span class="mclose">]</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mrow><mi>Ï€</mi></mrow></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><msub><mi>E</mi><mi>Ï€</mi></msub><mo>[</mo><msub><mi>G</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">Q^{\pi}(s,a)=E_\pi[G_t|S_t=s,A_t=a]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mclose">]</span></span></span></span></span></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-102038.png" alt="batch actor-crtic algorithm" /></p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨replay bufferã€ç¥ç»ç½‘ç»œæ¥å­¦ä¹ é™ä½policy gradientä¸­çš„æ–¹å·®ã€‚</p><h3 id="24-value-based-method-æŠ›å¼ƒpolicy"><a class="markdownIt-Anchor" href="#24-value-based-method-æŠ›å¼ƒpolicy"></a> 2.4 Value- based method  æŠ›å¼ƒpolicy</h3><p>Policy iteration-&gt;Value iteration-&gt;Q learning</p><p>é¦–å…ˆä»policy iterationä¸value iterationè¯´èµ·ï¼Œ<a href="https://hrl.boyuai.com/chapter/1/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E7%AE%97%E6%B3%95">å‚è€ƒé“¾æ¥</a>å¯ä»¥çœ‹ä½œæ˜¯åˆ©ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹å¼ååº”å¼ºåŒ–å­¦ä¹ çš„è¿‡ç¨‹ï¼Œä¸¤è€…çš„åŒºåˆ«åœ¨äºååº”çš„æ˜¯è´å°”æ›¼æœŸæœ›è¿˜æ˜¯è´å°”æ›¼æœ€ä¼˜ã€‚</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-102432.png" alt="è´å°”æ›¼æœŸæœ›æ–¹ç¨‹" /></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-102502.png" alt="è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹" /></p><p>åœ¨åŸºäºä»·å€¼å­¦ä¹ ç®—æ³•çš„è¿‡ç¨‹ä¸­ï¼Œä¼˜ç‚¹æ˜¯æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªç»éªŒå›æ”¾æ± ï¼Œåªéœ€è¦<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo separator="true">,</mo><mi>r</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(s,a,s&#x27;,r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span>è€Œä¸æ˜¯éœ€è¦å®Œæ•´çš„å†³ç­–åºåˆ—ã€‚æˆ‘ä»¬é€šå¸¸ä¼šå¼•å…¥éšæœºæ¢ç´¢ï¼ˆexplorationï¼‰çš„æ¦‚å¿µï¼Œå¸¸è§çš„åŒ…æ‹¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ïµ</mi><mo>âˆ’</mo><mi>G</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>d</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">\epsilon-Greedy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Ïµ</span><span class="mbin">âˆ’</span><span class="mord mathit">G</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span>çš„æ–¹æ³•ï¼Œåœ¨ä¸€å®šæ¦‚ç‡ä¸‹é€‰æ‹©éç­–ç•¥äº§ç”Ÿçš„åŠ¨ä½œã€‚</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-034903.png" alt="epsilon-greedy" /></p><p>åœ¨ value iterationçš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æŠ›å¼ƒå¯¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mo>(</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">V(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>çš„å­¦ä¹ ï¼Œè€Œåªæ˜¯è®°å½•<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span>;Q- iteration algorithm(æˆ–è€…<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>âˆ’</mo><mi>l</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">Q- learning</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">n</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span>ï¼‰çœ‹è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-034721.png" alt="image-20221106114721046" /></p><h3 id="22-dqnæ¨å¯¼"><a class="markdownIt-Anchor" href="#22-dqnæ¨å¯¼"></a> 2.2 DQNæ¨å¯¼</h3><p>åœ¨ä¸Šè¿°æˆ‘ä»¬è®¤è¯†å¯¹äºMDPç›®æ ‡ï¼Œä»æ˜¾å¼è¡¨è¾¾Policyï¼Œåˆ°ç»“åˆValue functionå†åˆ°ä¹‹åçš„å®Œå…¨ä½¿ç”¨Value functionæ¥ä½¿ç”¨Q- learningçš„æ–¹æ³•ï¼Œæˆ‘ä»¬æ²¡æœ‰è§£å†³çš„é—®é¢˜åŒ…æ‹¬</p><ol><li>çŠ¶æ€-åŠ¨ä½œç©ºé—´çš„è¿ç»­æ€§</li><li>åœ¨çŠ¶æ€ç©ºé—´å’ŒåŠ¨ä½œç©ºé—´çº¬åº¦å¤§çš„æ—¶å€™æ— æ³•å‡†ç¡®åˆ»ç”» çŠ¶æ€-åŠ¨ä½œä»·å€¼</li></ol><p>éšç€ç¥ç»ç½‘ç»œçš„å‘å±•ï¼Œæˆ‘ä»¬å¸Œæœ›åˆ©ç”¨ç½‘ç»œæ‹Ÿåˆçš„æ–¹å¼æ¥è§£å†³ä¸Šè¿°é—®é¢˜ï¼ŒåŒæ—¶æ¯ä¸€æ­¥åˆ©ç”¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ïµ</mi><mo>âˆ’</mo><mi>G</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>d</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">\epsilon-Greedy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Ïµ</span><span class="mbin">âˆ’</span><span class="mord mathit">G</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span>çš„æ–¹å¼æ¥æ¢ç´¢å›æ”¾æ± ä¸­çš„ç»éªŒï¼Œå¹¶åˆ©ç”¨æ¢¯åº¦ä¸‹é™ç­‰æ–¹æ³•æœ€å°åŒ–ä»·å€¼å‡½æ•°è¡¨è¾¾çš„å›æŠ¥</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mo>(</mo><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>Î³</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow><msup><mi>a</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msup><mi>a</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo><mo>âˆ’</mo><msub><mi>q</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo><msup><mo>)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">min (R_{t+1}+\gamma_{t+1}max_{a&#x27;}(S_{t+1},a&#x27;)-q_{\theta}(S_t,A_t))^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8641079999999999em;"></span><span class="strut bottom" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><ul><li>1 åˆå§‹åŒ–å¤§å°ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span>çš„ç»éªŒå›æ”¾æ± (PSï¼šæ³¨æ„æœ‰å¤§å°é™åˆ¶)</li><li>2 ç”¨ç›¸åŒéšæœºçš„ç½‘ç»œå‚æ•°åˆå§‹åŒ–<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_{\theta}(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span>ä¸ç›®æ ‡ç½‘ç»œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_{\theta&#x27;}(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span></li><li>3 for å›åˆepisode=1ï¼ŒN doï¼š<ul><li>4 è·å–ç¯å¢ƒåˆå§‹çŠ¶æ€<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></li><li>5 for æ—¶é—´æ­¥numstep=1ï¼ŒT doï¼š<ul><li>6 æ ¹æ®å½“å‰ç½‘ç»œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>a</mi></msub><msub><mi>Q</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">a_t=max_a Q_{\theta}(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span>ç»“åˆ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ïµ</mi><mo>âˆ’</mo><mi>G</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>d</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">\epsilon-Greedy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Ïµ</span><span class="mbin">âˆ’</span><span class="mord mathit">G</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span>æ–¹æ³•æ¥å¾—åˆ°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">a_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>ï¼ˆPSï¼šæ³¨æ„è¿™ä¸€æ­¥åŠ¨ä½œçš„ç¡®å®šéšå«ä¹‹åDQNå›æŠ¥åå¤§çš„ç‰¹ç‚¹ï¼‰</li><li>7 æ‰§è¡ŒåŠ¨ä½œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">a_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>,è·å–<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>,ç¯å¢ƒçŠ¶æ€å˜ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></li><li>8 å­˜å‚¨ä¸Šè¿°é‡‡æ ·ä¿¡æ¯åˆ°ç»éªŒå›æ”¾æ± </li><li>9 if ç»éªŒå›æ”¾æ± æ•°ç›®è¶³å¤Ÿï¼š<ul><li>10 é‡‡æ ·batchsizeæ ·æœ¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>r</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>}</mo></mrow><annotation encoding="application/x-tex">\{s_t^i,a_t^i,r_t^i,s_{t+1}^i\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.131103em;vertical-align:-0.30643899999999996em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.247em;margin-left:-0.02778em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.36299999999999993em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">}</span></span></span></span></li><li>11 è®¡ç®—ç›®æ ‡å€¼<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>y</mi><mi>t</mi><mi>i</mi></msubsup><mo>=</mo><msubsup><mi>r</mi><mi>t</mi><mi>i</mi></msubsup><mo>+</mo><mi>Î³</mi><mo>âˆ—</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>a</mi></msub><msub><mi>Q</mi><mrow><mover accent="true"><mi>Î¸</mi><mo>^</mo></mover></mrow></msub><mo>(</mo><msubsup><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo></mrow><annotation encoding="application/x-tex">y^i_t=r^i_t+\gamma*max_aQ_{\hat \theta}(s^i_{t+1},a^i_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.1503799999999997em;vertical-align:-0.3257159999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.247em;margin-left:-0.02778em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mbin">âˆ—</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.3257159999999999em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span><span style="top:-0.26343999999999995em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.36299999999999993em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></li><li>12 æœ€å°åŒ–æŸå¤±å‡½æ•°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><mo>(</mo><msubsup><mi>y</mi><mi>t</mi><mi>i</mi></msubsup><mo>âˆ’</mo><msub><mi>Q</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><msup><mo>)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">L=\frac{1}{N}(y_t^i-Q_{\theta}(s_t^i,a_t^i))^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.845108em;"></span><span class="strut bottom" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></li><li>13 æ›´æ–°ç½‘ç»œå‚æ•°</li></ul></li></ul></li><li>14 END FOR</li><li>15 æ›´æ–°ç›®æ ‡ç½‘ç»œå‚æ•°</li></ul></li><li>16 END FOR</li></ul><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-040037.png" alt="Deep Q- learning with Experience Replay" /></p><p>å…¶ä¸­éå¸¸æœ‰è¶£çš„æŠ€å·§åŒ…æ‹¬ï¼š</p><ol><li>ç»éªŒå›æ”¾(Experience Replay )ä¸éšæœºæ¢ç´¢;è¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯ä¸ºäº†æé«˜æ ·æœ¬é‡‡æ ·æ•ˆç‡ï¼ŒåŒæ—¶é™ä½åç»­æ¢¯åº¦ä¸‹é™ä¸­æ ·æœ¬çš„ç›¸å…³æ€§ã€‚</li><li>ç›®æ ‡ç½‘ç»œ(Target Network)ï¼Œç”±äºTDè¯¯å·®åœ¨ç­–ç•¥æ”¹å˜è¿‡ç¨‹ä¸­ä¹Ÿä¼šæ”¹å˜ï¼Œå› æ­¤é€ æˆç¥ç»ç½‘ç»œæ‹Ÿåˆè¿‡ç¨‹çš„ä¸ç¨³å®šæ€§ï¼Œå› æ­¤æ„å»ºæ–°çš„ç›®æ ‡ç½‘ç»œï¼Œåœ¨æ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­æš‚æ—¶å›ºå®šï¼Œåœ¨å›åˆç»“åˆåæ›´æ–°å‚æ•°ï¼Œè¿™æ ·éœ€è¦ä¸¤å±‚Qç½‘ç»œ</li></ol><p><a href="https://paperswithcode.com/paper/playing-atari-with-deep-reinforcement">ç›¸å…³ä»£ç å®ç°</a></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-080345.png" alt="A more general view of DQN" /></p><h2 id="0x03-dqnæ”¹è¿›"><a class="markdownIt-Anchor" href="#0x03-dqnæ”¹è¿›"></a> 0x03 DQNæ”¹è¿›</h2><p>è™½ç„¶DQNæˆåŠŸè®©å¼ºåŒ–å­¦ä¹ åœ¨æŸäº›æ–¹é¢è¶…è¿‡äººç±»ï¼Œä½†æ˜¯ä¾æ—§æœ‰è¿™è®¸å¤šé™åˆ¶ã€‚</p><h3 id="31-æ”¹è¿›1double-q-learning"><a class="markdownIt-Anchor" href="#31-æ”¹è¿›1double-q-learning"></a> 3.1 æ”¹è¿›1â€“Double Q- Learning</h3><p>åœ¨DQNä¸­ä¼šæœ‰ä¼°è®¡å€¼è¿‡é«˜çš„æƒ…å†µï¼Œè¯æ˜å¦‚ä¸‹ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo>âˆ’</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>:</mo><msubsup><mi>y</mi><mi>t</mi><mi>i</mi></msubsup><mo>=</mo><msubsup><mi>r</mi><mi>t</mi><mi>i</mi></msubsup><mo>+</mo><mi>Î³</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow><msubsup><mi>a</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow></msub><msub><mi>Q</mi><mrow><mover accent="true"><mi>Î¸</mi><mo>^</mo></mover></mrow></msub><mo>(</mo><msubsup><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>)</mo></mrow><annotation encoding="application/x-tex">target-value:y^i_t=r^i_t+\gamma max_{a_{t+1}^i}Q_{\hat \theta}(S^i_{t+1},a^i_{t+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.874664em;"></span><span class="strut bottom" style="height:1.335509em;vertical-align:-0.46084499999999995em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">e</span><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">u</span><span class="mord mathit">e</span><span class="mrel">:</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.247em;margin-left:-0.02778em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.22631999999999994em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.27551428571428577em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.3257159999999999em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span><span style="top:-0.26343999999999995em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow><msubsup><mi>a</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow></msub><msub><mi>Q</mi><mrow><mover accent="true"><mi>Î¸</mi><mo>^</mo></mover></mrow></msub><mo>(</mo><msubsup><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>)</mo><mo>=</mo><msub><mi>Q</mi><mrow><mover accent="true"><mi>Î¸</mi><mo>^</mo></mover></mrow></msub><mo>(</mo><msubsup><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow><msubsup><mi>a</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow></msub><msub><mi>Q</mi><mrow><mover accent="true"><mi>Î¸</mi><mo>^</mo></mover></mrow></msub><mo>(</mo><msubsup><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">max_{a_{t+1}^i}Q_{\hat \theta}(S^i_{t+1},a^i_{t+1})=Q_{\hat \theta}(s_{t+1}^i,argmax_{a_{t+1}^i}Q_{\hat \theta}(s_{t+1}^i,a_{t+1}^i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.874664em;"></span><span class="strut bottom" style="height:1.335509em;vertical-align:-0.46084499999999995em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.22631999999999994em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.27551428571428577em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.3257159999999999em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span><span style="top:-0.26343999999999995em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.3257159999999999em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span><span style="top:-0.26343999999999995em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.22631999999999994em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.27551428571428577em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.3257159999999999em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span><span style="top:-0.26343999999999995em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p>æ ¹æ®æœŸæœ›å…¬å¼</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mo>[</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mi>X</mi><mn>1</mn><mo separator="true">,</mo><mi>X</mi><mn>2</mn><mo>)</mo><mo>]</mo><mo>&gt;</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mi>E</mi><mo>(</mo><mi>X</mi><mn>1</mn><mo>)</mo><mo separator="true">,</mo><mi>E</mi><mo>(</mo><mi>X</mi><mn>2</mn><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">E[max(X1,X2)]&gt;max(E(X1),E(X2))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord mathrm">2</span><span class="mclose">)</span><span class="mclose">]</span><span class="mrel">&gt;</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord mathrm">2</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-081747.png" alt="image-20221106161746893" /></p><p>æˆ‘ä»¬é€šè¿‡è¯æ˜å‘ç°ä¼°è®¡å€¼è¾ƒå¤§çš„åŸå› æ˜¯å› ä¸ºæˆ‘åœ¨æ¨¡å‹é€‰æ‹©è¡Œä¸ºå’Œè®¡ç®—Qå€¼ä½¿ç”¨åŒä¸€ä¸ªç½‘ç»œï¼Œå¦‚æœé™ä½è¡Œä¸ºé€‰æ‹©å’ŒQå€¼è®¡ç®—çš„ç›¸å…³æ€§å°±å¯ä»¥é™ä½é«˜ä¼°ï¼Œå› æ­¤ç›´è§‰çš„æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸¤ä¸ªç½‘ç»œ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mrow><msub><mi>Î¸</mi><mi>A</mi></msub></mrow></msub><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi>r</mi><mo>+</mo><mi>Î³</mi><msub><mi>Q</mi><mrow><msub><mi>Î¸</mi><mi>b</mi></msub></mrow></msub><mo>(</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo separator="true">,</mo><msup><mi>a</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_{\theta_A}(s,a)=r+\gamma Q_{\theta_b}(s&#x27;,a&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.801892em;"></span><span class="strut bottom" style="height:1.057752em;vertical-align:-0.25586em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mrow><msub><mi>Î¸</mi><mi>B</mi></msub></mrow></msub><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi>r</mi><mo>+</mo><mi>Î³</mi><msub><mi>Q</mi><mrow><msub><mi>Î¸</mi><mi>a</mi></msub></mrow></msub><mo>(</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo separator="true">,</mo><msup><mi>a</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_{\theta_B}(s,a)=r+\gamma Q_{\theta_a}(s&#x27;,a&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.801892em;"></span><span class="strut bottom" style="height:1.056892em;vertical-align:-0.255em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>æˆ‘ä»¬çš„ç¡®å¯ä»¥æ–°åŠ ä¸€ä¸ªç½‘ç»œï¼Œä½†æ˜¯ä¼šå¢åŠ å­¦ä¹ éš¾åº¦ï¼Œéœ€è¦é‡æ–°è®¾è®¡æ¶æ„ã€‚æ‰€ä»¥ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_{\theta}(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span>ä½œä¸ºè¡Œä¸ºçš„ä¼°è®¡ï¼Ÿ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo>âˆ’</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>âˆ’</mo><mi>d</mi><mi>o</mi><mi>u</mi><mi>b</mi><mi>l</mi><mi>e</mi><mo>âˆ’</mo><mi>Q</mi><mo>âˆ’</mo><mi>l</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo>)</mo><mo>:</mo><msubsup><mi>y</mi><mi>t</mi><mi>i</mi></msubsup><mo>=</mo><msubsup><mi>r</mi><mi>t</mi><mi>i</mi></msubsup><mo>+</mo><mi>Î³</mi><msub><mi>Q</mi><mrow><mover accent="true"><mi>Î¸</mi><mo>^</mo></mover></mrow></msub><mo>(</mo><msubsup><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow><msubsup><mi>r</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><msub><mi>Q</mi><mrow><mi>Î¸</mi></mrow></msub></mrow></msub><mo>(</mo><msubsup><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(target-value-double-Q-learning):y^i_t=r^i_t+\gamma Q_{\hat \theta}(s^i_{t+1},argmax_{r^i_{t+1}Q_{\theta}}(s^i_{t+1},a^i_{t+1}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.874664em;"></span><span class="strut bottom" style="height:1.335509em;vertical-align:-0.46084499999999995em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">e</span><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">u</span><span class="mord mathit">e</span><span class="mbin">âˆ’</span><span class="mord mathit">d</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">b</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mbin">âˆ’</span><span class="mord mathit">Q</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">n</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mrel">:</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.247em;margin-left:-0.02778em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.3257159999999999em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span><span style="top:-0.26343999999999995em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.22631999999999994em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.27551428571428577em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><h3 id="32-æ”¹è¿›2prioritized-replay"><a class="markdownIt-Anchor" href="#32-æ”¹è¿›2prioritized-replay"></a> 3.2 æ”¹è¿›2ï¼šPrioritized replay</h3><p>åœ¨DQNå­¦ä¹ ä¸­ä¸ºé«˜æ•ˆåˆ©ç”¨ï¼ˆsï¼Œaï¼Œrï¼Œsï¼‰æ ·æœ¬ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ç»éªŒå›æ”¾çš„æ–¹å¼æ¥å­˜å‚¨ä¸€å®šè§„æ¨¡çš„æ ·æœ¬ï¼Œåœ¨æ¢¯åº¦ä¸‹é™çš„æ—¶å€™é€šå¸¸æ˜¯ä»ç»éªŒå›æ”¾ä¸­å‡åŒ€é‡‡æ ·ï¼ˆuniformly samplingï¼‰æ¥è¿›è¡Œå­¦ä¹ ï¼Œä½†æ˜¯æˆ‘ä»¬ä¾æ—§ä¼šå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>ä¾æ—§æ²¡æœ‰å®Œå…¨è§£å†³æ•°æ®ä¹‹é—´ç‹¬ç«‹åŒåˆ†å¸ƒçš„å‡è®¾</li><li>å®¹æ˜“å¿˜è®°ä¸€äº›ç½•è§çš„ã€é‡è¦çš„ç»éªŒæ•°æ®</li></ol><p>åœ¨è¯¥è®ºæ–‡ä¸­ä½œè€…é¦–å…ˆåˆ¶å®šæŒ‡æ ‡â€œTD-errorâ€ä½œä¸ºè¡¡é‡<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>r</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>)</mo></mrow><annotation encoding="application/x-tex">(s_t^i,a_t^i,r_t^i,s^i_{t+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.131103em;vertical-align:-0.30643899999999996em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.247em;margin-left:-0.02778em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.36299999999999993em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span>çš„ä¿¡æ¯é‡å¤§å°ï¼Œä½œä¸ºé‡‡æ ·çš„ä¼˜å…ˆçº§ï¼ŒåŒæ—¶åˆ©ç”¨éšæœºä¼˜å…ˆçº§é‡‡æ ·ã€åç½®å’Œé‡è¦æ€§é‡‡æ ·ç­‰æ–¹å¼æ¥é¿å…è´ªå¿ƒçš„é—®é¢˜ã€‚ä¼˜å…ˆçº§çš„è·å–æœ‰3.2.1å’Œ3.2.2ä¸¤ç§æ–¹å¼</p>(éšæœºé‡‡æ ·)P(i)=\frac{p_i^\alpha}{\Sigma_kP_k^\alpha}<h3 id="321-æ¯”ä¾‹ä¼˜å…ˆçº§proportional-prioritization"><a class="markdownIt-Anchor" href="#321-æ¯”ä¾‹ä¼˜å…ˆçº§proportional-prioritization"></a> 3.2.1 æ¯”ä¾‹ä¼˜å…ˆçº§ï¼ˆProportional prioritizationï¼‰</h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>=</mo><mi mathvariant="normal">âˆ£</mi><msub><mi>Ïƒ</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi><mo>+</mo><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">P_i=|\sigma_i|+\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ïƒ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mbin">+</span><span class="mord mathit">Ïµ</span></span></span></span></span></p><h3 id="322-åŸºäºæ’åçš„ä¼˜å…ˆçº§rank-based-prioritization"><a class="markdownIt-Anchor" href="#322-åŸºäºæ’åçš„ä¼˜å…ˆçº§rank-based-prioritization"></a> 3.2.2 åŸºäºæ’åçš„ä¼˜å…ˆçº§(Rank-based prioritization)</h3>P_i=\frac{1}{rank(i)}$$ï¼›ä¼˜ç‚¹å¯ä»¥ä¿è¯çº¿æ€§æ€§è´¨ï¼Œå¯¹å¼‚å¸¸å€¼ä¸æ•æ„Ÿã€‚ä¸Šè¿°ä¸¤ç§æ˜¯ä¸åŒå¾—åˆ°é‡è¦æ€§çš„æ–¹å¼ï¼›åœ¨å®ç°æ—¶å€™é‡‡ç”¨sum-treeçš„æ•°æ®ç»“æ„é™ä½ç®—æ³•å¤æ‚ç¨‹åº¦ã€‚åœ¨é‡‡æ ·ä¸­è€ƒè™‘é‡è¦æ€§é‡‡æ ·ï¼ˆimportance samplingï¼‰ï¼Œå¹¶ç”±æ­¤æ¥è¿›è¡Œçƒ­åç½®ï¼ˆAnnealing the biasï¼‰æ¥ä¿®æ­£è¯¯å·®$$w_j=(\frac{1}{N}*\frac{1}{P(i)})^\beta<p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-083749.png" alt="Double DQN with proportional prioritization " /></p><h3 id="33-æ”¹è¿›3-dueling-networks"><a class="markdownIt-Anchor" href="#33-æ”¹è¿›3-dueling-networks"></a> 3.3 æ”¹è¿›3: Dueling networks</h3><p>Dueling DQNæ˜¯ä¸€ç§é’ˆå¯¹åŸºäºä»·å€¼å‡½æ•°çš„å¼ºåŒ–å­¦ä¹ çš„ç½‘ç»œç»“æ„è®¾è®¡ï¼Œå…¶å¹¶ä¸ç›´æ¥è¾“å‡º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span>ï¼Œè€Œæ˜¯è¾“å‡º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mo>(</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">V(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>ä¸<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">A(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span>,é€šå¸¸ä¼šå…±ç”¨å‰å‡ å±‚çš„å·ç§¯å‚æ•°ï¼Œåœ¨åé¢åˆ™æ˜¯çŠ¶æ€ä»·å€¼å‡½æ•°ä¸ä¼˜åŠ¿å‡½æ•°å„è‡ªçš„å‚æ•°ã€‚</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-085135.png" alt="image-20221106165135693" /></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-084642.png" alt="Dueling DQN" /></p><h3 id="34-æ”¹è¿›4multi-step-learning"><a class="markdownIt-Anchor" href="#34-æ”¹è¿›4multi-step-learning"></a> 3.4 æ”¹è¿›4:Multi-step learning</h3><p>åœ¨å¯¹çŠ¶æ€åŠ¨ä½œå‡½æ•°çš„ä¼˜åŠ¿ä¼°è®¡æ—¶å€™ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šåˆ†ä¸ºè’™ç‰¹å¡æ´›æ–¹æ³•ä¸Bootstrap(æˆ–è€…æ˜¯Actor- criticå†…çš„C)çš„æ–¹æ³•</p>(MC-sampling)A_t=\Sigma_{k=0}^{\infty}\gamma_t^{k}ï¼ˆR_{t+k+1}-b)<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>b</mi><mi>o</mi><mi>o</mi><mi>t</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>a</mi><mi>p</mi><mo>âˆ’</mo><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo>)</mo><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mrow><mi>t</mi></mrow></msub><mo>+</mo><mi>Î³</mi><mo>âˆ—</mo><mi>V</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo><mo>âˆ’</mo><mi>V</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(bootstrap-sampling)G_t=r_{t}+\gamma*V(s_{t+1})-V(s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">b</span><span class="mord mathit">o</span><span class="mord mathit">o</span><span class="mord mathit">t</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">p</span><span class="mbin">âˆ’</span><span class="mord mathit">s</span><span class="mord mathit">a</span><span class="mord mathit">m</span><span class="mord mathit">p</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mbin">âˆ—</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>å‰è€…æ–¹æ³•åå·®ä½ä½†æ˜¯æ–¹å·®è¾ƒå¤§ï¼›åè€…æ–¹å·®ä½ä½†æ˜¯æœ‰åã€‚å› æ­¤ç»“åˆä¸¤è€…æˆ‘ä»¬é€šå¸¸ä¼šæœ‰Multi-step targetçš„æ–¹æ³•ã€‚</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-090001.png" alt="N-stepæ›´è¿›ä¸€æ­¥ï¼Œå¹¿ä¹‰ä¼˜åŠ¿ä¼°è®¡" /></p><p>åŒæ ·çš„ä¹Ÿå¯ä»¥ç”¨åœ¨DQNä¸­å¯¹äºçŠ¶æ€åŠ¨ä½œä»·å€¼å‡½æ•°çš„ä¼°è®¡ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>R</mi><mi>t</mi><mrow><mi>n</mi></mrow></msubsup><mo>=</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msubsup><msubsup><mi>Î³</mi><mi>t</mi><mrow><mi>k</mi></mrow></msubsup><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">R_t^{n}=\Sigma_{k=0}^{n-1}\gamma_t^{k}R_{t+k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8991079999999998em;"></span><span class="strut bottom" style="height:1.1905469999999996em;vertical-align:-0.2914389999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.247em;margin-left:-0.00773em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.2914389999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="vlist"><span style="top:0.247em;margin-left:-0.05556em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><p>æ›´æ–°ä¹‹åçš„æŸå¤±å‡½æ•°ä¸º</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msubsup><mi>R</mi><mi>t</mi><mrow><mi>n</mi></mrow></msubsup><mo>+</mo><msubsup><mi>Î³</mi><mi>t</mi><mi>n</mi></msubsup><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow><msup><mi>a</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><msub><mi>Q</mi><mrow><mover accent="true"><mi>Î¸</mi><mo>^</mo></mover></mrow></msub><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mi>n</mi></mrow></msub><mo separator="true">,</mo><msup><mi>a</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo><mo>âˆ’</mo><msub><mi>Q</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo><msup><mo>)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">(R_t^{n}+\gamma_t^nmax_{a&#x27;}Q_{\hat \theta}(S_{t+n},a&#x27;)-Q_\theta(S_t,A_t))^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8641079999999999em;"></span><span class="strut bottom" style="height:1.1898239999999998em;vertical-align:-0.3257159999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.247em;margin-left:-0.00773em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="vlist"><span style="top:0.247em;margin-left:-0.05556em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.3257159999999999em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span><span style="top:-0.26343999999999995em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><h3 id="35-æ”¹è¿›5distributional-rl"><a class="markdownIt-Anchor" href="#35-æ”¹è¿›5distributional-rl"></a> 3.5 æ”¹è¿›5:Distributional RL</h3><p>åœ¨åŸºäºä»·å€¼å‡½æ•°çš„å­¦ä¹ ä¸­æˆ‘ä»¬é€šå¸¸æ˜¯è¿”å›ä¸€ä¸ªæœŸæœ›æˆ–è€…æœ€å¤§å€¼è€Œä¸¢å¤±å¾ˆå¤šå…¶ä»–ä¿¡æ¯ï¼Œå› æ­¤Distributional RLå°è¯•åˆ©ç”¨å…¶åˆ†å¸ƒè€Œä¸æ˜¯å•ä¸ªå€¼æ¥è¿›è¡Œå¼ºåŒ–å­¦ä¹ ã€‚é¦–å…ˆæœ¬æ–‡å°è¯•å°†ä»·å€¼å‡½æ•°èŒƒå›´<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><msub><mi>V</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>V</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>]</mo></mrow><annotation encoding="application/x-tex">[V_{min},V_{max}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">]</span></span></span></span>åˆ’åˆ†ä¸ºNä¸ªå„è‡ªæ¥ä¼°è®¡ä»·å€¼å‡½æ•°ï¼Œåˆ©ç”¨Boltzmannåˆ†å¸ƒè¡¨ç¤ºä»·å€¼å‡½æ•°çš„åˆ†å¸ƒï¼ŒåŒæ—¶åˆ©ç”¨æŠ•å½±çš„æ“ä½œ</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-091649.png" alt="ä¼°è®¡Z(s)" /></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-091719.png" alt="ä¸åŒoption" /></p><p>ç”±æ­¤å¯¹äºåˆ†å¸ƒæ‹Ÿåˆå¯ä»¥åˆ’åˆ†ä¸ºäº¤å‰ç†µçš„å½¢å¼ï¼Œç®—æ³•æµç¨‹</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-091812.png" alt="Distribution RL" /></p><h3 id="36-æ”¹è¿›6noisy-nets"><a class="markdownIt-Anchor" href="#36-æ”¹è¿›6noisy-nets"></a> 3.6 æ”¹è¿›6ï¼šNoisy Nets</h3><p>åœ¨Q- learningæˆ–è€…æ˜¯DQNä¸­ï¼Œæˆ‘ä»¬çš„è½¨è¿¹å¹¶ä¸æ˜¯å®Œå…¨é‡‡æ ·çš„ï¼Œè€Œæ˜¯ä¸æˆ‘ä»¬çš„æ¢ç´¢ç­–ç•¥ç›¸å…³ï¼Œæœ€åŸæœ¬çš„æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ïµ</mi><mo>âˆ’</mo><mi>G</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>d</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">\epsilon-Greedy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Ïµ</span><span class="mbin">âˆ’</span><span class="mord mathit">G</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span>ç­–ç•¥ï¼Œè¿™é‡Œæå‡ºä¸€ç§NoisyNetæ¥å¯¹å‚æ•°å¢åŠ å™ªå£°æ¥å¢åŠ æ¨¡å‹çš„æ¢ç´¢èƒ½åŠ›</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mo>(</mo><mi>W</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo>)</mo><mo>+</mo><mo>(</mo><msub><mi>b</mi><mrow><mi>n</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>âŠ™</mo><msup><mi>Ïµ</mi><mi>b</mi></msup><mo>+</mo><msub><mi>W</mi><mrow><mi>n</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>âŠ™</mo><msup><mi>Ïµ</mi><mi>w</mi></msup><mo>)</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y=(Wx+b)+(b_{noisy}\odot\epsilon^b+W_{noisy}\odot\epsilon^w)x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8991079999999999em;"></span><span class="strut bottom" style="height:1.1852159999999998em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mord mathit">o</span><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âŠ™</span><span class="mord"><span class="mord mathit">Ïµ</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mord mathit">o</span><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âŠ™</span><span class="mord"><span class="mord mathit">Ïµ</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathit">x</span></span></span></span></span></p><p>å™ªå£°çš„ç”Ÿæˆå¯ä»¥åˆ†ä¸ºIndependent Gaussian noiseï¼›Factorised Gaussian noiseä¸¤ç§æ–¹å¼ã€‚</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-093441.png" alt="Nosy netçš„æ•ˆæœ" /></p><h3 id="37-èåˆä¸Šè¿°ç­–ç•¥"><a class="markdownIt-Anchor" href="#37-èåˆä¸Šè¿°ç­–ç•¥"></a> 3.7 èåˆä¸Šè¿°ç­–ç•¥</h3><p>é¦–å…ˆå°†ï¼ˆæ”¹è¿›5:Distributional RLï¼‰ä¸­çš„æŸå¤±å‡½æ•°æ›´æ¢ç§°ä¸ºï¼ˆæ”¹è¿›4:Multi-step learningï¼‰ï¼Œå¹¶åˆ©ç”¨ï¼ˆæ”¹è¿›1â€“Double Q- Learningï¼‰è®¡ç®—æ–°çš„ç›®æ ‡å€¼</p>d_t^n=(R_t^n+r_t^nz,p_\hat\theta(S_{t+n},a^*_{t+n}))<p>æŸå¤±å‡½æ•°ä¸º</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub><mo>(</mo><msub><mi mathvariant="normal">Î¦</mi><mi>z</mi></msub><msubsup><mi>d</mi><mi>t</mi><mi>n</mi></msubsup><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><msub><mi>d</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">D_{KL}(\Phi_zd_t^n||d_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mord mathit">L</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>åŒæ—¶åœ¨é‡‡æ ·è¿‡ç¨‹ä¸­æˆ‘ä»¬é€šå¸¸ä¼šå‡å°‘TD-errorï¼Œè€Œåœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬çš„æŸå¤±å‡½æ•°ä¸ºKLæŸå¤±ï¼Œå› æ­¤æˆ‘ä»¬çš„ï¼ˆæ”¹è¿›2ï¼šPrioritized replayï¼‰ä¸­çš„ä¼˜å…ˆçº§å®šä¹‰ä¸º</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub><mo>âˆ</mo><mo>(</mo><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub><mo>(</mo><msub><mi mathvariant="normal">Î¦</mi><mi>z</mi></msub><msubsup><mi>d</mi><mi>t</mi><mi>n</mi></msubsup><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><msub><mi>d</mi><mi>t</mi></msub><mo>)</mo><msup><mo>)</mo><mi>w</mi></msup></mrow><annotation encoding="application/x-tex">p_t\propto (D_{KL}(\Phi_zd_t^n||d_t))^w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆ</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mord mathit">L</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><p>åŒæ—¶æ”¹å˜ï¼ˆæ”¹è¿›3: Dueling networksï¼‰ç”±æ¥å—æœŸæœ›è½¬å‘æ¥å—ä»·å€¼å‡½æ•°åˆ†å¸ƒï¼Œæœ€åæ›´æ”¹æ‰€æœ‰çš„çº¿æ€§å±‚æ›´æ¢ä¸ºï¼ˆæ”¹è¿›6ï¼šNoisy Netsï¼‰</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><msup><mo>)</mo><mi>i</mi></msup><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><msubsup><mi>v</mi><mi>Î·</mi><mi>i</mi></msubsup><mo>(</mo><mi>Ï•</mi><mo>)</mo><mo>+</mo><msubsup><mi>a</mi><mi>Ïˆ</mi><mi>i</mi></msubsup><mo>(</mo><mi>Ï•</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>âˆ’</mo><msubsup><mover accent="true"><mi>a</mi><mo>^</mo></mover><mi>Ïˆ</mi><mi>i</mi></msubsup><mo>(</mo><mi>s</mi><mo>)</mo><mo>)</mo></mrow><mrow><msub><mi mathvariant="normal">Î£</mi><mi>j</mi></msub><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><msubsup><mi>v</mi><mi>Î·</mi><mi>j</mi></msubsup><mo>(</mo><mi>Ï•</mi><mo>)</mo><mo>+</mo><msubsup><mi>a</mi><mi>Ïˆ</mi><mi>j</mi></msubsup><mo>(</mo><mi>Ï•</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>âˆ’</mo><msubsup><mover accent="true"><mi>a</mi><mo>^</mo></mover><mi>Ïˆ</mi><mi>j</mi></msubsup><mo>(</mo><mi>s</mi><mo>)</mo><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">p_\theta(s,a)^i=\frac{exp(v^i_\eta(\phi)+a^i_\psi(\phi,a)-\hat a_\psi^i(s))}{\Sigma_j exp(v^j_\eta(\phi)+a^j_\psi(\phi,a)-\hat a_\psi^j(s)) }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.63388em;"></span><span class="strut bottom" style="height:2.903868em;vertical-align:-1.269988em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.832572em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:0.116592em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">Î·</span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">Ï•</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.3013079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">Ïˆ</span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">Ï•</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit">a</span></span><span style="top:0em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.3013079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">Ïˆ</span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.8092159999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">Î·</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">Ï•</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.2831079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">Ïˆ</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">Ï•</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit">a</span></span><span style="top:0em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.2831079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">Ïˆ</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p><h2 id="0x04-å®éªŒ"><a class="markdownIt-Anchor" href="#0x04-å®éªŒ"></a> 0x04 å®éªŒ</h2><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-095019.png" alt="Median human- normalized performance" /></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-094444.png" alt="ç»“æœ" /></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-06-095358.png" alt="image-20221106175357633" /></p><h2 id="0x05-æ€»ç»“"><a class="markdownIt-Anchor" href="#0x05-æ€»ç»“"></a> 0x05 æ€»ç»“</h2><h3 id="51-ç»“è®º"><a class="markdownIt-Anchor" href="#51-ç»“è®º"></a> 5.1 ç»“è®º</h3><ol><li>rainbowæƒ³æ¯”è¾ƒå…¶ä»–ç°æœ‰çš„ç®—æ³•è¦æ›´å¥½ï¼Œé€Ÿåº¦ä¹Ÿä¼šæ›´å¿«</li><li>åœ¨æ¶ˆèå®ç°ä¸­ï¼›æˆ‘ä»¬ä¼šå‘ç°ï¼ˆæ”¹è¿›2ï¼šPrioritized replayï¼‰ä¸ï¼ˆæ”¹è¿›4:Multi-step learningï¼‰ä¼šé€ æˆç»“æœä¸­ä½æ•°å¤§å¹…åº¦ä¸‹é™;(æ”¹è¿›5:Distributional RL)åœ¨æœ€å¼€å§‹è¡¨ç°è‰¯å¥½ï¼Œä½†æ˜¯æœ€ç»ˆç»“æœè¡¨ç°è¾ƒå·®ï¼›åŒæ—¶ï¼ˆæ”¹è¿›6ï¼šNoisy Netsï¼‰é€šå¸¸ä¼šæœ‰æ›´å¥½çš„ä¸­ä½æ•°è¡¨ç°ï¼ŒåŒæ—¶ç”±äºæœ¬æ¬¡çŠ¶æ€ä¸­é€šå¸¸æ˜¯underestimateçš„ï¼Œæ‰€ä»¥ï¼ˆæ”¹è¿›1â€“Double Q- Learningï¼‰æ•ˆæœå¹¶ä¸æ˜¾è‘—ï¼Œï¼ˆæ”¹è¿›3: Dueling networksï¼‰æå‡å¹…åº¦ä¸å¤§ã€‚</li></ol><h3 id="52-è®¨è®º"><a class="markdownIt-Anchor" href="#52-è®¨è®º"></a> 5.2 è®¨è®º</h3><p>ä½œè€…åœ¨æœ€åæ€»ç»“ä»–ä»¬çš„å·¥ä½œï¼Œä¸»è¦æ˜¯ä»value- basedçš„Q-learningæ–¹æ³•é›†åˆä¸­å¯»æ‰¾ï¼Œè€Œæ²¡æœ‰è€ƒè™‘purely policy- basedçš„ç®—æ³•ï¼ˆæ¯”å¦‚TRPO),æœ¬æ–‡ä»ç½‘ç»œæ¢ç´¢ã€ç½‘ç»œåˆå§‹åŒ–ã€æ•°æ®ä½¿ç”¨ã€æŸå¤±æˆ–å‡½æ•°ç­‰æ–¹é¢è¿›è¡Œé›†åˆï¼Œä¸ä¹‹ç›¸å¯¹åº”çš„åŒæ ·æœ‰å¾ˆå¤šå·¥ä½œï¼Œæœªæ¥è¿˜å¯ä»¥ç”¨å¾ˆå¤šå…¶ä»–çš„æ–¹æ³•ã€‚ä½†æ˜¯æˆ‘ä»¬ç›¸ä¿¡</p><blockquote><p>In general, we believe that exposing the real game to the agent is a promising direction for future research.</p></blockquote><h3 id="53-ä¸ªäººæ„Ÿæ‚Ÿ"><a class="markdownIt-Anchor" href="#53-ä¸ªäººæ„Ÿæ‚Ÿ"></a> 5.3 ä¸ªäººæ„Ÿæ‚Ÿ</h3><p>è¿™ç¯‡è®ºæ–‡çœ‹ä¸Šå»å¾ˆæ°´ï¼Œä½†å…¶å®ä½œè€…åšäº†å¾ˆå¤šdirty workå¹¶æœ€ç»ˆæœ‰æ•ˆï¼Œå·¥ä½œé‡éå¸¸å¤§ï¼</p><p>ã€1ã€‘<span name = "DQN"><a href="https://arxiv.org/abs/1312.5602">Mnih, V., Kavukcuoglu, K., Silver, D., Graves, A., Antonoglou, I., Wierstra, D., &amp; Riedmiller, M. (2013). Playing atari with deep reinforcement learning. <em>arXiv preprint arXiv:1312.5602</em>.</a></span></p><p>ã€2ã€‘<span name = "DDQN"><a href="http://arxiv.org/abs/1509.06461">Van Hasselt, H., Guez, A., &amp; Silver, D. (2016, March). Deep reinforcement learning with double q-learning. In <em>Proceedings of the AAAI conference on artificial intelligence</em> (Vol. 30, No. 1).</a></span></p><p>ã€3ã€‘ <span name = "Prioritized experience replay"> <a href="https://arxiv.org/abs/1511.05952">Schaul, T., Quan, J., Antonoglou, I., &amp; Silver, D. (2015). Prioritized experience replay. <em>arXiv preprint arXiv:1511.05952</em>.</a></span></p><p>ã€4ã€‘<span name = "Multistep"><a href="https://www.cs.mcgill.ca/~dprecup/courses/RL/Lectures/8-multistep-2019.pdf">Multi StepÂ Learning</a></span></p><p>ã€5ã€‘<span name = "Dueling"><a href="https://arxiv.org/abs/1511.06581">Wang, Z., Schaul, T., Hessel, M., Hasselt, H., Lanctot, M., &amp; Freitas, N. (2016, June). Dueling network architectures for deep reinforcement learning. In <em>International conference on machine learning</em> (pp. 1995-2003). PMLR.</a></span></p><p>ã€6ã€‘<span name = "Distributional"><a href="https://arxiv.org/pdf/1707.06887.pdf">Bellemare, M. G., Dabney, W., &amp; Munos, R. (2017, July). A distributional perspective on reinforcement learning. In <em>International Conference on Machine Learning</em> (pp. 449-458). PMLR.</a></span></p><p>ã€7ã€‘<span name = "NoisyDQN"><a href="https://arxiv.org/abs/1706.10295">Fortunato, M., Azar, M. G., Piot, B., Menick, J., Osband, I., Graves, A., â€¦ &amp; Legg, S. (2017). Noisy networks for exploration. <em>arXiv preprint arXiv:1706.10295</em>.</a></span></p><h2 id="è‡ªæˆ‘ä»‹ç»"><a class="markdownIt-Anchor" href="#è‡ªæˆ‘ä»‹ç»"></a> è‡ªæˆ‘ä»‹ç»</h2><p>50ï½100å­—</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä½œè€…ï¼šHessel, M., Modayil, J., Van Hasselt, H., Schaul, T., Ostrovski, G., Dabney, W., â€¦ &amp;amp; Silver, D.&lt;/p&gt;
&lt;p&gt;å®éªŒå®¤ï¼šGoogle DeepMind&lt;/p&gt;
&lt;p&gt;è®ºæ–‡åœ°å€ï¼š&lt;a href=&quot;https://arxiv.org/pdf/1710.02298&quot;&gt;https://arxiv.org/pdf/1710.02298&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‘è¡¨ï¼š In &lt;em&gt;Thirty-second AAAI conference on artificial intelligence&lt;/em&gt;.&lt;/p&gt;</summary>
    
    
    
    <category term="RL" scheme="https://blog.tjdata.site/categories/RL/"/>
    
    
    <category term="paper" scheme="https://blog.tjdata.site/tags/paper/"/>
    
  </entry>
  
  <entry>
    <title>CS285_Lecture08_Deep_RL_with_QFunctions</title>
    <link href="https://blog.tjdata.site/posts/81031871.html"/>
    <id>https://blog.tjdata.site/posts/81031871.html</id>
    <published>2022-11-02T14:31:42.000Z</published>
    <updated>2023-05-13T13:48:32.952Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Policy gradientï¼Œåˆ°Actor- criticï¼Œæˆ‘ä»¬å°è¯•ä¸¢å¼ƒpolicyï¼Œä»ACåˆ°Q- iterationæˆ–è€…Q- learningæˆ‘ä»¬å½»åº•ä¸¢å¼ƒPolicyï¼Œä½†æ˜¯é‡åˆ°ä¸èƒ½æ”¶æ•›çš„é—®é¢˜ã€‚ç°åœ¨æˆ‘ä»¬å°è¯•æ”¹è¿›Q- learningæ¥å®ç°æƒ³è¦çš„åŠŸèƒ½</p><span id="more"></span><h2 id="0x01-q-learningä¸­çš„é—®é¢˜"><a class="markdownIt-Anchor" href="#0x01-q-learningä¸­çš„é—®é¢˜"></a> 0x01 Q- learningä¸­çš„é—®é¢˜</h2><p>ä¸Šæ¬¡ä»ç†è®ºçš„è§’åº¦çœ‹å‡ºonline Q iterationå¾ˆéš¾æ”¶æ•›ï¼Œæ›´ç›´è§‚çš„çœ‹å¾…é—®é¢˜æˆ‘ä»¬ä¼šå‘ç°æœ‰ä»¥ä¸‹å‡ ç‚¹çš„åŸå› ï¼š</p><ol><li>Q- learningä¸­é€šå¸¸ä½¿ç”¨çš„æ˜¯å•ä¸ªæ ·æœ¬ï¼Œè¿™æ ·å¯¹äºæ›´æ–°è¿­ä»£å¹¶ä¸å‹å¥½</li><li>åœ¨ç¬¬ä¸‰æ­¥ä¸­çš„æœ‰ä¸€ä¸ªç±»ä¼¼gradient descentçš„å…¬å¼ä½†æ˜¯å…¶å®åœ¨åŒä¸€ä¸ªè½¨è¿¹ä¸­ä¸¤è€…ä¹‹é—´å…·æœ‰å¼ºçƒˆç›¸å…³æ€§</li><li>ä¸æ»¡è¶³iidå‡è®¾æ ·æœ¬ä¸­çš„æ•ˆæœå¹¶ä¸å¥½</li></ol><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-143452.png" alt="image-20221102223452106" /></p><p>è§£å†³æ€è·¯</p><ol><li>ä¿®æ­£æ ·æœ¬ï¼ŒåŒæ ·å€Ÿé‰´ACä¸­çš„æ–¹æ³•å¯ä»¥ä½¿ç”¨synchronized parallel Q- learningæˆ–è€…asynchronous parallel Q- learningæ¥å®ç°ã€‚</li><li>ä½¿ç”¨replay buffersï¼Œå› ä¸ºQ- learningåªéœ€è¦ï¼ˆstateï¼Œactionï¼Œnext- stateï¼Œrewardï¼‰å°±è¡Œ</li></ol><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-143917.png" alt="image-20221102223917061" /></p><h3 id="0x02-q-learning-with-replay-bufferçš„é—®é¢˜"><a class="markdownIt-Anchor" href="#0x02-q-learning-with-replay-bufferçš„é—®é¢˜"></a> 0x02 Q-learning with replay- bufferçš„é—®é¢˜</h3><p>æŒ‰ç…§å‚é‡Œåé¢çš„ä¸€éƒ¨ä»½åº”è¯¥æ˜¯æ²¡æœ‰æ¢¯åº¦çš„ï¼Œä½†æ˜¯å› ä¸ºä¸¤è€…å…·æœ‰ç›¸å…³æ€§æˆ‘ä»¬çš„æ•ˆæœä¼šå¾ˆå·®ï¼Œèµ·ä¸åˆ°æ¢¯åº¦ä¸‹é™çš„æ•ˆæœã€‚</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-144124.png" alt="image-20221102224124136" /></p><p>å› æ­¤æˆ‘ä»¬ä¼šè®¾ç½®ä¸€ä¸ªtarget networkï¼Œåœ¨æ¯æ¬¡æ›´æ–°çš„æ—¶å€™ï¼Œtargetä¹Ÿä¸ä¼šæ”¹å˜ï¼ŒåŒæ—¶è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸¤è€…æ˜¯æŸç§æ„ä¹‰ä¸Šçš„ä¸æƒ³å…³çš„ã€‚èƒŒåçš„æ–¹å¼æ˜¯å¯å‘å¼çš„ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯ä¸€ç§ç»éªŒå¾ˆå¥½çš„å®è·µæ–¹æ³•ã€‚é€šå¸¸æ›´æ–°çš„æ—¶å€™å¯ä»¥ç”¨æŒ‡æ•°å¹³å‡çš„æ–¹æ³•</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï„</mi><mo>=</mo><mi>p</mi><msub><mi>Ï„</mi><mn>0</mn></msub><mo>+</mo><mo>(</mo><mn>1</mn><mo>âˆ’</mo><mi>p</mi><mo>)</mo><mo>âˆ—</mo><mi>Ï„</mi></mrow><annotation encoding="application/x-tex">\tau=p\tau_0+(1-p)*\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mrel">=</span><span class="mord mathit">p</span><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">âˆ’</span><span class="mord mathit">p</span><span class="mclose">)</span><span class="mbin">âˆ—</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span></span></span></span></span></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-145023.png" alt="image-20221102225023533" /></p><p>æ›´é«˜çš„è§†è§’</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-145216.png" alt="image-20221102225216215" /></p><h3 id="0x03-æé«˜q-learning"><a class="markdownIt-Anchor" href="#0x03-æé«˜q-learning"></a> 0x03 æé«˜Q-learning</h3><p>åé¢ç»“åˆä¸€ç¯‡è®ºæ–‡æ¥ä»‹ç»ï¼Œä¹Ÿå°±æ˜¯Rainbowï½</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-145350.png" alt="image-20221102225350693" /></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä»Policy gradientï¼Œåˆ°Actor- criticï¼Œæˆ‘ä»¬å°è¯•ä¸¢å¼ƒpolicyï¼Œä»ACåˆ°Q- iterationæˆ–è€…Q- learningæˆ‘ä»¬å½»åº•ä¸¢å¼ƒPolicyï¼Œä½†æ˜¯é‡åˆ°ä¸èƒ½æ”¶æ•›çš„é—®é¢˜ã€‚ç°åœ¨æˆ‘ä»¬å°è¯•æ”¹è¿›Q- learningæ¥å®ç°æƒ³è¦çš„åŠŸèƒ½&lt;/p&gt;</summary>
    
    
    
    <category term="RL" scheme="https://blog.tjdata.site/categories/RL/"/>
    
    
    <category term="CS285" scheme="https://blog.tjdata.site/tags/CS285/"/>
    
  </entry>
  
  <entry>
    <title>CS285_Lecture07_Value_Function_Methods</title>
    <link href="https://blog.tjdata.site/posts/1e3ff77f.html"/>
    <id>https://blog.tjdata.site/posts/1e3ff77f.html</id>
    <published>2022-11-02T13:40:33.000Z</published>
    <updated>2023-05-13T13:48:26.166Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ç»è¿‡Lecture04ä»‹ç»RLçš„åŸºæœ¬æ¦‚å¿µä¹‹åï¼ŒLecture05ä»‹ç»åŸºäºpolicyçš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç›´æ¥åˆ©ç”¨returnçš„æ¢¯åº¦è¿›è¡Œç­–ç•¥å­¦ä¹ ï¼Œä¹‹åæˆ‘ä»¬å°è¯•åˆ©ç”¨Qæˆ–è€…Væ¥æ”¹è¿›policy evaluationæ­¥éª¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥ç›´æ¥æŠ›å¼ƒå‚æ•°åŒ–çš„æ¢¯åº¦ï¼ˆparameterized policiesï¼‰ï¼Œè½¬å‘ä»…ä»…åˆ©ç”¨Qæˆ–è€…Vè¿›è¡ŒRL</p><span id="more"></span><h2 id="0x01-æŠ›å¼ƒactor-criticä¸­çš„actor"><a class="markdownIt-Anchor" href="#0x01-æŠ›å¼ƒactor-criticä¸­çš„actor"></a> 0x01 æŠ›å¼ƒActor- criticä¸­çš„Actor</h2><h3 id="11-å›é¡¾actor-critic"><a class="markdownIt-Anchor" href="#11-å›é¡¾actor-critic"></a> 1.1 å›é¡¾Actor- critic</h3><p>ç¬¬ä¸€æ­¥ï¼šæˆ‘ä»¬åˆ©ç”¨ç°æœ‰çš„policyå¾—åˆ°å¤šä¸ªé‡‡æ ·è½¨è¿¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Ï„</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\tau_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><br />ç¬¬äºŒæ­¥ï¼šåˆ©ç”¨æ•°æ®æ‹Ÿåˆ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mover accent="true"><mi>V</mi><mo>^</mo></mover><mi>Ï•</mi><mi>Ï€</mi></msubsup><mo>(</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\hat V_\phi^\pi(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9467699999999999em;"></span><span class="strut bottom" style="height:1.365986em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span><span style="top:-0.25233em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.22222em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">Ï•</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>ï¼ˆå¸¸è§ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•ã€bootstrappedã€n-stepç­‰æ–¹æ³•ï¼‰<br />ç¬¬ä¸‰æ­¥ï¼šè¯„ä¼°ä¼˜åŠ¿ç­–ç•¥A<br />ç¬¬å››æ­¥ï¼šæ ¹æ®ä¼˜åŠ¿ç­–ç•¥å¾—åˆ°Actorçš„æ¢¯åº¦<br />ç¬¬äº”æ­¥ï¼šæ›´æ–°Actorçš„æ¢¯åº¦</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-134617.png" alt="image-20221102214616955" /></p><p>ä½†æ˜¯è¿™æ ·å­˜åœ¨çš„æ½œåœ¨é—®é¢˜æ˜¯æ–¹å·®å¤ªå¤§ï¼Œå› ä¸ºæˆ‘ä»¬æ‹Ÿåˆå‡ºæ¥çš„state- value- functionæ–¹å·®å¤ªå¤§ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šåšç»éªŒé‡æ”¾ç­‰æ–¹æ³•ï¼Œä½†æ˜¯å¹¶ä¸èƒ½å®Œå…¨è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>æ‰€ä»¥ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ç›´æ¥ä¸¢åˆ°æœ‰å‚çš„policyï¼Œè½¬å‘ç”Ÿæˆä¸€ä¸ª<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi><mo>âˆ—</mo></mrow><annotation encoding="application/x-tex">\pi*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.46528em;"></span><span class="strut bottom" style="height:0.46528em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mbin">âˆ—</span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi><mo>âˆ—</mo><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow><msub><mi>a</mi><mi>t</mi></msub></mrow></msub><msup><mi>A</mi><mi>Ï€</mi></msup><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\pi*=argmax_{a_t}A^\pi(s_t,a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.005em;vertical-align:-0.255em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mbin">âˆ—</span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><h3 id="12-policy-evaluation"><a class="markdownIt-Anchor" href="#12-policy-evaluation"></a> 1.2 Policy Evaluation</h3><p>åœ¨æ¢è®¨ä¸Šè¿°å¯èƒ½æ€§æˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹policy evaluationçš„æ¦‚å¿µï¼›ä¹Ÿå°±æ˜¯ä»Dynamic programmingçš„æ¥çœ‹æˆ‘ä»¬ä¼šå¦‚ä½•æ±‚è§£é—®é¢˜ï¼›åŒæ—¶ä»policy evaluationæˆ‘ä»¬ä¼šé€æ¸èµ°å‘value evaluationã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šé¦–å…ˆçŠ¶æ€è½¬ç§»æ¦‚ç‡Tæ˜¯å‡åŒ€çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨Policy evaluation()ä¸­å¾—åˆ°æ¯ä¸ªçŠ¶æ€ä¸‹çš„Q-state-action-listï¼›æ±‚å¹³å‡æ¥å¾—åˆ°V-state-listã€‚å½“ç„¶ä¸€æ¬¡è®¡ç®—ä¸å¤Ÿï¼Œæˆ‘ä»¬ä¼šè®¾ç½®ä¸€ä¸ªepsilonï¼Œå½“V- stateå˜åŒ–çš„æœ€å¤§å€¼éƒ½å°äºè¿™ä¸ªepsilonçš„æ—¶å€™åœæ­¢æ›´æ–°ã€‚è¯´æ˜æˆ‘ä»¬å¾—åˆ°æ‰€æœ‰çŠ¶æ€ä¸‹çš„V- state<br />ç¬¬äºŒæ­¥ï¼šåœ¨å¾—åˆ°V- stateä¸‹æˆ‘ä»¬ä¾¿èƒ½åˆ¤æ–­ä»€ä¹ˆactionæ˜¯å¥½çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åˆ©ç”¨Q- state- actionä¸V- stateä¹‹é—´çš„å…³ç³»æ¥é€‰æ‹©ä¸åŒstateä¸‹çš„æœ€ä¼˜actionï¼Œé‡æ–°åˆ†é…æ¦‚ç‡ï¼Œä¹Ÿå°±æ˜¯policy evaluation<br />ç¬¬ä¸‰æ­¥ï¼šç”±äºpolicy evaluationä¼šé‡æ–°æ”¹å˜ç©ºé—´ã€‚V- stateä¹Ÿä¼šæ”¹å˜ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°è®¡ç®—Policy evaluationï¼Œç›´åˆ°æ”¶æ•›ã€‚</p><p>Policy evaluationä¸Value evaluationä¹‹é—´çš„åŒºåˆ«åœ¨äºPolicy evaluationä¸­æ ¹æ®Q- state- value-listå¾—åˆ°V- state-listæ˜¯æ±‚æœŸæœ›ï¼Œè¿˜æ˜¯æ±‚æœ€å¤§å€¼çš„æ–¹å¼ã€‚</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>p</mi><mi>o</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>y</mi><mo>âˆ’</mo><mi>i</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>)</mo><msup><mi>V</mi><mi>Ï€</mi></msup><mo>(</mo><mi>s</mi><mo>)</mo><mo>=</mo><msub><mi>E</mi><mrow><mi>a</mi><mo>âˆ’</mo><mi>Ï€</mi><mo>(</mo><mi>a</mi><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo>)</mo></mrow></msub><mo>[</mo><mi>r</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>Ï€</mi><mo>(</mo><mi>s</mi><mo>)</mo><mo>)</mo><mo>+</mo><mi>Î³</mi><msub><mi>E</mi><mrow><msup><mi>s</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>âˆ’</mo><mi>p</mi><mo>(</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo separator="true">,</mo><mi>Ï€</mi><mo>(</mo><mi>s</mi><mo>)</mo><mo>)</mo></mrow></msub><mo>[</mo><msup><mi>V</mi><mi>Ï€</mi></msup><mo>(</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo><mo>]</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">(policy-iteration)V^\pi(s)=E_{a-\pi(a|s)}[r(s,\pi(s))+\gamma E_{s&#x27;-p(s&#x27;|s,\pi(s))}[V^\pi(s&#x27;)]]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.801892em;"></span><span class="strut bottom" style="height:1.157092em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mbin">âˆ’</span><span class="mord mathit">i</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">a</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mord mathrm">âˆ£</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mclose">]</span></span></span></span></span></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-141107.png" alt="image-20221102221107185" /></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>âˆ’</mo><mi>i</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>)</mo><msup><mi>V</mi><mi>Ï€</mi></msup><mo>(</mo><mi>s</mi><mo>)</mo><mo>=</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>a</mi></msub><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>a</mi></msub><mo>(</mo><mi>r</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>+</mo><mi>Î³</mi><msub><mi>E</mi><mrow><msup><mi>s</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>âˆ’</mo><mi>p</mi><mo>(</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow></msub><mo>[</mo><msup><mi>V</mi><mi>Ï€</mi></msup><mo>(</mo><msup><mi>s</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo><mo>]</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(value-iteration)V^\pi(s)=max_aQ(s,a)=max_a(r(s,a)+\gamma E_{s&#x27;-p(s&#x27;|s,a)}[V^\pi(s&#x27;)])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.801892em;"></span><span class="strut bottom" style="height:1.157092em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">u</span><span class="mord mathit">e</span><span class="mbin">âˆ’</span><span class="mord mathit">i</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></span></p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-141125.png" alt="image-20221102221124987" /></p><p>è¿™é‡Œå‚è€ƒï¼Œå¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹å‡ºpolicy evaluationï¼Œä»¥åŠvalue evaluationå¯¹å…¶åšäº†ä»€ä¹ˆç®€åŒ–</p><p><a href="https://hrl.boyuai.com/chapter/1/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E7%AE%97%E6%B3%95">åŠ¨æ‰‹å­¦å¼ºåŒ–å­¦ä¹ - Dynamic Programming</a></p><h2 id="0x02-fitted-value-iteration-and-q-iteration"><a class="markdownIt-Anchor" href="#0x02-fitted-value-iteration-and-q-iteration"></a> 0x02 Fitted value  iteration and Q- iteration</h2><h3 id="21-æˆ‘ä»¬å¦‚ä½•è¡¨ç¤ºstate-value-function-vs"><a class="markdownIt-Anchor" href="#21-æˆ‘ä»¬å¦‚ä½•è¡¨ç¤ºstate-value-function-vs"></a> 2.1 æˆ‘ä»¬å¦‚ä½•è¡¨ç¤ºstate- value- function V(s)</h3><p>åœ¨æ•°é‡è¾ƒå°‘çš„ç¦»æ•£ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¡¨æ ¼æˆ–è€…ä»€ä¹ˆæ¥è®°å½•ï¼Œä½†æ˜¯å¯¹äºè¿ç»­ç©ºé—´æˆ‘ä»¬å¯èƒ½æ— èƒ½ä¸ºåŠ›ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>ç¥ç»ç½‘ç»œæ¥å®ç°ä¸¤è€…çš„è¿‘ä¼¼</strong>ï¼Œä¹Ÿå°±æ˜¯è½¬æ¢ä¸º</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-141230.png" alt="image-20221102221230276" /></p><h3 id="22-ä»ç„¶æœ‰é—®é¢˜"><a class="markdownIt-Anchor" href="#22-ä»ç„¶æœ‰é—®é¢˜"></a> 2.2 ä»ç„¶æœ‰é—®é¢˜</h3><p>å› ä¸ºåœ¨ç¦»æ•£çŠ¶æ€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“çŠ¶æ€æ¦‚ç‡è½¬ç§»æ–¹å¼ã€‚æˆ‘ä»¬ä¼šå‡è®¾ä¸€ä¸ªå¹³å‡æ¦‚ç‡å†é‡æ–°åˆ†é…çš„æ–¹å¼æ¥æ›´æ–°è½¬ç§»æ¦‚ç‡ã€‚ä½†æ˜¯åœ¨è¿ç»­æƒ…å†µä¸‹è™½ç„¶æˆ‘ä»¬çŸ¥é“æ‹Ÿåˆæ‹Ÿåˆå‡ºstate- value- functionï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜ä¸çŸ¥é“çŠ¶æ€è½¬ç§»æ¦‚ç‡ï¼Œæ‰€ä»¥æˆ‘ä»¬æ±‚è§£ä¸å‡ºstate- value- function</p><p>ä½†æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦state- functionï¼Ÿç›´æ¥åˆ©ç”¨state- action- functionæ¥å–æœ€å¤§å€¼å°±è¡Œ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mi>Ï€</mi></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi>r</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>+</mo><mi>Î³</mi><mo>âˆ—</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow><msup><mi>a</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><msub><mi>Q</mi><mi>Ï•</mi></msub><mo>(</mo><msubsup><mi>s</mi><mi>i</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>i</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow><annotation encoding="application/x-tex">Q^\pi(s,a)=r(s,a)+\gamma *max_{a&#x27;}Q_\phi(s_i&#x27;,a_i&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8018919999999999em;"></span><span class="strut bottom" style="height:1.0879999999999999em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mbin">âˆ—</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">Ï•</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>ä½†æ˜¯è¿™æ ·æˆ‘ä»¬å¹¶ä¸èƒ½ä¿è¯æ”¶æ•›æ€§</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-141837.png" alt="image-20221102221836862" /></p><h2 id="0x03-q-learning-method"><a class="markdownIt-Anchor" href="#0x03-q-learning-method"></a> 0x03 Q- learning method</h2><h3 id="31-q-iteration-çš„ä¸€äº›æ€§è´¨"><a class="markdownIt-Anchor" href="#31-q-iteration-çš„ä¸€äº›æ€§è´¨"></a> 3.1 Q-iteration çš„ä¸€äº›æ€§è´¨</h3><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-142232.png" alt="image-20221102222232800" /></p><ol><li>å®ƒæ˜¯off- policyçš„</li><li>ç­‰ä»·ä¼˜åŒ–bellman error</li></ol><h3 id="32-online-q-learning"><a class="markdownIt-Anchor" href="#32-online-q-learning"></a> 3.2 Online Q- learning</h3><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-142533.png" alt="image-20221102222533482" /></p><p>é€šå¸¸ä¼šéœ€è¦ä¸€äº›exploration</p><ol><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ïµ</mi><mo>âˆ’</mo><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>d</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">\epsilon-greedy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Ïµ</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span></li><li>Boltzman exploration</li></ol><h2 id="0x04-value-functions-in-theory"><a class="markdownIt-Anchor" href="#0x04-value-functions-in-theory"></a> 0x04 Value Functions in Theory</h2><p>æˆ‘ä»¬éœ€è¦å°è¯•è§£é‡Šä¹‹å‰å–æœ€å¤§å€¼çš„æ–¹å¼æ˜¯å¦å¯ä»¥æ”¶æ•›ï¼ˆconvergeï¼‰</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-142722.png" alt="image-20221102222722182" /></p><ol><li>MDPä¸­çš„bellmanä¸€å®šæ˜¯æ”¶æ•›çš„</li><li>åœ¨åˆ©ç”¨è¿‘ä¼¼ç½‘ç»œï¼ˆfunction approximationï¼‰çš„æ–¹å¼ä¸‹å¹¶ä¸æ”¶æ•›</li></ol><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-11-02-143053.png" alt="image-20221102223053608" />æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªéå¸¸sad corollaryï¼Œä½†æ˜¯åœ¨ä¸‹ä¸€å¼ çš„DQNä¸­å¯ä»¥è®©å®ƒå˜çš„æ›´å¥½</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;åœ¨ç»è¿‡Lecture04ä»‹ç»RLçš„åŸºæœ¬æ¦‚å¿µä¹‹åï¼ŒLecture05ä»‹ç»åŸºäºpolicyçš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç›´æ¥åˆ©ç”¨returnçš„æ¢¯åº¦è¿›è¡Œç­–ç•¥å­¦ä¹ ï¼Œä¹‹åæˆ‘ä»¬å°è¯•åˆ©ç”¨Qæˆ–è€…Væ¥æ”¹è¿›policy evaluationæ­¥éª¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥ç›´æ¥æŠ›å¼ƒå‚æ•°åŒ–çš„æ¢¯åº¦ï¼ˆparameterized policiesï¼‰ï¼Œè½¬å‘ä»…ä»…åˆ©ç”¨Qæˆ–è€…Vè¿›è¡ŒRL&lt;/p&gt;</summary>
    
    
    
    <category term="RL" scheme="https://blog.tjdata.site/categories/RL/"/>
    
    
    <category term="CS285" scheme="https://blog.tjdata.site/tags/CS285/"/>
    
  </entry>
  
  <entry>
    <title>CS285_Lecture06_Actor_Critic_Algorithms</title>
    <link href="https://blog.tjdata.site/posts/d30aca79.html"/>
    <id>https://blog.tjdata.site/posts/d30aca79.html</id>
    <published>2022-10-30T02:58:38.000Z</published>
    <updated>2023-05-13T13:48:19.233Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸»è¦ä»‹ç»æ¼”å‘˜è¯„è®ºå®¶è¿‡ç¨‹,ä»æœ€åŸºç¡€çš„Policy Gradientä¸­å‰–æå¦‚ä½•æ‹ŸåˆPolicy Evaluationçš„éƒ¨åˆ†ï¼Œå¹¶æ¨å¯¼å¾—åˆ°Actor- Criticç®—æ³•ã€‚å¯ä»¥çœ‹å‡ºä»ä¹‹å‰ç›´è§‚çš„Policyï¼Œåˆ°åˆ©ç”¨state- valueæˆ–è€…action- state- valueè¿›è¡Œè¿‘ä¼¼ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­é‡‡æ ·ç»“æœä¸ç†è®ºæ¨å¯¼çš„æƒè¡¡è´¯ç©¿ç†è®ºæ¨å¯¼è¿‡ç¨‹ã€‚åœ¨è¿™ä¸ªåŸºç¡€ä¸Šä¹Ÿä¼šå¼•æ¥ä¸‹ä¸€èŠ‚Lecture07å…³äºvalue functionæ–¹æ³•ã€‚åŒæ—¶çªç„¶æœ‰ä¸ªæ–°çš„æƒ³æ³•ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ä»£ç éƒ½éœ€è¦æ‰‹æ’•ï¼Œbaseline is always thereï¼</p><span id="more"></span><h2 id="0x01-ä»ç­–ç•¥æ¢¯åº¦policy-gradientåˆ°è¯„åˆ¤å®¶critic"><a class="markdownIt-Anchor" href="#0x01-ä»ç­–ç•¥æ¢¯åº¦policy-gradientåˆ°è¯„åˆ¤å®¶critic"></a> 0x01 ä»ç­–ç•¥æ¢¯åº¦ï¼ˆPolicy Gradientï¼‰åˆ°è¯„åˆ¤å®¶ï¼ˆCriticï¼‰</h2><h3 id="11-å›é¡¾reinforceç®—æ³•"><a class="markdownIt-Anchor" href="#11-å›é¡¾reinforceç®—æ³•"></a> 1.1 å›é¡¾REINFORCEç®—æ³•</h3><p>ä»å¼ºåŒ–å­¦ä¹ çš„ä¸‰æ­¥èŒƒå¼å‡ºå‘ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šé€šè¿‡è¿è¡Œç­–ç•¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Î </mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\Pi_\theta(a_t|s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathrm">Î </span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span>å¾—åˆ°å¤šä¸ªæ ·æœ¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><msub><mi>Ï„</mi><mi>i</mi></msub><mo>}</mo></mrow><annotation encoding="application/x-tex">\{\tau_i\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">}</span></span></span></span></p><p>ç¬¬äºŒæ­¥ï¼šæ ¹æ®é‡‡æ ·æ ·æœ¬ï¼ˆSampleï¼‰å¾—åˆ°ç­–ç•¥çš„æ¢¯åº¦</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>J</mi><mo>(</mo><mi>Î¸</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mo>[</mo><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo><mo>]</mo><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></msubsup><mi>r</mi><mo>(</mo><msubsup><mi>s</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow><mi>i</mi></msubsup><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">\nabla_\theta J(\theta)=\frac{1}{N}\Sigma_{i=1}^N\Sigma_{t=1}^T [\nabla_\theta log \pi_\theta(a_{i,t}|s_{i,t})][\Sigma_{t&#x27;=t}^Tr(s_{t&#x27;}^i,a_{t&#x27;}^i)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>J</mi><mo>(</mo><mi>Î¸</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mo>[</mo><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo><mo>]</mo><mo>[</mo><msub><mover accent="true"><mi>Q</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>]</mo></mrow><annotation encoding="application/x-tex">=\nabla_\theta J(\theta)=\frac{1}{N}\Sigma_{i=1}^N\Sigma_{t=1}^T [\nabla_\theta log \pi_\theta(a_{i,t}|s_{i,t})][\hat Q_{i,t}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit">Q</span></span><span style="top:-0.25233em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">]</span></span></span></span></span></p><p>ç¬¬ä¸‰æ­¥ï¼šæ¢¯åº¦ä¸Šå‡</p><h3 id="12-å›é¡¾æ¢¯åº¦å…¬å¼"><a class="markdownIt-Anchor" href="#12-å›é¡¾æ¢¯åº¦å…¬å¼"></a> 1.2 å›é¡¾æ¢¯åº¦å…¬å¼</h3><p>æ¢¯åº¦å…¬å¼ä¸­çš„logé¡¹ç›®åœ¨REINFORCEMENTä¸­å·²ç»è¯¦ç»†æ¨å¯¼è¿‡ï¼Œç›¸å½“äºæ˜¯LIkelihoodçš„ä¸€ç§åŠ æƒï¼›è€Œåé¢çš„<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>Q</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat Q_{i,t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9467699999999999em;"></span><span class="strut bottom" style="height:1.232878em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit">Q</span></span><span style="top:-0.25233em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>ä»£è¡¨çš„æ˜¯æˆ‘ä»¬åœ¨è½¨è¿¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Ï„</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\tau_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>ä¸­æ—¶é—´tä¸­çŠ¶æ€<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_{i,t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>é‡‡å–<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{i,t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>æ‰€å¾—åˆ°çš„åç»­state- actionæœŸæœ›å¥–åŠ±ï¼ˆexcepted rewardï¼‰ï¼›ä¸‹é¢æ˜¯çœŸå®çš„reward to goï¼Œæ³¨æ„å’Œé‡‡æ ·æ—¶å€™çš„åŒºåˆ«</p>ï¼ˆç†è®ºstate- action-valueï¼‰Q(s_t,a_t)=\Sigma_{t'=t}^TE\pi_\theta[r(s_{t'},a_{t'})|s_t,a_t]<p>ä¸è¦å¿˜è®°æˆ‘ä»¬çš„baselineï¼Œå®ƒå¯ä»¥èµ·åˆ°é™ä½æ–¹å·®çš„ä½œç”¨ã€‚æˆ‘ä»¬å¯ä»¥å°†baselineåŠ åˆ°REINFORCEMENTç®—æ³•ä¸­ã€‚åŒæ—¶å¯ä»¥è®¾ç½®æˆä¸ºä¸€ä¸ªä¸çŠ¶æ€æœ‰å…³çš„å€¼ï¼Œè¯¦ç»†è§ä¸Šä¸€ä¸ªLecture</p>ï¼ˆç†è®ºstate- valueï¼‰V(s_t)=E_{a_t-\pi_\theta(a_t|s_t)}Q(s_t,a_t)<p>ä»¥ä¸Šæ˜¯ç†è®ºçš„æ¨å¯¼</p><p>æˆ‘ä»¬åœ¨å®é™…é‡‡æ ·ä¸­å¾€å¾€åªèƒ½ä»æœ‰é™çš„æ ·æœ¬ä¸­å¾—åˆ°ï¼Œæ‰€ä»¥å¯¹äºæŸä¸ªé‡‡æ ·è½¨è¿¹å¾—åˆ°çš„æ¢¯åº¦å¯ä»¥è®¡ç®—ä¸ºï¼š</p>ï¼ˆé‡‡æ ·æ¢¯åº¦ï¼‰\nabla_\theta J(\theta)=\frac{1}{N}\Sigma_{i=1}^N\Sigma_{t=1}^T \nabla_\theta log \pi_\theta(a_{i,t}|s_{i,t})[Q(s_{i,t},a_{i,t})-V(S_{i,t})]<p>æ³¨æ„è¿™é‡Œçš„Nä»£è¡¨çš„æ˜¯æ€»å…±æœ‰iä¸ªè½¨è¿¹ï¼Œé‡‡æ ·å’Œç†è®ºä¹‹é—´çš„åŒºåˆ«ï¼Œæ›´è¿‘ä¸€æ­¥æˆ‘ä»¬å¯ä»¥å°†ï¼šã€æŸä¸ªçŠ¶æ€ä¸‹çš„åŠ¨ä½œæ€»å¥–åŠ±ã€‘å‡å»ã€æŸä¸ªçŠ¶æ€ä¸‹çš„æ‰€æœ‰åŠ¨ä½œæœŸæœ›ã€‘å¯ä»¥å®šä¹‰ä¸ºè¿™ä¸ªã€ç‰¹å®šåŠ¨ä½œåœ¨è¯¥çŠ¶æ€ä¸‹çš„ä¼˜åŠ¿ã€‘</p>ï¼ˆç†è®ºaction- stateä¼˜åŠ¿ï¼‰A^\pi(s_t,a_t)=Q^\pi(s_t,a_t)-V^\pi(s_t)<p>åŒæ ·çš„å’Œæˆ‘ä»¬ä¸çŸ¥é“Qå’ŒVä¸€æ ·ï¼Œæˆ‘ä»¬é€šå¸¸ä¹Ÿä¸çŸ¥é“Açš„å®é™…ä»·å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨è¿‘ä¼¼ï¼ˆapproximateï¼‰çš„æ–¹æ³•æ¥è¿‘ä¼¼å®ƒï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„estimate returnã€‚é€šå¸¸å¦‚æœæˆ‘ä»¬çš„é‡‡æ ·æ–¹å¼åªæ˜¯å•çº¯çš„è’™ç‰¹å¡æ´›é‡‡æ ·ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœå¾€å¾€æ˜¯ï¼šæ— åå·®ä½†æ˜¯é«˜æ–¹å·®çš„ç®€å•é‡‡æ ·ä¼°è®¡ã€‚</p><h2 id="0x02-æ¢¯åº¦è¯„ä¼°policy-evaluation"><a class="markdownIt-Anchor" href="#0x02-æ¢¯åº¦è¯„ä¼°policy-evaluation"></a> 0x02 æ¢¯åº¦è¯„ä¼°ï¼ˆPolicy Evaluationï¼‰</h2><p>åœ¨ä¸Šè¿°æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨REINFORCEMENTé‡Œé¢å¯¹äºpolicy gradientæˆ‘ä»¬é€šå¸¸æ˜¯ä½¿ç”¨ã€æ ·æœ¬ä¸­ç‰¹å®šçš„å¥–åŠ±æ±‚å’Œã€‘ï¼Œè¿™æ ·å¸¦æ¥çš„ç»“æœæ˜¯å› ä¸ºæˆ‘ä»¬é‡‡æ ·çš„è¯¯å·®æ€§å¯¼è‡´æœ€ç»ˆç»“æœå…·æœ‰high varianceï¼Œè¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯èƒ½å¸Œæœ›ï¼š</p><p>ä¸ºä»€ä¹ˆä¸æŠŠè¿™ä¸ªå‡½æ•°æ‹Ÿåˆå‡ºæ¥ï¼Ÿ------&gt; value function fitting</p><p>å¦‚æœæˆ‘ä»¬å¸Œæœ›æ‹Ÿåˆå‡½æ•°ï¼Œä¸Šè¿°çš„<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo separator="true">,</mo><mi>V</mi><mo>(</mo><mi>s</mi><mo>)</mo><mo separator="true">,</mo><mi>A</mi><mo>(</mo><mi>a</mi><mo separator="true">,</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q(s,a),V(s),A(a,s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathit">A</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>ä¸­ä¼šé€‰æ‹©å“ªä¸ªå‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mi>Ï€</mi></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></msubsup><msub><mi>E</mi><mrow><msub><mi>Ï€</mi><mi>Î¸</mi></msub></mrow></msub><mo>[</mo><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>)</mo><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">Q^\pi(s,a)=\Sigma_{t&#x27;=t}^TE_{\pi_\theta}[r(s_{t&#x27;},a_{t&#x27;})|s,a]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1471909999999998em;vertical-align:-0.25586em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathrm">âˆ£</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">]</span></span></span></span></span></p><p>ä½†æ˜¯ç”±äºå½“å‰çš„çŠ¶æ€æˆ‘ä»¬çŸ¥é“ï¼Œæ‰€ä»¥å¯ä»¥å†™æˆ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mi>Ï€</mi></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi>r</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>+</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>E</mi><mrow><msub><mi>Ï€</mi><mi>Î¸</mi></msub></mrow></msub><mo>[</mo><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>)</mo><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">Q^\pi(s,a)=r(s,a)+\Sigma_{t&#x27;=t+1}^TE_{\pi_\theta}[r(s_{t&#x27;},a_{t&#x27;})|s,a]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.891331em;"></span><span class="strut bottom" style="height:1.196662em;vertical-align:-0.305331em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathrm">âˆ£</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">]</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mi>Ï€</mi></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi>r</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>+</mo><msub><mi>E</mi><mrow><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>âˆ’</mo><mi>p</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><msup><mi>V</mi><mi>Ï€</mi></msup><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">Q^\pi(s,a)=r(s,a)+E_{s_{t+1}-p(s_{t+1}|s_t,a_t)V^\pi(s_{t+1})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°åœ¨ç†è®ºæƒ…å†µä¸‹åŸæ¥çš„policy gradientä¸º</p>ï¼ˆç†è®ºä¼˜åŠ¿ï¼‰A^\pi(s_t,a_t)=r(s,a)+E_{s_{t+1}-p(s_{t+1}|s_t,a_t)V^\pi(s_{t+1})}-V^\pi(s_t)<p>åœ¨é‡‡æ ·æƒ…å†µä¸‹</p>ï¼ˆé‡‡æ ·ä¼˜åŠ¿ï¼‰A^\pi(s_t,a_t)=r(s,a)+V^\pi(s_{t+1})-V^\pi(s_t)<h3 id="21-policy-evaluation-based-on-monte-carlo-sampling"><a class="markdownIt-Anchor" href="#21-policy-evaluation-based-on-monte-carlo-sampling"></a> 2.1 Policy evaluation based on Monte Carlo sampling</h3><p>æˆ‘ä»¬çŸ¥é“</p>ï¼ˆç†è®ºstate- valueï¼‰V(s_t)=E_{a_t-\pi_\theta(a_t|s_t)}Q(s_t,a_t)<p>æ‰€ä»¥æˆ‘ä»¬çš„policyè¯„ä»·å°±æ˜¯</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>âˆ’</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>(</mo><mi>p</mi><mi>o</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>y</mi><mo>)</mo><mo>)</mo><mi>J</mi><mo>(</mo><mi>Î¸</mi><mo>)</mo><mo>=</mo><msub><mi>E</mi><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>s</mi><mo>)</mo></mrow></msub><mo>[</mo><msup><mi>V</mi><mi>Ï€</mi></msup><mo>(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">(state-action(policy))J(\theta)=E_{s_1-p_\theta(s)}[V^\pi(s_1)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mbin">âˆ’</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>å¦‚æœæˆ‘ä»¬åªæ˜¯ä»é‡‡æ ·çš„æ–¹å¼æ¥å¾—åˆ°æˆ‘ä»¬çš„ä¼°è®¡ï¼Œé‚£ä¹ˆ</p>ï¼ˆé‡‡æ ·ï¼‰V^\pi(s_t)=\Sigma_{t'=t}^Tr(s_{t'},a_{t'})<p>è™½ç„¶ä¸æƒ³ç†è®ºæ¨å¯¼é‚£æ ·çš„ä¼˜ç§€ï¼Œä½†æ˜¯åŒæ ·æ˜¯æœ‰æ•ˆçš„ã€‚æ³¨æ„è¿™é‡Œçš„è¿‡ç¨‹æ˜¯æˆ‘ä»¬ä»REINFORCEMENTé‡Œé¢å•çº¯çš„ä½¿ç”¨é‡‡æ ·ç»“æœï¼Œè½¬å‘æ„å»ºä¸€ä¸ªstate- based- functionï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯æ ¹æ®æ ·æœ¬æ‹Ÿåˆè¿™æ ·çš„å‡½æ•°ã€‚ä½†æ˜¯æ³¨æ„è¿™é‡Œï¼ï¼æˆ‘ä»¬æœ‰äº†datasetï¼ˆinputï¼Œoutputï¼‰ï¼Œæˆ–è®¸æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›‘ç£å­¦ä¹ ï¼ˆsupervised learningï¼‰æ¥ä½¿ç”¨ä¸€ç§ç¥ç»ç½‘ç»œçš„æ–¹æ³•æ¥å­¦ä¹ ä¸€ç§å‡½æ•°å…³ç³»ã€‚æ‰€ä»¥æ¥ä¸‹æ¥é—®é¢˜æ˜¯ã€æˆ‘ä»¬å¦‚ä½•ä»å°‘é‡çš„æ ·æœ¬ä¸­å¾—åˆ°è¶³å¤Ÿå¥½çš„æ•°æ®ã€‘</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo>âˆ’</mo><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo>:</mo><mrow><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo separator="true">,</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></msubsup><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>)</mo><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">train-data:{(s_{i,t},\Sigma_{t&#x27;=t}^T r(s_{i,t&#x27;},a_{i,t&#x27;}))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.177439em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mbin">âˆ’</span><span class="mord mathit">d</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mrel">:</span><span class="mord displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>b</mi><mi>o</mi><mi>o</mi><mi>t</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>a</mi><mi>p</mi><mi>p</mi><mi>e</mi><mi>d</mi><mo>âˆ’</mo><mi>e</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>)</mo><msub><mover accent="true"><mi>V</mi><mo>^</mo></mover><mi>Ï•</mi></msub><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo><mo>=</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></msubsup><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>)</mo><mo>)</mo><mo>=</mo><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>)</mo><mo>+</mo><msub><mover accent="true"><mi>V</mi><mo>^</mo></mover><mi>Ï•</mi></msub><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(bootstrapped-estimate)\hat V_\phi(s_{i,t})=\Sigma_{t&#x27;=t}^T r(s_{i,t&#x27;},a_{i,t&#x27;}))=r(s_{i,t&#x27;},a_{i,t&#x27;})+\hat V_\phi(s_{i,t+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9467699999999999em;"></span><span class="strut bottom" style="height:1.232878em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">b</span><span class="mord mathit">o</span><span class="mord mathit">o</span><span class="mord mathit">t</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">p</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mbin">âˆ’</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span><span style="top:-0.25233em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">Ï•</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span><span style="top:-0.25233em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">Ï•</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>u</mi><mi>p</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>i</mi><mi>s</mi><mi>e</mi><mi>d</mi><mo>âˆ’</mo><mi>r</mi><mi>e</mi><mi>g</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>:</mo><mi>L</mi><mo>(</mo><mi>Ï•</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><msubsup><mover accent="true"><mi>V</mi><mo>^</mo></mover><mi>Ï•</mi><mi>Ï€</mi></msubsup><mo>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>)</mo><mo>âˆ’</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi><msup><mi mathvariant="normal">âˆ£</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">supervised-regression:L(\phi)=\frac{1}{2}\Sigma_{i=1}^N||\hat V_\phi^\pi(s_i)-y_i||^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">u</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mrel">:</span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit">Ï•</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span><span style="top:-0.25233em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">Ï•</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathrm">âˆ£</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><h2 id="0x03-ä»evaluationåˆ°actor-critic"><a class="markdownIt-Anchor" href="#0x03-ä»evaluationåˆ°actor-critic"></a> 0x03 ä»Evaluationåˆ°Actor- Critic</h2><h3 id="31-æ‰¹é‡acç®—æ³•actor-critic-algorithm"><a class="markdownIt-Anchor" href="#31-æ‰¹é‡acç®—æ³•actor-critic-algorithm"></a> 3.1 æ‰¹é‡ACç®—æ³•ï¼ˆactor- critic algorithmï¼‰</h3><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-10-31-153109.png" alt="image-20221031195007227" /></p><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨è¿™æ ·çš„ç®—æ³•ï¼Œæˆ‘ä»¬ä¼šå‘ç°å…¶å®åœ¨è½¨è¿¹ä¹‹é—´éƒ½å¯ä»¥å¯¹state- valueè¿›è¡Œè¯„ä¼°ï¼Œä½†æ˜¯è¿™æ ·æ±‚è§£å¾—åˆ°çš„yæ˜¯ä¸ä¸€æ ·çš„ï¼Œåœ¨ä¸åŒè½¨è¿¹ä¸­å› ä¸ºçŠ¶æ€å˜æ¢ä¸ä¸€æ ·ï¼Œå¦‚æœæœ€åéƒ½è¾¾åˆ°stationçŠ¶æ€æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¯¹äºä¸å¹³ç¨³æ˜¯ä¸OKçš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„labelä¸å‡†ç¡®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¢åŠ ä¸€ä¸ªdiscount factor</p>ï¼ˆé‡‡æ ·ä¼˜åŠ¿ï¼‰A^\pi(s_t,a_t)=r(s,a)+\gamma V^\pi(s_{t+1})-V^\pi(s_t)<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬é‡‡æ ·Monte Carloé‡‡æ ·ï¼Œè®¡ç®—æ¢¯åº¦ï¼Œå“ªä¸€ä¸ªæ˜¯å¯¹çš„ï¼Ÿ</p>(option1é‡‡æ ·ï¼‰\nabla_\theta J(\theta)=\frac{1}{N}\Sigma\Sigma \nabla_\theta \pi_\theta(a_{i,t}|s_{i,t})(\Sigma_{t'=t}^T\gamma^{t'-t}r(s_{i,t'},a_{i,t'}))(option2é‡‡æ ·ï¼‰\nabla_\theta J(\theta)=\frac{1}{N}\Sigma\Sigma \nabla_\theta \pi_\theta(a_{i,t}|s_{i,t})(\Sigma_{t'=t}^T\gamma^{t'-1}r(s_{i,t'},a_{i,t'}))<p>å¦‚æœåªæ˜¯ä»option1é‡‡æ ·ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœæ˜¯ä»æ¯ä¸€æ­¥é‡æ–°å¼€å§‹åšdiscountï¼Œè¿™ä¸ªæ˜¯ç¬¦åˆç›´è§‰çš„</p><p>å¦‚æœæ˜¯ä»option2é‡‡æ ·ä¹Ÿä¸æ˜¯æ²¡æœ‰ç»“æœçš„ï¼Œå¦‚æœæˆ‘ä»¬é’ˆå¯¹æœªæ¥ææƒ§æ‰€ä»¥ä¼šæœ‰å¾ˆå¤šçš„discountã€‚</p><p>exampleï¼šè¿™é‡ŒSergey Levineå°è¯•ä½¿ç”¨deadæ¥è§£é‡Šoption1å’Œoption2çš„åŒºåˆ«ï¼Œä¸¤è€…éƒ½æ˜¯å¯¹çš„ã€‚</p><p>æ‰€ä»¥æ€»ç»“æˆ‘ä»¬çš„ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†ä¸ºbatcc ACä¸online ACä¸¤ç§æ–¹æ³•</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-10-31-153113.png" alt="image-20221031200710794" /></p><h2 id="0x04-æ¼”å‘˜è¯„è®ºç®—æ³•-actor-critics-algorithmç»†èŠ‚"><a class="markdownIt-Anchor" href="#0x04-æ¼”å‘˜è¯„è®ºç®—æ³•-actor-critics-algorithmç»†èŠ‚"></a> 0x04 æ¼”å‘˜è¯„è®ºç®—æ³• Actor- Critics Algorithmç»†èŠ‚</h2><h3 id="41-æ‹Ÿåˆå‡½æ•°è®­ç»ƒ"><a class="markdownIt-Anchor" href="#41-æ‹Ÿåˆå‡½æ•°è®­ç»ƒ"></a> 4.1 æ‹Ÿåˆå‡½æ•°è®­ç»ƒ</h3><p>æˆ‘ä»¬å¯ä»¥é€‰æ‹©ç”¨ä¸¤ä¸ªnetworkæ¥åˆ†åˆ«æ‹Ÿåˆstate- value functionä¸policy- state- actionç½‘ç»œï¼›ä½†æ˜¯åœ¨æ¯”è¾ƒå¤æ‚çš„è¾“å…¥ï¼Œæ¯”å¦‚æ¸¸æˆå›¾ç‰‡ä¸­æˆ‘ä»¬å¾€å¾€éœ€è¦ä½¿ç”¨convolution layerå…±äº«å‚æ•°æ¥å‡å°‘ç½‘ç»œçš„å‚æ•°</p><h3 id="42-åœ¨çº¿acè®­ç»ƒ"><a class="markdownIt-Anchor" href="#42-åœ¨çº¿acè®­ç»ƒ"></a> 4.2 åœ¨çº¿ACè®­ç»ƒ</h3><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-10-31-153116.png" alt="image-20221031201549764" /></p><p>å¦‚æœåªæ˜¯è¿™æ ·è®­ç»ƒï¼Œç›¸å½“äºæˆ‘ä»¬æ¯æ¬¡æ›´æ–°æ¢¯åº¦ä½¿ç”¨æ‰¹é‡batchsize=1ï¼Œæ‰€ä»¥éå¸¸å·®ã€‚æˆ‘ä»¬ä»é‡‡æ ·çš„è§’åº¦å‡ºå‘ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒæ­¥å¹¶è¡Œ(synchronized parallel actor-critic) æˆ–è€…å¼‚æ­¥å¹³è¡Œï¼ˆasynchronous parallel actor- criticï¼‰æ¥å¤šæ¬¡é‡‡æ ·ï¼Œä½†æ˜¯è¿™æ ·çš„æŸè€—å¤ªå¤§äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨replay bufferæ¥å­˜å‚¨ä¹‹å‰é‡‡æ ·çš„æ•°æ®ã€‚</p><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬åªæ˜¯ç®€å•çš„ä»replay bufferä¸­å¾—åˆ°train-dataï¼Œä½†æ˜¯è¿™æ ·æ˜¯æ²¡æœ‰æ•ˆæœçš„ï¼Œå› ä¸ºä¸æ˜¯åŒä¸€ä¸ªè½¨è¿¹æ„æˆçš„policy gradientæ˜¯æ²¡æœ‰æ•ˆæœçš„ï¼Œæ‰€ä»¥è¿™æ ·çš„ç®—æ³•æ˜¯ä¸å¯¹çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šå°è¯•å°†ä¹‹é—´çš„æŠ½æ ·å¾—åˆ°çš„state- valueè½¬æ¢æˆä¸ºåŒ…æ‹¬Q(s,a)çš„å€¼</p><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-10-31-153117.png" alt="image-20221031202523007" /></p><p>æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬ä¸å†ä½¿ç”¨state- valueï¼Œè€Œæ˜¯ä½¿ç”¨action- state- value</p><h3 id="43-baselineè®¾ç½®"><a class="markdownIt-Anchor" href="#43-baselineè®¾ç½®"></a> 4.3 Baselineè®¾ç½®</h3><p>æˆ‘ä»¬åœ¨Policy gradientå¼•å…¥ä¸€ä¸ªå¸¸æ•°ï¼Œå¾—åˆ°æ— åå·®ã€ä½†æ˜¯é«˜æ–¹å·®çš„æ¢¯åº¦ï¼›åœ¨ACä¸­æˆ‘ä»¬ä½¿ç”¨ r+Vï¼ˆt+1ï¼‰- Vï¼ˆtï¼‰æ¥å¾—åˆ°è¯„ä¼°ï¼Œè¿™æ ·ä¼šæœ‰ä¸€ä¸ªä½æ–¹å·®ä½†æ˜¯æœ‰åçš„æ–¹ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚ä½•åœ¨æ‹Ÿåˆä»·å€¼å‡½æ•°è¿‡ç¨‹ä¸­å¾—åˆ°æˆ‘ä»¬çš„æ¢¯åº¦ï¼Œä¹Ÿå°±æ˜¯ç”¨Q-Væ¥è¯„ä¼°ï¼ˆç§°ä¸ºè’™ç‰¹å¡æ´›æ–¹æ³•ï¼‰ï¼Œä½†æ˜¯è¿™æ ·å¯¹é‡‡æ ·æ•°é‡è¦æ±‚é«˜ã€‚</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mover accent="true"><mi>A</mi><mo>^</mo></mover><mi>C</mi><mi>Ï€</mi></msubsup><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><mi>r</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>+</mo><mi>Î³</mi><msubsup><mover accent="true"><mi>V</mi><mo>^</mo></mover><mi>Ï•</mi><mi>Ï€</mi></msubsup><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo><mo>âˆ’</mo><msubsup><mover accent="true"><mi>V</mi><mo>^</mo></mover><mi>Ï•</mi><mi>Ï€</mi></msubsup><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\hat A^\pi_C(s_t,a_t)=r(s_t,a_t)+\gamma \hat V^\pi_\phi(s_{t+1})-\hat V^\pi_\phi(s_{t})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9467699999999999em;"></span><span class="strut bottom" style="height:1.329878em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit">A</span></span><span style="top:-0.25233em;margin-left:0.27778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span><span style="top:-0.25233em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">Ï•</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span><span style="top:-0.25233em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">Ï•</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mover accent="true"><mi>A</mi><mo>^</mo></mover><mrow><mi>M</mi><mi>C</mi></mrow><mi>Ï€</mi></msubsup><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><msub><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi></mrow></msub><msup><mi>Î³</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>âˆ’</mo><mi>t</mi></mrow></msup><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>)</mo><mo>âˆ’</mo><msubsup><mover accent="true"><mi>V</mi><mo>^</mo></mover><mi>Ï•</mi><mi>Ï€</mi></msubsup><mo>(</mo><msub><mi>s</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\hat A^\pi_{MC}(s_t,a_t)=\Sigma_{t&#x27;=t}\gamma^{t&#x27;-t}r(s_{t&#x27;},a_{t&#x27;})-\hat V^\pi_\phi(s_{t&#x27;})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9467699999999999em;"></span><span class="strut bottom" style="height:1.329878em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit">A</span></span><span style="top:-0.25233em;margin-left:0.27778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span><span style="top:-0.25233em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">Ï•</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨æŸç§æ–¹å¼æ¥ç»“åˆä¸¤è€…ï¼Œä¹Ÿå°±æ˜¯é‡‡æ ·N-step returns</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mover accent="true"><mi>A</mi><mo>^</mo></mover><mrow><mi>n</mi></mrow><mi>Ï€</mi></msubsup><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi></mrow><mrow><mi>t</mi><mo>+</mo><mi>n</mi></mrow></msubsup><msup><mi>Î³</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>âˆ’</mo><mi>t</mi></mrow></msup><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>)</mo><mo>âˆ’</mo><msubsup><mover accent="true"><mi>V</mi><mo>^</mo></mover><mi>Ï•</mi><mi>Ï€</mi></msubsup><mo>(</mo><msub><mi>s</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>)</mo><mo>+</mo><msup><mi>Î³</mi><mi>n</mi></msup><msubsup><mover accent="true"><mi>V</mi><mo>^</mo></mover><mi>Ï•</mi><mi>Ï€</mi></msubsup><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mi>n</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\hat A^\pi_{n}(s_t,a_t)=\Sigma_{t&#x27;=t}^{t+n}\gamma^{t&#x27;-t}r(s_{t&#x27;},a_{t&#x27;})-\hat V^\pi_\phi(s_{t&#x27;})+\gamma^n\hat V^\pi_\phi(s_{t+n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9467699999999999em;"></span><span class="strut bottom" style="height:1.329878em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit">A</span></span><span style="top:-0.25233em;margin-left:0.27778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.28541099999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span><span style="top:-0.25233em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">Ï•</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span><span style="top:-0.25233em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">Ï•</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>ä¹‹ååŒ…æ‹¬generalized advantage estimationæ¨å¯¼å¯ä»¥å‘ç°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î³</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05556em;">Î³</span></span></span></span>å¯ä»¥æœ‰æ•ˆçš„é™ä½æ–¹å·®</p><h2 id="0x05-review"><a class="markdownIt-Anchor" href="#0x05-review"></a> 0x05 review</h2><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-10-31-153122.png" alt="image-20221031203538556" /></p><h2 id="0x06-code"><a class="markdownIt-Anchor" href="#0x06-code"></a> 0x06 code</h2><p>å‚è€ƒ<a href="https://hrl.boyuai.com/chapter/intro/">åŠ¨æ‰‹å­¦å¼ºåŒ–å­¦ä¹ </a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gym<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torch.nn.functional <span class="hljs-keyword">as</span> F<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> rl_utils<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ActorCritic</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, state_dim, hidden_dim, action_dim, actor_lr, critic_lr,</span><br><span class="hljs-params">                 gamma, device</span>):<br>        <span class="hljs-comment"># ç­–ç•¥ç½‘ç»œ</span><br>        self.actor = PolicyNet(state_dim, hidden_dim, action_dim).to(device)<br>        self.critic = ValueNet(state_dim, hidden_dim).to(device)  <span class="hljs-comment"># ä»·å€¼ç½‘ç»œ</span><br>        <span class="hljs-comment"># ç­–ç•¥ç½‘ç»œä¼˜åŒ–å™¨</span><br>        self.actor_optimizer = torch.optim.Adam(self.actor.parameters(),<br>                                                lr=actor_lr)<br>        self.critic_optimizer = torch.optim.Adam(self.critic.parameters(),<br>                                                 lr=critic_lr)  <span class="hljs-comment"># ä»·å€¼ç½‘ç»œä¼˜åŒ–å™¨</span><br>        self.gamma = gamma<br>        self.device = device<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">take_action</span>(<span class="hljs-params">self, state</span>):<br>        state = torch.tensor([state], dtype=torch.<span class="hljs-built_in">float</span>).to(self.device)<br>        probs = self.actor(state)<br>        action_dist = torch.distributions.Categorical(probs)<br>        action = action_dist.sample()<br>        <span class="hljs-keyword">return</span> action.item()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self, transition_dict</span>):<br>        states = torch.tensor(transition_dict[<span class="hljs-string">&#x27;states&#x27;</span>],<br>                              dtype=torch.<span class="hljs-built_in">float</span>).to(self.device)<br>        actions = torch.tensor(transition_dict[<span class="hljs-string">&#x27;actions&#x27;</span>]).view(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).to(<br>            self.device)<br>        rewards = torch.tensor(transition_dict[<span class="hljs-string">&#x27;rewards&#x27;</span>],<br>                               dtype=torch.<span class="hljs-built_in">float</span>).view(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).to(self.device)<br>        next_states = torch.tensor(transition_dict[<span class="hljs-string">&#x27;next_states&#x27;</span>],<br>                                   dtype=torch.<span class="hljs-built_in">float</span>).to(self.device)<br>        dones = torch.tensor(transition_dict[<span class="hljs-string">&#x27;dones&#x27;</span>],<br>                             dtype=torch.<span class="hljs-built_in">float</span>).view(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).to(self.device)<br><br>        <span class="hljs-comment"># æ—¶åºå·®åˆ†ç›®æ ‡</span><br>        td_target = rewards + self.gamma * self.critic(next_states) * (<span class="hljs-number">1</span> -<br>                                                                       dones)<br>        td_delta = td_target - self.critic(states)  <span class="hljs-comment"># æ—¶åºå·®åˆ†è¯¯å·®</span><br>        log_probs = torch.log(self.actor(states).gather(<span class="hljs-number">1</span>, actions))<br>        actor_loss = torch.mean(-log_probs * td_delta.detach())<br>        <span class="hljs-comment"># å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°</span><br>        critic_loss = torch.mean(<br>            F.mse_loss(self.critic(states), td_target.detach()))<br>        self.actor_optimizer.zero_grad()<br>        self.critic_optimizer.zero_grad()<br>        actor_loss.backward()  <span class="hljs-comment"># è®¡ç®—ç­–ç•¥ç½‘ç»œçš„æ¢¯åº¦</span><br>        critic_loss.backward()  <span class="hljs-comment"># è®¡ç®—ä»·å€¼ç½‘ç»œçš„æ¢¯åº¦</span><br>        self.actor_optimizer.step()  <span class="hljs-comment"># æ›´æ–°ç­–ç•¥ç½‘ç»œçš„å‚æ•°</span><br>        self.critic_optimizer.step()  <span class="hljs-comment"># æ›´æ–°ä»·å€¼ç½‘ç»œçš„å‚æ•°</span><br>  actor_lr = <span class="hljs-number">1e-3</span><br>critic_lr = <span class="hljs-number">1e-2</span><br>num_episodes = <span class="hljs-number">1000</span><br>hidden_dim = <span class="hljs-number">128</span><br>gamma = <span class="hljs-number">0.98</span><br>device = torch.device(<span class="hljs-string">&quot;cuda&quot;</span>) <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> torch.device(<br>    <span class="hljs-string">&quot;cpu&quot;</span>)<br><br>env_name = <span class="hljs-string">&#x27;CartPole-v0&#x27;</span><br>env_name=<span class="hljs-string">&#x27;MountainCar-v0&#x27;</span><br>env = gym.make(env_name)<br>env.seed(<span class="hljs-number">0</span>)<br>torch.manual_seed(<span class="hljs-number">0</span>)<br>state_dim = env.observation_space.shape[<span class="hljs-number">0</span>]<br>action_dim = env.action_space.n<br>agent = ActorCritic(state_dim, hidden_dim, action_dim, actor_lr, critic_lr,<br>                    gamma, device)<br><br>return_list = rl_utils.train_on_policy_agent(env, agent, num_episodes)<br>episodes_list = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(return_list)))<br>plt.plot(episodes_list, return_list)<br>plt.xlabel(<span class="hljs-string">&#x27;Episodes&#x27;</span>)<br>plt.ylabel(<span class="hljs-string">&#x27;Returns&#x27;</span>)<br>plt.title(<span class="hljs-string">&#x27;Actor-Critic on &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(env_name))<br>plt.show()<br><br>mv_return = rl_utils.moving_average(return_list, <span class="hljs-number">9</span>)<br>plt.plot(episodes_list, mv_return)<br>plt.xlabel(<span class="hljs-string">&#x27;Episodes&#x27;</span>)<br>plt.ylabel(<span class="hljs-string">&#x27;Returns&#x27;</span>)<br>plt.title(<span class="hljs-string">&#x27;Actor-Critic on &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(env_name))<br>plt.show()<br></code></pre></td></tr></table></figure><p><img src="http://chenxia31blog.oss-cn-hangzhou.aliyuncs.com/blog/2022-10-31-153251.png" alt="image-20221031233251437" /></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¸»è¦ä»‹ç»æ¼”å‘˜è¯„è®ºå®¶è¿‡ç¨‹,ä»æœ€åŸºç¡€çš„Policy Gradientä¸­å‰–æå¦‚ä½•æ‹ŸåˆPolicy Evaluationçš„éƒ¨åˆ†ï¼Œå¹¶æ¨å¯¼å¾—åˆ°Actor- Criticç®—æ³•ã€‚å¯ä»¥çœ‹å‡ºä»ä¹‹å‰ç›´è§‚çš„Policyï¼Œåˆ°åˆ©ç”¨state- valueæˆ–è€…action- state- valueè¿›è¡Œè¿‘ä¼¼ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­é‡‡æ ·ç»“æœä¸ç†è®ºæ¨å¯¼çš„æƒè¡¡è´¯ç©¿ç†è®ºæ¨å¯¼è¿‡ç¨‹ã€‚åœ¨è¿™ä¸ªåŸºç¡€ä¸Šä¹Ÿä¼šå¼•æ¥ä¸‹ä¸€èŠ‚Lecture07å…³äºvalue functionæ–¹æ³•ã€‚åŒæ—¶çªç„¶æœ‰ä¸ªæ–°çš„æƒ³æ³•ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ä»£ç éƒ½éœ€è¦æ‰‹æ’•ï¼Œbaseline is always thereï¼&lt;/p&gt;</summary>
    
    
    
    <category term="RL" scheme="https://blog.tjdata.site/categories/RL/"/>
    
    
    <category term="CS285" scheme="https://blog.tjdata.site/tags/CS285/"/>
    
  </entry>
  
  <entry>
    <title>CS285_Lecture05_Policy_Gradient</title>
    <link href="https://blog.tjdata.site/posts/ed4cf7b5.html"/>
    <id>https://blog.tjdata.site/posts/ed4cf7b5.html</id>
    <published>2022-10-23T12:01:56.000Z</published>
    <updated>2023-05-13T13:48:12.179Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬èŠ‚è¯¾çš„ç›®æ ‡æ˜¯ææ˜ç™½Policy gradientä¸€ç±»çš„REINFORCEMENTæ–¹æ³•ï¼Œå¹¶ä¸”ç†è§£èƒŒåçš„å±€é™æ€§ï¼Œç„¶åçŸ¥é“ä¸ºä»€ä¹ˆtextbookå¾ˆå®¹æ˜“è®²æ¸…æ¥šï¼Œä½†æ˜¯åœ¨å®è·µä¸­ä¸è¡Œçš„åŸå› ã€‚ä¹‹åä»Causalityå’ŒBaselineä¸¤ç§æ–¹æ³•æ¥é™ä½On- policy PGçš„æ–¹å·®ã€‚å¹¶ç»™å‡ºç»“åˆISï¼ˆimportant samplingï¼‰çš„Off policyçš„æ¢¯åº¦æ–¹æ³•ã€‚æœ€ååˆ©ç”¨ä»£ç å®ç°RLé‡Œé¢çš„hello worldâ€”CartPole-v0æ¥å®ç°ã€‚</p><span id="more"></span><h2 id="01-ä»€ä¹ˆæ˜¯policy-gradients"><a class="markdownIt-Anchor" href="#01-ä»€ä¹ˆæ˜¯policy-gradients"></a> 01 ä»€ä¹ˆæ˜¯Policy gradients</h2><h3 id="11-pgçš„æ¢¯åº¦å‡½æ•°çš„ä¸‹è½½"><a class="markdownIt-Anchor" href="#11-pgçš„æ¢¯åº¦å‡½æ•°çš„ä¸‹è½½"></a> 1.1 PGçš„æ¢¯åº¦å‡½æ•°çš„ä¸‹è½½</h3><p>å›é¡¾DRLçš„ç›®æ ‡ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯å¢åŠ ç´¯ç§¯å¥–åŠ±çš„æœŸæœ›ï¼š</p>ï¼ˆç›®æ ‡å‡½æ•°ï¼‰max\ E_{\tau-p_\theta(\tau)}[\Sigma_tr(s_t,a_t)] <p>æ ¹æ®<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(s_t,a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span> å¯¹çš„é©¬å°”å¯å¤«æ€§è´¨ï¼Œ(åœ¨æœ‰é™çš„æƒ…å†µä¸‹finite horizon caseï¼‰ä¸‹ç®€åŒ–æˆä¸º</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mtext>Â </mtext><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>E</mi><mrow><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>âˆ’</mo><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow></msub><mo>[</mo><mi>r</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">max\ \Sigma_{t=1}^TE_{(s_t,a_t)-p_\theta(s_t,a_t)}[r(s_t,a_t)] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.2465309999999998em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mord mspace">Â </span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥æ ¹æ®<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Ï€</mi><mi>Î¸</mi></msub></mrow><annotation encoding="application/x-tex">\pi_\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>é‡‡æ ·Nä¸ª<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï„</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span></span></span></span>,ç„¶åæ±‚å¾—æœŸæœ›ä¸º</p>ï¼ˆé‡‡æ ·åçš„ç›®æ ‡å‡½æ•°ï¼‰J(\theta)=\frac{1}{N}\Sigma_i\Sigma_tr(s_{i,t},a_{i,t}) <p>è¿™ä¸ªå¼å­çš„é‡è¦æ„ä¹‰åœ¨äºå®ƒç›´æ¥ç»™æˆ‘ä»¬ååº”å½“å‰policyçš„ä¼˜åŠ£ï¼Œä¹ŸæŒ‡æ˜äº†æˆ‘ä»¬éœ€è¦å‰è¿›çš„æ–¹å‘ï¼Œå°±æ˜¯æœ€å¤§åŒ–è¿™ä¸ªæœŸæœ›ï¼Œè™½ç„¶æœ‰çš„æ—¶å€™è¿™ä¸ªå¼å­å¹¶ä¸æ˜¯å®¹æ˜“è®¡ç®—ã€‚ä½†æ˜¯è¯·æŠŠå“ªäº›é—®é¢˜å…ˆæ”¾æ”¾ï¼Œç›´è§‚çš„æœ€å¤§åŒ–è¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ç”¨æ¢¯åº¦æå‡çš„æ–¹æ³•ï¼š</p>J(\theta)=\int p_\theta(\tau)r(\tau)d\tauï¼ˆä¸Šå¼ç®€å†™ï¼‰ <p>é‚£ä¹ˆå¯¹å‚æ•°æ±‚å¯¼çš„ç»“æœå°±æ˜¯ï¼›åŒæ—¶ç”±äºæˆ‘ä»¬æ— æ³•ç›´æ¥å–å€¼å‡½æ•°ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦è½¬æ¢ä¸ºæœŸæœ›çš„æ–¹å¼æ¥åˆ©ç”¨samplingâ€”expectationçš„æ–¹å¼æ¥æ±‚æœŸæœ›</p>ï¼ˆç›®æ ‡å‡½æ•°æ¢¯åº¦ï¼‰\nabla_\theta J(\theta)=\int \nabla_\theta p_\theta(\tau)*r(\tau)d\tau)\\=\int p_\theta(\tau)*\nabla_\theta logp_\theta(\tau)*r(\tau)d\tau\\=E_{\tau-p_\theta(\tau)}[\nabla_\theta logp_\theta(\tau)*r(\tau)] <p>æˆ‘ä»¬å¯¹ä¸Šé¢çš„ç›®æ ‡å‡½æ•°æ›´è¿›ä¸€æ­¥çš„æ¢è®¨ï¼›é¦–å…ˆç–‘é—®å°±æ˜¯ä»€ä¹ˆæ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p_\theta(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span>,åœ¨MDPçš„state- observation-action- stateè½¬ç§»ä¸­æˆ‘ä»¬å¯ä»¥è®¤è¯†åˆ°</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>=</mo><mi>p</mi><mo>(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>)</mo><mo>âˆ</mo><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo><mi>p</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p_\theta(\tau)=p(s_1)\prod \pi_\theta(a_t|s_t)p(s_{t+1}|s_t,a_t) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.05em;"></span><span class="strut bottom" style="height:1.6000100000000002em;vertical-align:-0.55001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="op-symbol large-op mop" style="top:-0.000004999999999977245em;">âˆ</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>æ‰€ä»¥å¯ä»¥å¾ˆè½»æ¾çš„æ›¿æ¢æ‰ä¸Šè¿°</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>p</mi><mo>(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>)</mo><mo>+</mo><mi mathvariant="normal">Î£</mi><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>p</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">logp_\theta(\tau)=logp(s_1)+\Sigma log\pi_\theta(a_t|s_t)+logp(s_{t+1}|s_t,a_t) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathrm">Î£</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>å‡è®¾æˆ‘ä»¬æ±‚å¯¼çš„åŒ–ï¼Œé‚£ä¹ˆç›®æ ‡å‡½æ•°æ¢¯åº¦å°±ä¼šå˜æˆ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>J</mi><mo>(</mo><mi>Î¸</mi><mo>)</mo><mo>=</mo><msub><mi>E</mi><mrow><mi>Ï„</mi><mo>âˆ’</mo><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow></msub><mo>[</mo><mo>(</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo><mo>)</mo><mo>(</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mi>r</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">\nabla_\theta J(\theta)=E_{\tau-p_\theta(\tau)}[(\Sigma_{t=1}^T \nabla_\theta log \pi_\theta(a_t|s_t))(\Sigma_{t=1}^T r(s_t,a_t))] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.2465309999999998em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>Stop to think : just like before we <strong>evaluated our reinforcement learning objective</strong> by <strong>generating samples</strong> by actually running our policy in the world to <strong>get an estimate of an exception</strong></p><p>è¿™æ ·æƒ…å†µä¸‹æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°é‡‡æ ·çš„åçš„æ¢¯åº¦è®¡ç®—ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>J</mi><mo>(</mo><mi>Î¸</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo><mo>]</mo><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">\nabla_\theta J(\theta)=\frac{1}{N}\Sigma_{i=1}^N[\Sigma_{t=1}^T \nabla_\theta log \pi_\theta(a_{i,t}|s_{i,t})][\Sigma_{t=1}^T r(s_{i,t},a_{i,t})] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>è™½ç„¶æˆ‘ä»¬æˆåŠŸå¾—åˆ°äº†ï¼Œæˆ‘ä»¬å¦‚ä½•ä»é‡‡æ ·ç»“æœä¸­å¾—åˆ°å¦‚ä½•è®¡ç®—æ¢¯åº¦ï¼›ä½†æ˜¯æˆ‘ä»¬éœ€è¦å¯¹åˆ†æå®ƒå…·ä½“çš„å«ä¹‰ã€‚</p><h3 id="12-ç†è§£pgå«ä¹‰"><a class="markdownIt-Anchor" href="#12-ç†è§£pgå«ä¹‰"></a> 1.2 ç†è§£PGå«ä¹‰</h3><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æŸå¤±å‡½æ•°å†…éƒ¨ä¸»è¦æœ‰ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯æœ‰æ¢¯åº¦çš„ä¸œè¥¿ï¼Œç¬¬äºŒéƒ¨ä»½æ˜¯å¥–åŠ±çš„æ±‚å’Œï¼›é‚£ä¹ˆå¯¹äºä¸¤é¡¹åˆ†åˆ«åˆ†æï¼Œå¯ä»¥å‘ç°ç¬¬ä¸€éƒ¨åˆ†æ¢¯åº¦ä¸ç®€å•çš„MLEç±»ä¼¼ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥çš„æ¢¯åº¦ä¸‹é™ï¼Œä½†æ˜¯ç”±äºæœ‰å¥–åŠ±çš„åŠ æƒï¼Œå¯¼è‡´æˆ‘ä»¬çš„ç»“æœæ˜¯ï¼š</p><p>good stuff is made more likely;bad stuff is made less likelyï¼ˆå¢åŠ å¥½çš„å¯èƒ½æ€§ï¼Œé™ä½åçš„å¯èƒ½æ€§ï¼‰ï¼Œä¹Ÿæ ‡è®°ä¸ºâ€œtrial and errorâ€</p><p>å¯¹äºä¸­é—´çš„ä¸€é¡¹ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\nabla_\theta log \pi_\theta(a_{i,t}|s_{i,t})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span>,å‡è®¾æˆ‘ä»¬ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œæ¥è¿›è¡Œæ‹Ÿåˆï¼Œå‡å¦‚é‡‡ç”¨Gaussian policiesï¼›ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„æ¨¡å‹å‡è®¾æ˜¯</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><mi>N</mi><mo>(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo><mo separator="true">;</mo><mi mathvariant="normal">Î£</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">log\pi_\theta(a_t|s_t)=N(model(s_t);\Sigma) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mord mathit">o</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mpunct">;</span><span class="mord mathrm">Î£</span><span class="mclose">)</span></span></span></span></span></p><p>é‚£ä¹ˆæˆ‘ä»¬çš„æŸå¤±å‡½æ•°ï¼Œæ ¹æ®MLEè‡ªç„¶è€Œç„¶å°±å¯ä»¥å¾—åˆ°(å‚è€ƒlinear regressionï¼‰</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>J</mi><mo>(</mo><mi>Î¸</mi><mo>)</mo><mo>=</mo><mo>âˆ’</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><msup><mi mathvariant="normal">Î£</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo><mo>âˆ’</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mfrac><mrow><mi>d</mi><mi>f</mi></mrow><mrow><mi>d</mi><mi>Î¸</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\nabla_\theta J(\theta)=-\frac{1}{2}\Sigma^{-1}(model(s_t)-a_t)\frac{df}{d\theta} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">âˆ’</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">m</span><span class="mord mathit">o</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p><p>è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°æˆ‘ä»¬çš„REINFORCEMENT algorithmï¼›è¿™é‡Œç¼©å†™æ˜¯é’ˆå¯¹ï¼šREward Increments=nonnegative Factor<em>Offset Reinforcement</em> Characteristic+Eligibility</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ikgfpgx7j30ns0co0u8.jpg" alt="image-20221026121451902" /></p><p>ä½†æ˜¯PGçš„é—®é¢˜åœ¨äºï¼š</p><ol><li>æˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨partial observationï¼Œä¹Ÿå°±æ˜¯oä¸ç­‰äºsæƒ…å†µä¸‹ä½¿ç”¨ï¼Ÿ</li><li>å…·æœ‰å¾ˆå¤§çš„æ–¹å·®ï¼Œå¯¹äºä¸åŒçš„rewardå–å€¼ç»“æœå¤§ä¸ç›¸åŒã€‚<ol><li>exampleï¼šå‡è®¾N=3ï¼›å…¶ä¸­æ€»çš„å¥–åŠ±åˆ†ä¸ºä¸ï¼ˆä¸€è´Ÿï¼Œä¸¤æ­£ï¼‰ï¼Œé‚£ä¹ˆæ›´æ–°åçš„ç­–ç•¥ä¼šåå‘äºå³è¾¹ï¼Œå‡å¦‚æ˜¯åŠ ä¸Šconstantï¼ˆä¸‰æ­£ï¼‰ï¼Œé‚£ä¹ˆæ›´æ–°çš„ç­–ç•¥ä¼šæ¯”åå‘ä¸­é—´ã€‚è¿™ç§ä¸ç¡®å®šæ€§å¯¼è‡´æœ€ç»ˆç»“æœçš„æ–¹å·®åå¤§</li></ol></li></ol><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ikglnmtcj312o0fat9v.jpg" alt="image-20221026121503952" /></p><h2 id="0x02-å¦‚ä½•é™ä½æ–¹å·®ä¸€causality"><a class="markdownIt-Anchor" href="#0x02-å¦‚ä½•é™ä½æ–¹å·®ä¸€causality"></a> 0x02 å¦‚ä½•é™ä½æ–¹å·®ä¸€ï¼šCausality</h2><p>åœ¨æœªæ¥å‘ç”Ÿçš„äº‹æƒ…å¹¶ä¸ä¼šå¯¹ç°åœ¨çš„äº‹æƒ…é€ æˆå½±å“ï¼ˆpolicy at time b cannot affect reward at time a when a&lt;bï¼‰,å› æ­¤åœ¨tä¹‹å‰çš„æ¢¯åº¦ä¸ä¼šå¯¹åé¢é€ æˆå½±å“</p><p>æ‰€ä»¥æˆ‘ä»¬çš„æ¢¯åº¦éœ€è¦ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>J</mi><mo>(</mo><mi>Î¸</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo><mo>]</mo><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">\nabla_\theta J(\theta)=\frac{1}{N}\Sigma_{i=1}^N[\Sigma_{t=1}^T \nabla_\theta log \pi_\theta(a_{i,t}|s_{i,t})][\Sigma_{i=1}^T r(s_{i,t},a_{i,t})] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>å˜æˆï¼›æ³¨æ„åé¢è®¡ç®—å¥–åŠ±çš„ä¸‹æ ‡ï¼æœ‰æ•ˆçš„è¯æ˜è¿‡ç¨‹å¯èƒ½éœ€è¦åœ¨paperä¸­æ‰èƒ½çœ‹åˆ°</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>J</mi><mo>(</mo><mi>Î¸</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo><mo>]</mo><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></msubsup><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">\nabla_\theta J(\theta)=\frac{1}{N}\Sigma_{i=1}^N[\Sigma_{t=1}^T \nabla_\theta log \pi_\theta(a_{i,t}|s_{i,t})][\Sigma_{t&#x27;=t}^T r(s_{i,t&#x27;},a_{i,t&#x27;})] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>é€šå¸¸çš„æˆ‘ä»¬ä¼šå°†åé¢çš„è®°ä¸ºï¼šreward to goï¼š</p>ï¼ˆreward\ to\ go) \hat Q_{i,t}=\Sigma_{t'=t}^Tr(s_{i,t'},a_{i,t'}) <h2 id="0x03-å¦‚ä½•é™ä½å‘å·®äºŒbaselines"><a class="markdownIt-Anchor" href="#0x03-å¦‚ä½•é™ä½å‘å·®äºŒbaselines"></a> 0x03 å¦‚ä½•é™ä½å‘å·®äºŒï¼šBaselines</h2><p>é¦–å…ˆç›´è§‰çš„æ„Ÿå—ä¸åŒrewardçš„å½±å“ï¼Œè¿˜æ˜¯ä¹‹å‰çš„ä¾‹å­ï¼Œå¦‚æœreward=(-1,2,2)å’Œï¼ˆ1ï¼Œ4ï¼Œ4ï¼‰æˆ–è€…æ˜¯ï¼ˆ10000ï¼Œ10005ï¼Œ10005ï¼‰è¿™æ ·è®¡ç®—çš„ç»“æœé€šå¸¸æ˜¯ä¸ä¸€æ ·çš„ã€‚æˆ‘ä»¬éœ€è¦åœ¨å…¶ä¸­å‡å»ä¸€ä¸ªbaselineï¼Œç›¸å½“äºunbiased in expectationï¼Œå¾ˆç›´è§‚çš„æˆ‘ä»¬æ˜¯å‡å»å¥–åŠ±çš„å¹³å‡å€¼ï¼Œæ³¨æ„ï¼ï¼å¹³å‡å€¼ä¸ä¸€å®šæ˜¯æœ€å¥½çš„</p>\nabla_\theta J(\theta)=\int p_\theta(\tau)*\nabla_\theta logp_\theta(\tau)*(r(\tau)-b)d\tau\\ <p>å¯ä»¥ç®€å•çš„è¯æ˜å‡å»ä¸€ä¸ªbaselineä¸ä¼šå¯¹æ¢¯åº¦é€ æˆå½±å“ï¼Œä½†æ˜¯ä¼šå¯¹æ¢¯åº¦å˜åŒ–ç¨‹åº¦é€ æˆå½±å“</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mo>[</mo><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo><mi>b</mi><mo>]</mo><mo>=</mo><mi>b</mi><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mo>âˆ«</mo><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo><mi>d</mi><mi>Ï„</mi><mo>=</mo><mi>b</mi><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mo>âˆ—</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">E[\nabla_\theta logp_\theta(\tau)b]=b\nabla_\theta \int p_\theta(\tau)d \tau=b\nabla_\theta*1=0 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36em;"></span><span class="strut bottom" style="height:2.22225em;vertical-align:-0.86225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mord mathit">b</span><span class="mclose">]</span><span class="mrel">=</span><span class="mord mathit">b</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="op-symbol large-op mop" style="margin-right:0.44445em;top:-0.0011249999999999316em;">âˆ«</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mrel">=</span><span class="mord mathit">b</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ—</span><span class="mord mathrm">1</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span></span></p><p>é™¤å»å¹³å‡å€¼ï¼Œæˆ‘ä»¬ä¼šé‡‡å–ä»€ä¹ˆbaselineæ¥è®¡ç®—ï¼Ÿæˆ‘ä»¬çš„ç›®æ ‡æ˜¯é™ä½æ¨¡å‹çš„æ–¹å·®ï¼Œé‚£ä¹ˆæœ€å¥½çš„baselineå°±æ˜¯è®©æ¨¡å‹æ–¹å·®æœ€ä½çš„ï¼Œæ ¹æ®æ–¹å·®è®¡ç®—</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo>[</mo><mi>X</mi><mo>]</mo><mo>=</mo><mi>E</mi><mo>[</mo><msup><mi>X</mi><mn>2</mn></msup><mo>]</mo><mo>âˆ’</mo><mi>E</mi><mo>[</mo><mi>X</mi><msup><mo>]</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">Var[X]=E[X^2]-E[X]^2 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8641079999999999em;"></span><span class="strut bottom" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mclose">]</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">]</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">]</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><p>é‚£ä¹ˆ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo>=</mo><mi>E</mi><mo>[</mo><mo>(</mo><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>âˆ—</mo><mo>(</mo><mi>r</mi><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>âˆ’</mo><mi>b</mi><mo>)</mo><msup><mo>)</mo><mn>2</mn></msup><mo>]</mo><mo>âˆ’</mo><msup><mi>E</mi><mn>2</mn></msup><mo>[</mo><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>âˆ—</mo><mo>(</mo><mi>r</mi><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>âˆ’</mo><mi>b</mi><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">Var=E[(\nabla_\theta logp_\theta(\tau)*(r(\tau)-b))^2]-E^2[\nabla_\theta logp_\theta(\tau)*(r(\tau)-b)] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8641079999999999em;"></span><span class="strut bottom" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mbin">âˆ—</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">]</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mbin">âˆ—</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>ç›´æ¥å¯¹æ–¹å·®Varçš„biasæ±‚å¯¼</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>V</mi><mi>a</mi><mi>r</mi></mrow><mrow><mi>d</mi><mi>b</mi></mrow></mfrac><mo>=</mo><mo>âˆ’</mo><mn>2</mn><mi>E</mi><mo>[</mo><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><msup><mo>)</mo><mn>2</mn></msup><mo>âˆ—</mo><mi>r</mi><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>]</mo><mo>+</mo><mn>2</mn><mi>b</mi><mi>E</mi><mo>[</mo><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><msup><mo>)</mo><mn>2</mn></msup><mo>]</mo></mrow><annotation encoding="application/x-tex">\frac{dVar}{db}=-2E[\nabla_\theta logp_\theta(\tau)^2*r(\tau)]+2bE[\nabla_\theta logp_\theta(\tau)^2] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">b</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord">âˆ’</span><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ—</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mclose">]</span><span class="mbin">+</span><span class="mord mathrm">2</span><span class="mord mathit">b</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">]</span></span></span></span></span></p><p>è¿™æ ·å°±å¯ä»¥å¾—åˆ°æœ€å¥½çš„bå€¼ï¼Œä½†æ˜¯é€šå¸¸åœ¨å®è·µä¸­å¾ˆéš¾è®¡ç®—ï¼Œæ‰€ä»¥è¿˜å›ä¹‹å¥½ç”¨</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>=</mo><mfrac><mrow><mi>E</mi><mo>[</mo><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><msup><mo>)</mo><mn>2</mn></msup><mo>âˆ—</mo><mi>r</mi><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>]</mo></mrow><mrow><mi>E</mi><mo>[</mo><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><msup><mo>)</mo><mn>2</mn></msup><mo>]</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">b=\frac{E[\nabla_\theta logp_\theta(\tau)^2*r(\tau)]}{E[\nabla_\theta logp_\theta(\tau)^2]} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.491108em;"></span><span class="strut bottom" style="height:2.427108em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">b</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">]</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ—</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p><h2 id="0x04-off-policy-policy-gradient"><a class="markdownIt-Anchor" href="#0x04-off-policy-policy-gradient"></a> 0x04 Off-policy Policy gradient</h2><p>æˆ‘ä»¬åœ¨ä¹‹å‰çš„è®¨è®ºä¸­å¾—åˆ°æœ€ç»ˆçš„æ¢¯åº¦ç†è®ºå…¬å¼å’Œé‡‡æ ·å…¬å¼ï¼Œä½†æ˜¯æˆ‘ä»¬ä»”ç»†æ€è€ƒè¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦ç¬¬iæ¬¡é‡‡æ ·å¾—åˆ°å®Œæ•´<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Ï„</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\tau_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>ä¹‹åæ‰èƒ½åˆ©ç”¨æ¢¯åº¦æå‡æ›´æ–°policyï¼Œè¿™æ ·å¯¹äºæ¯æ¬¡policyåªæ˜¯ç®€å•çš„æ›´æ–°ä¸€æ¬¡æ¢¯åº¦ï¼›è¿™æ ·çš„ç»“æœå°±æ˜¯é‡‡æ ·æ•ˆç‡éå¸¸ä½ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ikgwr1kuj30ri09o74z.jpg" alt="image-20221026121521658" /></p><p>å¯ä»¥ç®€å•çš„å¼•å…¥ important samplingï¼›æ¥å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¶ç†è®ºè¿‡ç¨‹æ˜¯è¿™æ ·çš„</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mrow><mi>x</mi><mo>âˆ’</mo><mi>p</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></msub><mo>[</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>]</mo><mo>=</mo><mo>âˆ«</mo><mi>p</mi><mo>(</mo><mi>x</mi><mo>)</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mi>d</mi><mi>x</mi><mo>=</mo><msub><mi>E</mi><mrow><mi>x</mi><mo>âˆ’</mo><mi>q</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></msub><mo>[</mo><mfrac><mrow><mi>p</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mrow><mi>q</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mfrac><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">E_{x-p(x)}[f(x)]=\int p(x)f(x)dx=E_{x-q(x)}[\frac{p(x)}{q(x)}f(x)] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.363em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">x</span><span class="mbin">âˆ’</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">]</span><span class="mrel">=</span><span class="op-symbol large-op mop" style="margin-right:0.44445em;top:-0.0011249999999999316em;">âˆ«</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord mathit">x</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">x</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>è¿™æ ·çš„å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ™ºèƒ½ä½“æ—§ç­–ç•¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p_\theta(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span> æ¥æ›´æ–°ç­–ç•¥æ¢¯åº¦çš„å€¼,å¾—åˆ°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p_{\theta&#x27;}(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span>,ä¹Ÿå°±æ˜¯ç›®æ ‡å‡½æ•°ä¼šå˜æˆ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mo>(</mo><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo><mo>=</mo><msub><mi>E</mi><mrow><mi>Ï„</mi><mo>âˆ’</mo><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow></msub><mo>[</mo><mfrac><mrow><msub><mi>p</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow><mrow><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow></mfrac><mo>(</mo><mi>r</mi><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>âˆ’</mo><mi>b</mi><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">J(\theta&#x27;)=E_{\tau-p_\theta(\tau)}[\frac{p_{\theta&#x27;}(\tau)}{p_\theta(\tau)}(r(\tau)-b)] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.363em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>ä¹‹é—´çš„æ¯”å€¼å¯ä»¥å±•å¼€å¾—åˆ°</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><msub><mi>p</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow><mrow><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>p</mi><mo>(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>)</mo><mo>âˆ</mo><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo><mi>p</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow><mrow><mi>p</mi><mo>(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>)</mo><mo>âˆ</mo><msub><mi>Ï€</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo><mi>p</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>âˆ</mo><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo></mrow><mrow><mo>âˆ</mo><msub><mi>Ï€</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{p_{\theta&#x27;}(\tau)}{p_\theta(\tau)}=\frac{p(s_1)\prod\pi_\theta(a_t|s_t)p(s_{t+1}|s_t,a_t)}{p(s_1)\prod \pi_{\theta&#x27;}(a_t|s_t)p(s_{t+1}|s_t,a_t)}=\frac{\prod \pi_\theta(a_t|s_t)}{\prod\pi_{\theta&#x27;}(a_t|s_t)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.36301em;vertical-align:-0.93601em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p><p>å› æ­¤å¯ä»¥å¾—åˆ° Important samplingä¸‹çš„ç›®æ ‡å‡½æ•°çš„æœŸæœ›</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi>J</mi><mo>(</mo><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo><mo>=</mo><msub><mi>E</mi><mrow><mi>Ï„</mi><mo>âˆ’</mo><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow></msub><mo>[</mo><mfrac><mrow><msub><mi>p</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow><mrow><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow></mfrac><msub><mi mathvariant="normal">âˆ‡</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>(</mo><mi>r</mi><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>âˆ’</mo><mi>b</mi><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">\nabla_{\theta&#x27;} J(\theta&#x27;)=E_{\tau-p_\theta(\tau)}[\frac{p_{\theta&#x27;}(\tau)}{p_\theta(\tau)}\nabla_{\theta&#x27;}log\pi_{\theta&#x27;}(\tau)(r(\tau)-b)] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.363em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi>J</mi><mo>(</mo><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo><mo>=</mo><msub><mi>E</mi><mrow><mi>Ï„</mi><mo>âˆ’</mo><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow></msub><mo>[</mo><mfrac><mrow><mo>âˆ</mo><msub><mi>Ï€</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi mathvariant="normal">âˆ£</mi><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo></mrow><mrow><mo>âˆ</mo><msub><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo></mrow></mfrac><msub><mi mathvariant="normal">âˆ‡</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>(</mo><mi>r</mi><mo>(</mo><mi>Ï„</mi><mo>)</mo><mo>âˆ’</mo><mi>b</mi><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">\nabla_{\theta&#x27;} J(\theta&#x27;)=E_{\tau-p_\theta(\tau)}[\frac{\prod \pi_{\theta&#x27;}|(a_t|s_t)}{\prod\pi_{\theta}(a_t|s_t)}\nabla_{\theta&#x27;}log\pi_{\theta&#x27;}(\tau)(r(\tau)-b)] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.36301em;vertical-align:-0.93601em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>ç»§ç»­æˆ‘ä»¬ä¹‹å‰çš„causalityçš„è¯´æ˜ï¼Œæ‰€ä»¥é‡‡æ ·æƒ…å†µä¸‹ä¸Šé¢å±•å¼€å¾—åˆ°</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi>J</mi><mo>(</mo><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo><mo>=</mo><msub><mi>E</mi><mrow><mi>Ï„</mi><mo>âˆ’</mo><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow></msub><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">âˆ‡</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo><mo>(</mo><mo>âˆ</mo><mo>âˆ—</mo><msup><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msup><mfrac><mrow><mi>Ï€</mi><mo>âˆ—</mo><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mi mathvariant="normal">âˆ£</mi><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow><mrow><msub><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mi mathvariant="normal">âˆ£</mi><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow></mfrac><mo>)</mo><mo>(</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></msubsup><mo>(</mo><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>âˆ’</mo><mi>b</mi><mo>)</mo><mo>(</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi></mrow><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msubsup><mo>âˆ</mo><mo>âˆ—</mo><msup><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msup><mfrac><mrow><mi>Ï€</mi><mo>âˆ—</mo><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi><mi mathvariant="normal">â€²</mi></mrow></msubsup><mi mathvariant="normal">âˆ£</mi><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow><mrow><msub><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi><mi mathvariant="normal">â€²</mi></mrow></msubsup><mi mathvariant="normal">âˆ£</mi><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow></mfrac><mo>)</mo><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">\nabla_{\theta&#x27;} J(\theta&#x27;)=E_{\tau-p_\theta(\tau)}[\Sigma_{t=1}^T \nabla_{\theta&#x27;}log\pi_{\theta&#x27;}(a_t|s_t)(\prod *{t&#x27;=1}^T\frac{\pi*{\theta&#x27;}(a_t&#x27;|s_t&#x27;)}{\pi_{\theta}(a_t&#x27;|s_t&#x27;)})(\Sigma_{t&#x27;=t}^T(r(s_{t&#x27;},a_{t&#x27;}-b)(\Sigma_{t&#x27;&#x27;=t}^{t&#x27;}\prod *{t&#x27;=1}^T\frac{\pi*{\theta&#x27;}(a_t&#x27;&#x27;|s_t&#x27;&#x27;)}{\pi_{\theta}(a_t&#x27;&#x27;|s_t&#x27;&#x27;)}))] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.428892em;"></span><span class="strut bottom" style="height:2.364892em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="op-symbol large-op mop" style="top:-0.000004999999999977245em;">âˆ</span><span class="mord">âˆ—</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span><span class="vlist"><span style="top:-0.41589200000000004em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mbin">âˆ—</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="op-symbol large-op mop" style="top:-0.000004999999999977245em;">âˆ</span><span class="mord">âˆ—</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span><span class="vlist"><span style="top:-0.41589200000000004em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mbin">âˆ—</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>é€šå¸¸reward to goé‡Œçš„åˆ†å¸ƒä¼šåˆ æ‰ï¼Œå› æ­¤ä¸å½±å“ç»“æœï¼ˆpaperä¸­æœ‰ï¼‰</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi></mrow><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msubsup><mo>âˆ</mo><mo>âˆ—</mo><msup><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msup><mfrac><mrow><mi>Ï€</mi><mo>âˆ—</mo><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi><mi mathvariant="normal">â€²</mi></mrow></msubsup><mi mathvariant="normal">âˆ£</mi><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow><mrow><msub><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi><mi mathvariant="normal">â€²</mi></mrow></msubsup><mi mathvariant="normal">âˆ£</mi><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow></mfrac><mo>)</mo></mrow><annotation encoding="application/x-tex">(\Sigma_{t&#x27;&#x27;=t}^{t&#x27;}\prod *{t&#x27;=1}^T\frac{\pi*{\theta&#x27;}(a_t&#x27;&#x27;|s_t&#x27;&#x27;)}{\pi_{\theta}(a_t&#x27;&#x27;|s_t&#x27;&#x27;)}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.428892em;"></span><span class="strut bottom" style="height:2.364892em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="op-symbol large-op mop" style="top:-0.000004999999999977245em;">âˆ</span><span class="mord">âˆ—</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span><span class="vlist"><span style="top:-0.41589200000000004em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mbin">âˆ—</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p><p>åŒæ—¶å¯ä»¥æ”¹å˜ç­–ç•¥çš„æ¯”å€¼ï¼Œè¿™ä¸ªåœ¨ä¹‹åè¯¾ç¨‹ä¸­ä¼šè®²åˆ°,è¿™é‡Œé‡‡ç”¨first- order approximationï¼Œ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>âˆ</mo><mo>âˆ—</mo><msup><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msup><mfrac><mrow><mi>Ï€</mi><mo>âˆ—</mo><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo></mrow><mrow><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo></mrow></mfrac><mfrac><mrow><msub><mi>Ï€</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mi mathvariant="normal">âˆ£</mi><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow><mrow><msub><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mi mathvariant="normal">âˆ£</mi><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow></mfrac><mo>=</mo><mo>âˆ</mo><mo>âˆ—</mo><msup><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msup><mfrac><mrow><mi>Ï€</mi><mo>âˆ—</mo><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow><mo>(</mo><msub><mi>a</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow><mrow><msub><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\prod *{t&#x27;=1}^T\frac{\pi*{\theta&#x27;}(s_{i,t})}{\pi_\theta(s_{i,t})}\frac{\pi_{\theta&#x27;}(a_t&#x27;|s_t&#x27;)}{\pi_{\theta}(a_t&#x27;|s_t&#x27;)}=\prod *{t&#x27;=1}^T\frac{\pi*{\theta&#x27;}(a_{t&#x27;},s_t&#x27;)}{\pi_{\theta}(a_t&#x27;,s_t&#x27;)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.428892em;"></span><span class="strut bottom" style="height:2.401em;vertical-align:-0.972108em;"></span><span class="base displaystyle textstyle uncramped"><span class="op-symbol large-op mop" style="top:-0.000004999999999977245em;">âˆ</span><span class="mord">âˆ—</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span><span class="vlist"><span style="top:-0.41589200000000004em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mbin">âˆ—</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="op-symbol large-op mop" style="top:-0.000004999999999977245em;">âˆ</span><span class="mord">âˆ—</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span><span class="vlist"><span style="top:-0.41589200000000004em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mbin">âˆ—</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p><p>å› æ­¤å¾—åˆ°Off-Policy Policy gradient with important samplingçš„ç›®æ ‡å‡½æ•°æ¢¯åº¦ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi>J</mi><mo>(</mo><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">âˆ‡</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo><mo>(</mo><mo>âˆ</mo><mo>âˆ—</mo><msup><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msup><mfrac><mrow><mi>Ï€</mi><mo>âˆ—</mo><mrow><msup><mi>Î¸</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow><mo>(</mo><msub><mi>a</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow><mrow><msub><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>s</mi><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo>)</mo></mrow></mfrac><mo>)</mo><msub><mover accent="true"><mi>Q</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>]</mo></mrow><annotation encoding="application/x-tex">\nabla_{\theta&#x27;} J(\theta&#x27;)=\frac{1}{N}\Sigma_{i=1}^N[\Sigma_{t=1}^T \nabla_{\theta&#x27;}log\pi_{\theta&#x27;}(a_t|s_t)(\prod *{t&#x27;=1}^T\frac{\pi*{\theta&#x27;}(a_{t&#x27;},s_t&#x27;)}{\pi_{\theta}(a_t&#x27;,s_t&#x27;)}) \hat Q_{i,t}] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.428892em;"></span><span class="strut bottom" style="height:2.364892em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="op-symbol large-op mop" style="top:-0.000004999999999977245em;">âˆ</span><span class="mord">âˆ—</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span><span class="vlist"><span style="top:-0.41589200000000004em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mbin">âˆ—</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit">Q</span></span><span style="top:-0.25233em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">]</span></span></span></span></span></p><p>ä½œä¸ºå¯¹æ¯”ä¹‹å‰çš„on- policy gradientæ˜¯ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>J</mi><mo>(</mo><mi>Î¸</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">âˆ‡</mi><mi>Î¸</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>)</mo><mo>]</mo><msub><mover accent="true"><mi>Q</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\nabla_\theta J(\theta)=\frac{1}{N}\Sigma_{i=1}^N[\Sigma_{t=1}^T \nabla_\theta log \pi_\theta(a_{i,t}|s_{i,t})]\hat Q_{i,t} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit">Q</span></span><span style="top:-0.25233em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><h2 id="0x05-ä»£ç å®ç°"><a class="markdownIt-Anchor" href="#0x05-ä»£ç å®ç°"></a> 0x05 ä»£ç å®ç°</h2><p>å‚è€ƒ<a href="https://hrl.boyuai.com/chapter/2/%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6%E7%AE%97%E6%B3%95">ã€ŠåŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ã€‹</a></p><p>é¦–å…ˆå‡ ä¸ªæœ‰è¶£çš„å‘ç°</p><ol><li>åœ¨CartPole-v0æˆåŠŸçš„ä¸ä¸€å®šèƒ½åœ¨MountainCar-v0ä¸­å®ç°ï¼Œè¿™ä¸ªä¸å¥–åŠ±å‡½æ•°çš„è®¾ç½®å…³ç³»å¾ˆå¤§ï¼ˆå°è½¦æ²¡æœ‰ä¸Šå±±ä¹‹å‰éƒ½æ˜¯-1ï¼Œè¢«æ‰“å‡»åˆ°äº†ï¼‰</li><li>ä¸åŒçš„è¶…å‚æ•°å¯¹æœ€ç»ˆç»“æœå½±å“å¾ˆå¤§</li><li>æ¨èä½¿ç”¨GYM 0.21ç‰ˆæœ¬ï¼›æœ€æ–°ç‰ˆæœ¬æ€»ä¼šå‡ºé—®é¢˜</li></ol><h3 id="51-ç¯å¢ƒæ­å»º"><a class="markdownIt-Anchor" href="#51-ç¯å¢ƒæ­å»º"></a> 5.1 ç¯å¢ƒæ­å»º</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section">## ç¯å¢ƒè¯´æ˜ï¼šCartpole-v0 </span><br>æˆ‘ä»¬é‡‡ç”¨çš„æµ‹è¯•ç¯å¢ƒæ˜¯ CartPole-v0ï¼Œå…¶çŠ¶æ€ç©ºé—´ç›¸å¯¹ç®€å•ï¼Œåªæœ‰ 4 ä¸ªå˜é‡ï¼Œå› æ­¤ç½‘ç»œç»“æ„<br>çš„è®¾è®¡ä¹Ÿç›¸å¯¹ç®€å•ï¼šé‡‡ç”¨ä¸€å±‚ 128 ä¸ªç¥ç»å…ƒçš„å…¨è¿æ¥å¹¶ä»¥ ReLU ä½œä¸ºæ¿€æ´»å‡½æ•°ã€‚å½“é‡åˆ°æ›´å¤<br>æ‚çš„è¯¸å¦‚ä»¥å›¾åƒä½œä¸ºè¾“å…¥çš„ç¯å¢ƒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘é‡‡ç”¨æ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œã€‚<br><span class="hljs-section"># å¼•å…¥ä¸€äº›åŒ…</span><br>from pyvirtualdisplay import Display<br>display = Display(visible=0, size=(1400, 900))<br>display.start()<br><br>import matplotlib.pyplot as plt<br>from IPython import display<br>import time<br>from IPython import display<br>from PIL import Image<br>import gym<br>import torch<br>import torch.nn.functional as F<br>import numpy as np<br>import matplotlib.pyplot as plt<br>from tqdm import tqdm<br></code></pre></td></tr></table></figure><h3 id="52-å®šä¹‰policy-net"><a class="markdownIt-Anchor" href="#52-å®šä¹‰policy-net"></a> 5.2 å®šä¹‰Policy net</h3><p>è¾“å…¥æ˜¯stateï¼Œè¾“å‡ºæ˜¯actionã€‚éšä¾¿ä¸€ä¸ªæµ…å±‚MLPå°±å¤Ÿäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PolicyNet</span>(torch.nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,state_dim,hidden_dim,action_dim</span>):<br>        <span class="hljs-built_in">super</span>(PolicyNet,self).__init__()<br>        self.fc1=torch.nn.Linear(state_dim,hidden_dim)<br>        self.fc2=torch.nn.Linear(hidden_dim,action_dim)<br>        <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> self.modules():<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(m, torch.nn.Linear):<br>                torch.nn.init.normal_(m.weight, std=<span class="hljs-number">0.01</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self,x</span>):<br>        x=F.relu(self.fc1(x))<br>        <span class="hljs-keyword">return</span> F.softmax(self.fc2(x),dim=<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><h3 id="53-å®šä¹‰ç®—æ³•"><a class="markdownIt-Anchor" href="#53-å®šä¹‰ç®—æ³•"></a> 5.3 å®šä¹‰ç®—æ³•</h3><p>ä¸‰æ­¥ï¼Œé¦–å…ˆsample generationã€ç„¶åpolicy evaluateï¼Œä¹‹åæ˜¯improve policy</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> traitlets <span class="hljs-keyword">import</span> observe<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">REINFORCE</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,state_dim,hidden_dim,action_dim,learning_rate,gamma,device</span>):<br>        self.policy_net=PolicyNet(state_dim,hidden_dim,action_dim).to(device)<br>        self.optimizer=torch.optim.Adam(self.policy_net.parameters(),lr=learning_rate)<br>        self.gamma=gamma<br>        self.device=device<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">take_action</span>(<span class="hljs-params">self,state</span>):<br>        <span class="hljs-comment"># æ ¹æ®åŠ¨ä½œæ¦‚ç‡åˆ†å¸ƒéšæœºé‡‡æ ·</span><br>        state=torch.tensor([state],dtype=torch.<span class="hljs-built_in">float</span>).to(self.device)<br>        probs=self.policy_net(state)<br>        action_dist=torch.distributions.Categorical(probs)<br>        action=action_dist.sample()<br>        <span class="hljs-keyword">return</span> action.item()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self,transition_dict</span>):<br>        reward_list=transition_dict[<span class="hljs-string">&#x27;rewards&#x27;</span>]<br>        state_list=transition_dict[<span class="hljs-string">&#x27;states&#x27;</span>]<br>        action_list=transition_dict[<span class="hljs-string">&#x27;actions&#x27;</span>]<br><br>        G=<span class="hljs-number">0</span><br>        self.optimizer.zero_grad()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(reward_list))):<br>            <span class="hljs-comment"># ä»æœ€åä¸€æ­¥å¼€å§‹</span><br>            state=torch.tensor([state_list[i]],dtype=torch.<span class="hljs-built_in">float</span>).to(self.device)<br>            reward=reward_list[i]<br>            action=torch.tensor([action_list[i]]).view(-<span class="hljs-number">1</span>,<span class="hljs-number">1</span>).to(self.device)<br>            log_prob=torch.log(self.policy_net(state).gather(<span class="hljs-number">1</span>,action))<br>            G=self.gamma*G+reward<br>            loss=-log_prob*G<br>            loss.backward()<br>        self.optimizer.step()<br></code></pre></td></tr></table></figure><h3 id="53-å¼€å§‹å®éªŒ"><a class="markdownIt-Anchor" href="#53-å¼€å§‹å®éªŒ"></a> 5.3 å¼€å§‹å®éªŒ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python">learning_rate=<span class="hljs-number">0.001</span><br>num_episodes=<span class="hljs-number">1000</span><br>hidden_dim=<span class="hljs-number">128</span><br>gamma=<span class="hljs-number">0.98</span><br>device=torch.device(<span class="hljs-string">&#x27;cuda&#x27;</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;cpu&#x27;</span>)<br>env_name=<span class="hljs-string">&#x27;CartPole-v0&#x27;</span><br><span class="hljs-comment"># env_name=&#x27;MountainCar-v0&#x27;</span><br><span class="hljs-comment"># env_name=&#x27;LunarLander-v2&#x27;</span><br><span class="hljs-comment">## è§‚å¯Ÿç¯å¢ƒ</span><br><br>env=gym.make(env_name)<br>env.seed(<span class="hljs-number">0</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;state:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(env.observation_space.dtype))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;action:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(env.action_space))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;state shape:&#123;&#125;~&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(env.observation_space.low,env.observation_space.high))<br>torch.manual_seed(<span class="hljs-number">0</span>)<br>state_dim=env.observation_space.shape[<span class="hljs-number">0</span>]<br>action_dim=env.action_space.n<br>agent=REINFORCE(state_dim,hidden_dim,action_dim,learning_rate,gamma,device)<br>return_list = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">with</span> tqdm(total=<span class="hljs-built_in">int</span>(num_episodes / <span class="hljs-number">10</span>), desc=<span class="hljs-string">&#x27;Iteration %d&#x27;</span> % i) <span class="hljs-keyword">as</span> pbar:<br>        <span class="hljs-keyword">for</span> i_episode <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(num_episodes / <span class="hljs-number">10</span>)):<br>            episode_return = <span class="hljs-number">0</span><br>            transition_dict = &#123;<br>                <span class="hljs-string">&#x27;states&#x27;</span>: [],<br>                <span class="hljs-string">&#x27;actions&#x27;</span>: [],<br>                <span class="hljs-string">&#x27;next_states&#x27;</span>: [],<br>                <span class="hljs-string">&#x27;rewards&#x27;</span>: [],<br>                <span class="hljs-string">&#x27;dones&#x27;</span>: []<br>            &#125;<br><br>            state = env.reset()<br>            <span class="hljs-comment"># æ¸…é™¤å½“å‰ Cell çš„è¾“å‡º</span><br>            done = <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> done:<br>                action = agent.take_action(state)<br>                next_state, reward, done, _ = env.step(action)<br>                transition_dict[<span class="hljs-string">&#x27;states&#x27;</span>].append(state)<br>                transition_dict[<span class="hljs-string">&#x27;actions&#x27;</span>].append(action)<br>                transition_dict[<span class="hljs-string">&#x27;next_states&#x27;</span>].append(next_state)<br>                <span class="hljs-comment"># special for Mountain</span><br>                <span class="hljs-comment"># reward=(next_state[0]+1)**5</span><br>                <span class="hljs-comment"># if abs(next_state[1])&gt;0.04:</span><br>                <span class="hljs-comment">#     reward+=1</span><br>                transition_dict[<span class="hljs-string">&#x27;rewards&#x27;</span>].append(reward)<br>                transition_dict[<span class="hljs-string">&#x27;dones&#x27;</span>].append(done)<br>                state = next_state<br>                episode_return += reward<br>            return_list.append(episode_return)<br>            agent.update(transition_dict)<br>            <span class="hljs-keyword">if</span> (i_episode + <span class="hljs-number">1</span>) % <span class="hljs-number">10</span> == <span class="hljs-number">0</span>:<br>                pbar.set_postfix(&#123;<br>                    <span class="hljs-string">&#x27;episode&#x27;</span>:<br>                    <span class="hljs-string">&#x27;%d&#x27;</span> % (num_episodes / <span class="hljs-number">10</span> * i + i_episode + <span class="hljs-number">1</span>),<br>                    <span class="hljs-string">&#x27;return&#x27;</span>:<br>                    <span class="hljs-string">&#x27;%.3f&#x27;</span> % np.mean(return_list[-<span class="hljs-number">10</span>:])<br>                &#125;)<br>            pbar.update(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bbba8e21-036e-4367-b445-11be4e03b94b/Untitled.png" alt="Untitled" /></p><p>å‡å¦‚è®¾ç½®ä¸‰å±‚ç½‘ç»œç»“æœæœ‰ç‚¹å¥‡æ€ªï¼Œä½†æ˜¯policyæ˜¯å¥½çš„</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ikhi2wvjj30za0s0tby.jpg" alt="ä¸¤å±‚ç»“æœ" /></p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ikhy1hu7j30xs0roju6.jpg" alt="ä¸‰å±‚ç¥ç»ç½‘ç»œï¼Œä½†æ˜¯policyå¥½çš„" /></p><h3 id="54-è§‚å¯Ÿ"><a class="markdownIt-Anchor" href="#54-è§‚å¯Ÿ"></a> 5.4 è§‚å¯Ÿ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">done = <span class="hljs-literal">False</span><br>state = env.reset()<br>flag=<span class="hljs-number">1</span><br>    <span class="hljs-comment"># é˜²æ­¢åˆ·æ–°è¿‡å¿«</span><br><span class="hljs-keyword">while</span> flag&lt;<span class="hljs-number">100</span>:<br>    action = agent.take_action(state)<br>    next_state, reward, done, _ = env.step(action)<br>    state=next_state<br>    <span class="hljs-comment"># æ¸…é™¤å½“å‰ Cell çš„è¾“å‡º</span><br>    display.clear_output(wait=<span class="hljs-literal">True</span>)<br>    <span class="hljs-comment"># æ¸²æŸ“ç”»é¢ï¼Œå¾—åˆ°ç”»é¢çš„åƒç´ æ•°ç»„</span><br>    rgb_array = env.render(mode=<span class="hljs-string">&#x27;rgb_array&#x27;</span>)<br>    <span class="hljs-comment"># ä½¿ç”¨åƒç´ æ•°ç»„ç”Ÿæˆå›¾ç‰‡</span><br>    img = Image.fromarray(rgb_array)<br>    <span class="hljs-comment"># å½“å‰ Cell ä¸­å±•ç¤ºå›¾ç‰‡</span><br>    display.display(img)<br>    time.sleep(<span class="hljs-number">1</span>/<span class="hljs-number">24</span>)<br>    flag+=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªæ˜¯2å±‚ï¼Œç¬¬äºŒæ˜¯3å±‚</p><p>è§†é¢‘å¯ä»¥çœ‹<a href="https://www.notion.so/clouddirty/Lecture-05-Policy-Gradients-9384f9b7ad1f49d5aa326f66b97f05eb#3d9149bbd9b642ce926f0df2f0bf62f0">https://www.notion.so/clouddirty/Lecture-05-Policy-Gradients-9384f9b7ad1f49d5aa326f66b97f05eb#3d9149bbd9b642ce926f0df2f0bf62f0</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬èŠ‚è¯¾çš„ç›®æ ‡æ˜¯ææ˜ç™½Policy gradientä¸€ç±»çš„REINFORCEMENTæ–¹æ³•ï¼Œå¹¶ä¸”ç†è§£èƒŒåçš„å±€é™æ€§ï¼Œç„¶åçŸ¥é“ä¸ºä»€ä¹ˆtextbookå¾ˆå®¹æ˜“è®²æ¸…æ¥šï¼Œä½†æ˜¯åœ¨å®è·µä¸­ä¸è¡Œçš„åŸå› ã€‚ä¹‹åä»Causalityå’ŒBaselineä¸¤ç§æ–¹æ³•æ¥é™ä½On- policy PGçš„æ–¹å·®ã€‚å¹¶ç»™å‡ºç»“åˆISï¼ˆimportant samplingï¼‰çš„Off policyçš„æ¢¯åº¦æ–¹æ³•ã€‚æœ€ååˆ©ç”¨ä»£ç å®ç°RLé‡Œé¢çš„hello worldâ€”CartPole-v0æ¥å®ç°ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="RL" scheme="https://blog.tjdata.site/categories/RL/"/>
    
    
    <category term="CS285" scheme="https://blog.tjdata.site/tags/CS285/"/>
    
  </entry>
  
  <entry>
    <title>CS285_Lecture04_Introduction_to_Reinforcement_Learning</title>
    <link href="https://blog.tjdata.site/posts/e1096304.html"/>
    <id>https://blog.tjdata.site/posts/e1096304.html</id>
    <published>2022-10-23T11:01:56.000Z</published>
    <updated>2023-05-13T13:48:05.659Z</updated>
    
    <content type="html"><![CDATA[<p>Sergev Levineçš„è¯¾è®²å¼ºåŒ–å­¦ä¹ æˆ‘å”¯ä¸€å¬å¾—æ‡‚ä¸åŒå¼ºåŒ–å­¦ä¹ ç©¶ç«Ÿæœ‰å“ªäº›åˆ†ç±»ï¼ŒåŒæ—¶æ˜¯å¦‚ä½•è¿›è¡Œåˆ†ç±»çš„ã€‚æœ¬æ¬¡Lectureçš„ç›®æ ‡æ˜¯å®Œå–„å®šä¹‰Definitionä¸è®°å·notationï¼Œå¹¶è®¤æ¸…æ¥šRL objectiveï¼Œå¹¶ç»™å‡ºå…·ä½“å¼ºåŒ–å­¦ä¹ ç®—æ³•çš„æ€»ç»“ã€‚</p><span id="more"></span><h2 id="0x01-definition-of-a-mdp"><a class="markdownIt-Anchor" href="#0x01-definition-of-a-mdp"></a> 0x01 Definition of a MDP</h2><h3 id="11-recap-rl-with-imitation-learning"><a class="markdownIt-Anchor" href="#11-recap-rl-with-imitation-learning"></a> 1.1 Recap RL with imitation learning</h3><p>æˆ‘ä»¬åœ¨ä¹‹å‰çš„<a href="https://blog.tjdata.site/posts/7d84bcc6.html">Lecture02-<em><strong>*Supervised_Learning_of_Behavior*</strong></em></a>ä¸­è®¤è¯†äº†Notationï¼Œä»¥åŠimitation learningçš„å±€é™æ€§ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯éœ€è¦ä¸€ä¸ªä¸“å®¶æ™ºèƒ½ä½“æˆ–è€…äººå·¥æ¥æä¾›æ•°æ®ã€‚ä½†æ˜¯æ˜¾ç„¶è¿™æ˜¯ä¸å¯è¡Œçš„ã€‚æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬éœ€è¦è®¤è¯†åˆ°æˆ‘ä»¬çš„ä»»åŠ¡åº”è¯¥æ˜¯ä»€ä¹ˆï¼Ÿæˆ–è®¸æˆ‘ä»¬ä¸çŸ¥é“ä»»åŠ¡å…·ä½“æ ·å­ï¼Œä½†æˆ‘ä»¬çŸ¥é“å®ƒå’Œæˆ‘ä»¬çŠ¶æ€è½¬å˜åºåˆ—ä¸­çš„æ¯ä¸€æ­¥çš„rewardæœ‰å…³ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨æˆ‘ä»¬observation=çœ‹åˆ°çº¢ç¯çš„æƒ…å†µä¸‹ï¼Œaction=åœè½¦å¾€å¾€ä»£è¡¨æ›´é«˜çš„rewardï¼Œå¦‚æœaction=å¼€è½¦é—¯è¿‡äº¤å‰å£å¾€å¾€ä»£è¡¨è´Ÿçš„rewardã€‚</p><h2 id="0x02-definition-of-reinforcement-learning-problem"><a class="markdownIt-Anchor" href="#0x02-definition-of-reinforcement-learning-problem"></a> 0x02 Definition of Reinforcement learning problem</h2><p>åœ¨ä¹‹å‰çš„<a href="https://blog.tjdata.site/posts/3e3a5c92.html">å¼ºåŒ–å­¦ä¹ -åŸºæœ¬æ¦‚å¿µ</a>ä¸­å·²ç»ç»™å‡ºMPã€MDPã€MRPçš„å®šä¹‰ï¼Œè¿™é‡Œç»™å‡ºCS285å®˜æ–¹å¯¹äºMDPå’ŒPOMDPï¼ˆPartial observation MDPï¼Œæš‚æ—¶ä¸è®¨è®ºï¼‰çš„è®°å·</p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ghd1zmu5j312s0i6dhj.jpg" alt="image-20221024165643496" style="zoom:50%;" /><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ghdfylnsj312k0nqn02.jpg" alt="image-20221024165705565" style="zoom:50%;" /><p>åœ¨å¼ºåŒ–å­¦ä¹ è¿‡ç¨‹ä¸­ state-observation- action- stateè½¬å˜ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†ï¼ˆs_1,a_1,...,s_T,a_Tï¼‰æ ‡è®°ä¸ºä¸€ä¸ªtrajectoryï¼Œä¸åŒè½¨è¿¹çš„æ¦‚ç‡å¯ä»¥ç”±ä¸‹å›¾è¡¨ç¤ºï¼›ç”±äºçŠ¶æ€s1æ˜¯éšæœºå˜é‡ï¼Œç­–ç•¥ä¹Ÿä¼šè¾“å‡ºä¸åŒçš„å€¼ï¼Œå› æ­¤è¿™é‡Œé€šå¸¸æ˜¯å…·æœ‰æŒ‡æ•°çš„trajectoryï¼Œå› æ­¤é€šå¸¸åªèƒ½ç”¨é‡‡æ ·çš„æ–¹æ³•æ¥è¿‘ä¼¼çš„æè¿°æ€»ä½“ã€‚</p><p>p_{\theta}(\Tau=\tau)=p(s_1)\prod \limits_{i=0}^T\pi_{\theta}(a_t|s_t)p(s_{t+1}|s_t,a_t)</p><p>å¦‚æœæˆ‘ä»¬çŸ¥é“æ‰€æœ‰å¯èƒ½çš„è½¨è¿¹çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½æ±‚è§£å‡ºæˆ‘ä»¬ç­–ç•¥å¯¹åº”çš„æœŸæœ›;å¾ˆ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mrow><mi>Ï„</mi><mo>âˆ’</mo><msub><mi>p</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow></msub><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></msubsup><mi>r</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">E_{\tau-p_{\theta}(\tau)}[\Sigma _{i=0}^Tr(s_t,a_t)] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.2465309999999998em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>å¾ˆä¸å¹¸çš„æ˜¯ï¼Œåœ¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï„</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span></span></span></span>çš„æ¦‚ç‡åˆ†å¸ƒä¸­ï¼Œæˆ‘ä»¬ä¸çŸ¥é“<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>çš„åˆ†å¸ƒï¼Œä¹Ÿä¸çŸ¥é“çŠ¶æ€è½¬ç§»<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p(s_{t+1}|s_t,a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span>;ä½†æ˜¯æˆ‘ä»¬æƒ³ç¡®å®šçš„æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\pi_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>ï¼›æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€äº›çŸ¥è¯†æ¥åšæ¼”åŒ–ï¼Œæ¯”å¦‚æˆ‘ä»¬çŸ¥é“<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(s_t,a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span>æ˜¯å…·æœ‰MPæ€§è´¨çš„ï¼Œä¹Ÿå°±æ˜¯</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo><mi mathvariant="normal">âˆ£</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>)</mo><mo>=</mo><mi>p</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><msub><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><msub><mi>a</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">p((s_{t+1},a_{t+1})|(s_t,a_t))=p(s_{t+1}|s_t,a_t)\pi_{\theta}(a_{t+1}|s_{t+1})) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathrm">âˆ£</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ghdwn5ixj31380ciwfc.jpg" alt="image-20221024165732870" /></p><p>é‚£ä¹ˆæˆ‘ä»¬çš„å¥–åŠ±æœŸæœ›å°±å¯ä»¥ç­‰ä»·</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>E</mi><mrow><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>âˆ’</mo><msub><mi>p</mi><mrow><mi>Î¸</mi></mrow></msub><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow></msub><mo>[</mo><mi>r</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">\Sigma_{t=1}^TE_{(s_t,a_t)-p_{\theta}(s_t,a_t)}[r(s_t,a_t)] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.2465309999999998em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>å…¶ä¸­çš„<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p_\theta(s_t,a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span>è¡¨ç¤ºä¸ºçŠ¶æ€åŠ¨ä½œçš„è¾¹ç¼˜æ¦‚ç‡åˆ†å¸ƒã€‚</p><p>æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æ‰¾åˆ°å®ƒå…¶ä¸­çš„æœ€å¤§å€¼ï¼ŒåŒæ ·çš„å¯¹äºåœºæ™¯ä¸­æˆ‘ä»¬ä¼šç®€å•çš„åŒºåˆ†ä¸ºæœ‰é™åœºæ™¯ä¸æ— é™åœºæ™¯</p><ol><li><p>infinite horizon caseï¼Œæˆ‘ä»¬éœ€è¦æœ€ç»ˆè¾¾åˆ°ç¨³å®šåˆ†å¸ƒï¼ˆstationary distributionï¼‰ï¼Œä¹Ÿå°±æ˜¯çŠ¶æ€çŠ¶æ€ä¸å‘ç”Ÿæ”¹å˜ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î¼</mi><mo>=</mo><mi>T</mi><mi>Î¼</mi></mrow><annotation encoding="application/x-tex">\mu=T\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Î¼</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathit">Î¼</span></span></span></span>,è¿™æ—¶å€™å®šä¹‰å¹³å‡å›æŠ¥å…¬å¼ï¼ˆæ— æŠ˜æ‰£ï¼‰çš„ç›®æ ‡å‡½æ•°ä¸º 1.</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ghe6yxv0j3130070js3.jpg" alt="image-20221024165749396" /></p></li><li><p>finite horizon case ,æˆ‘ä»¬ä¾æ—§éœ€è¦ state- action marginalæ¥æ±‚è§£</p></li></ol><p>Questionï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æœŸæœ›ï¼Ÿ</p><p>è¯¾ç¨‹ä¸­ç»™å‡ºçš„è§£ç­”æ˜¯åœ¨ç°å®ä¸–ç•Œä¸­çš„æœŸæœ›ä¸è¿ç»­çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡éšæœºæ€§å’ŒæœŸæœ›æˆ‘ä»¬å¯ä»¥å°†å…¶è½¬å˜ç§°ä¸ºè¿ç»­ï¼ˆsmoothï¼‰çš„é—®é¢˜</p><p>PSï¼šä¸ªäººçœ‹æ³•é™¤äº†ä¸Šè¿°ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªåŸå› æ˜¯RLä¸­æˆ‘ä»¬é€šå¸¸å¸Œæœ›ä½¿ç”¨é‡‡æ ·Samplingçš„æ–¹æ³•æ¥è¿›è¡Œæ±‚è§£ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¯èƒ½ç½—åˆ—å‡ºæ‰€æœ‰çš„å¯èƒ½æ€§ï¼Œè€Œé‡‡æ ·æ–¹æ³•å¾—åˆ°çš„å¾€å¾€æ˜¯æœŸæœ›è€Œä¸æ˜¯ç§¯åˆ†å¼ã€‚å› æ­¤åœ¨RLå¥½çš„samplingæ–¹æ³•ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ã€‚å¸¸è§çš„æœ‰åŸºäºé©¬å°”å¯å¤«è’™ç‰¹å¡æ´›MCMCæ–¹æ³•ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šè’™åœ°å¡ç½—ã€é‡è¦æ€§é‡‡æ ·ã€åŸºäºèƒ½é‡é‡‡æ ·ã€Gibbsé‡‡æ ·ç­‰ç­‰å¥‡å¥‡æ€ªæ€ªçš„é‡‡æ ·æ–¹å¼ã€‚</p><h2 id="0x03-anatomy-of-a-rl-algorithm"><a class="markdownIt-Anchor" href="#0x03-anatomy-of-a-rl-algorithm"></a> 0x03 Anatomy of a RL algorithm</h2><p>æˆ‘ä»¬å¯ä»¥å›é¡¾ä¸€ä¸‹ç›‘ç£å­¦ä¹ çš„èŒƒå¼ï¼Œå¯¹äºdatasetï¼Œæˆ‘ä»¬ä¼šæœ‰ä¸€ä¸ªå‡è®¾hypothesisï¼Œä¹‹åæˆ‘ä»¬å¯ä»¥åœ¨datasetä¸­åˆ©ç”¨learning modelæ¥é€šè¿‡lossæ¥optimå‡è®¾ä¸­çš„paramï¼Œç„¶åå¾—åˆ°æˆ‘ä»¬çš„modelï¼Œå¹¶å¯ä»¥evaluateã€‚</p><p>å¼ºåŒ–å­¦ä¹ ä¸­çš„æ–¹å¼åŒ…æ‹¬</p><ol><li>generate sampleï¼Œä¸ç¯å¢ƒäº¤äº’æˆ–è€…æ”¶é›†æ ·æœ¬æ¥å¾—åˆ°åŸºç¡€æ•°æ®</li><li>fit a modelæˆ–è€…estimate the returnï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ‹Ÿåˆä¸€ä¸ªç­–ç•¥ï¼ˆç”¨ç¥ç»ç½‘ç»œï¼‰ï¼›æˆ–è€…è®¡ç®—è½¨è¿¹çš„å¥–åŠ±å€¼ï¼ˆrewardï¼ŸQï¼Ÿvalueï¼Ÿï¼‰æ¥é—´æ¥ååº”å¥½çš„ç­–ç•¥</li><li>improve the policyï¼Œæ— è®ºç¬¬äºŒæ­¥æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯ä»€ä¹ˆæ–¹æ³•ï¼Œæˆ‘ä»¬çš„æœ€ç»ˆç›®çš„æ˜¯éœ€è¦æå‡æˆ‘ä»¬çš„policy</li></ol><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7gheq7pvmj314w0mkwhe.jpg" alt="image-20221024165819656" /></p><h2 id="0x04-brief-overview-of-rl-algorithm-types"><a class="markdownIt-Anchor" href="#0x04-brief-overview-of-rl-algorithm-types"></a> 0x04 Brief overview of RL algorithm types</h2><p>åœ¨step2ä¸­ï¼Œæˆ‘ä»¬å¤©ç„¶çš„å¯ä»¥å°†RLç®—æ³•åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯æ˜¯ç›´æ¥æ‹Ÿåˆpolicyçš„ï¼Œä¸€ç±»æ˜¯æ ¹æ®rewardæ¥é—´æ¥åæ˜ policyçš„å¥½åã€‚ä½†æ˜¯rewardå¹¶ä¸æ˜¯å®¹æ˜“è®¡ç®—çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šæœ‰rewardã€Q- functionæˆ–è€…value - function</p><h3 id="41-å…³äºè¯„ä»·policyçš„å¥½å"><a class="markdownIt-Anchor" href="#41-å…³äºè¯„ä»·policyçš„å¥½å"></a> 4.1 å…³äºè¯„ä»·Policyçš„å¥½å</h3><p>æœ€ç›´æ¥çš„æˆ‘ä»¬åœ¨0x02ä¸­å·²ç»å®šä¹‰å¥½äº†ï¼Œæˆ‘ä»¬æ¥å±•å¼€è®¡ç®—å®ƒï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mrow><mi>Ï„</mi><mo>âˆ’</mo><msub><mi>p</mi><mi>Î¸</mi></msub><mo>(</mo><mi>Ï„</mi><mo>)</mo></mrow></msub><mo>[</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>t</mi><mo>=</mo><mi>T</mi></mrow></msubsup><mi>r</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">E_{\tau-p_\theta(\tau)}[\Sigma_{t=1}^{t=T}r(s_t,a_t)] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.2465309999999998em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p>=E_{s_1-p_\theta(s_1)}[E_{a_1-\pi(a_1|s_1)}[r(s_1,a_1)+å¾…å®š]ï½œs_1,a_1] <p>å¦‚æœç»§ç»­å†™ä¸‹å»ï¼Œæˆ‘ä»¬ä¼šå‘ç°å…¶ä¸­çš„â€œå¾…å®šâ€œæ˜¯å¯ä»¥é€’å½’çš„å†™ä¸‹å»çš„ï¼Œç›´åˆ°è½¨è¿¹çš„æœ€åï¼Œå‡è®¾æˆ‘ä»¬å®šä¹‰ä¸€ç§å‡½æ•°ï¼Œåç§°ä¸ºQ- function</p>Qï¼ˆs_1,a_1ï¼‰=r(s_1,a_1)+å¾…å®š <p>é‚£ä¹ˆæˆ‘ä»¬çš„æœŸæœ›å¥–åŠ±å°±æˆä¸º</p>E_{\tau-p_\theta(\tau)}[\Sigma_{t=1}^{t=T}r(s_t,a_t)]=E_{s_1-p_\theta(s_1)}[E_{a_1-\pi(a_1|s_1)}[Q(s_1,t_1)]ï½œs_1,a_1] <p>æ›´è¯¦ç»†çš„å®šä¹‰Q- functionï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mi>Ï€</mi></msup><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></msubsup><msub><mi>E</mi><mrow><msub><mi>Ï€</mi><mi>Î¸</mi></msub></mrow></msub><mo>[</mo><mi>r</mi><mo>(</mo><msub><mi>s</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mo>)</mo><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>]</mo></mrow><annotation encoding="application/x-tex">Q^\pi(s_t,a_t)=\Sigma_{t&#x27;=t}^TE_{\pi_\theta}[r(s_{t&#x27;},a_{t&#x27;})|s_t,a_t] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1471909999999998em;vertical-align:-0.25586em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">]</span></span></span></span></span></p><p>åœ¨MRPé—®é¢˜ä¸­æˆ‘ä»¬ä¼šæœ‰ä¸€ä¸ªçŠ¶æ€ä»·å€¼çš„æ¦‚å¿µï¼ŒåŒæ ·æˆ‘ä»¬è¿™é‡Œå¯ä»¥ç”±state-value- functionï¼Œç”¨æ¥ååº”æ‰€æœ‰è¡Œä¸ºä¸‹çš„æœŸæœ›</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>V</mi><mi>Ï€</mi></msup><mo>(</mo><mi>s</mi><mo>)</mo><mo>=</mo><mi>E</mi><mo>[</mo><msup><mi>Q</mi><mi>Ï€</mi></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>]</mo><mtext>Â </mtext><mi>u</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi><mtext>Â </mtext><mi>Ï€</mi><mo>(</mo><mi>a</mi><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">V^\pi(s)=E[Q^\pi(s,a)]\ under\ \pi(a|s) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mclose">]</span><span class="mord mspace">Â </span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mspace">Â </span><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mord mathrm">âˆ£</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span></span></p><p>ä½†æ˜¯è¿™æ ·å¾—åˆ°çš„Qæœ‰ç”¨å—ï¼Ÿ</p><ol><li>ï¼ˆQ- learningï¼‰è¿™æ ·æˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹å˜<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Ï€</mi><mi>Î¸</mi></msub></mrow><annotation encoding="application/x-tex">\pi_\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>æ¥æ”¹å˜æ€»æœŸæœ›å—ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¯¹åº”æ›´å¤§Qå€¼çš„è¡Œä¸ºï¼Œè™½ç„¶è¿™ä¸æ˜¯æ•°å­¦ä¸Šçš„æè¿°ï¼Œä½†æ˜¯å¯ä»¥ç»™æˆ‘ä»¬ç›´è§‰ä¸Šçš„å¯èƒ½æ€§ã€‚</li><li>ï¼ˆActor- criticï¼‰å°½å¯èƒ½é€‰æ‹©Q&gt;Vçš„è¡Œä¸ºï¼Œå› ä¸ºVååº”è¿™ä¸ªçŠ¶æ€ä¸‹æ‰€æœ‰actionçš„å¹³å‡å€¼</li></ol><p>PSï¼šè¿™ä¸€æ®µçœŸæ˜¯å¤ªæ£’äº†ï¼ï¼ï¼</p><h3 id="42-types-of-rl-algorithm"><a class="markdownIt-Anchor" href="#42-types-of-rl-algorithm"></a> 4.2 Types of RL algorithm</h3><p>æ ¹æ®ç¬¬äºŒæ­¥fit modelæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯model- based RLï¼Œé€šå¸¸åŒ…æ‹¬</p><ol><li>planingï¼›trajectory optimizationã€optimal controlã€MCTS</li><li>improve a policyï¼Œback propagate gradients into the policy with tricks</li><li>something elseï¼Œdynamic programmingï¼Œsimulated experience for model-free leaner</li><li>åé¢å†è¯´</li></ol><p>å¦‚æœæ˜¯evaluate returnï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯model- free RLï¼Œé€šå¸¸åŒ…æ‹¬</p><ol><li>policy gradientsï¼Œç›´æ¥è®¡ç®—Objectiveå’Œgradient</li><li>value- basedï¼Œé€šè¿‡å¹³å±€value- functionå’ŒQ- functionæ¥å¯»æ‰¾æ¯”è¾ƒå¥½çš„æ–¹æ³•</li><li>actor- criticï¼Œé€šè¿‡è¯„ä¼°ç°åœ¨çš„value functionå’ŒQ- functionï¼Œç»“åˆPGçš„æƒ³æ³•æ¥æå‡ç­–ç•¥</li></ol><h3 id="43-why-so-many-algorithms"><a class="markdownIt-Anchor" href="#43-why-so-many-algorithms"></a> 4.3 why so many algorithmsï¼Ÿ</h3><p>æ¨¡å‹æœ¬èº«æœ‰efficiency- stabilityï¼›ä¸åŒçš„assumptionï¼›ä»¥åŠä¸åŒé—®é¢˜çš„ä½¿ç”¨åœºæ™¯ï¼›æ­£å¦‚MLä¸­çš„variance-bias tradeoffï¼ŒRLä¸­é€šå¸¸æ˜¯efficiency- stability trade-off</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7gheycofkj313w0bi75p.jpg" alt="image-20221024165833359" /></p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ghf3ji0cj312q0mcgor.jpg" alt="image-20221024165841658" /></p><p>åŒæ—¶ä¸åŒæ¨¡å‹ä¹Ÿä¼šæœ‰ä¸åŒçš„assumptionï¼Œæ¯”å¦‚æ˜¯å¦å…¨è§‚æµ‹ï¼Œæ˜¯å¦è¿ç»­ç­‰</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ghf94j8dj312m0mqn24.jpg" alt="image-20221024165849690" /></p><h3 id="44-example-of-algorithm"><a class="markdownIt-Anchor" href="#44-example-of-algorithm"></a> 4.4 example of algorithm</h3><ol><li>model- based<ol><li>Dyna</li><li>Guided policy search</li></ol></li><li>model - free<ol><li>Policy gradient<ol><li>REINFORCEï¼ˆREward Increments=nonnegative Factor<em>Offset Reinforcement</em>Characteristic+Eligibilityï¼‰</li><li>Natural Policy gradient</li><li>Trust region policy optimization</li></ol></li><li>Value function fitting methods<ol><li>Q- learningï¼ŒDQN</li><li>Temporal difference learning</li><li>Fitted value iteration</li></ol></li><li>Actor- critic algorithms<ol><li>Asynchronous advantage actor- critic</li><li>Soft actor- criticï¼ˆSACï¼‰</li></ol></li></ol></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;Sergev Levineçš„è¯¾è®²å¼ºåŒ–å­¦ä¹ æˆ‘å”¯ä¸€å¬å¾—æ‡‚ä¸åŒå¼ºåŒ–å­¦ä¹ ç©¶ç«Ÿæœ‰å“ªäº›åˆ†ç±»ï¼ŒåŒæ—¶æ˜¯å¦‚ä½•è¿›è¡Œåˆ†ç±»çš„ã€‚æœ¬æ¬¡Lectureçš„ç›®æ ‡æ˜¯å®Œå–„å®šä¹‰Definitionä¸è®°å·notationï¼Œå¹¶è®¤æ¸…æ¥šRL objectiveï¼Œå¹¶ç»™å‡ºå…·ä½“å¼ºåŒ–å­¦ä¹ ç®—æ³•çš„æ€»ç»“ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="RL" scheme="https://blog.tjdata.site/categories/RL/"/>
    
    
    <category term="CS285" scheme="https://blog.tjdata.site/tags/CS285/"/>
    
  </entry>
  
  <entry>
    <title>CS285_Lecture02_Supervised_Learning_of_Behavior</title>
    <link href="https://blog.tjdata.site/posts/7d84bcc6.html"/>
    <id>https://blog.tjdata.site/posts/7d84bcc6.html</id>
    <published>2022-10-23T10:01:56.000Z</published>
    <updated>2023-05-13T13:47:58.896Z</updated>
    
    <content type="html"><![CDATA[<p>ç›®æ ‡æ˜¯æ˜ç™½RLä¸­çš„ä¸€äº›å®šä¹‰ï¼ˆdefinitionï¼‰å’Œè®°å·ï¼ˆnotationï¼‰ï¼Œä¸»è¦æ˜¯ä»MDPçš„å®šä¹‰ï¼Œç„¶åæ¨¡ä»¿å­¦ä¹ ï¼ˆImitation learningï¼‰å’Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Ïµ</span></span></span></span>-greedy å­¦ä¹ çš„è§’åº¦ä»‹ç»äº†å¼ºåŒ–å­¦ä¹ ä¸­çš„case</p><span id="more"></span><h2 id="0x01-definition-of-sequential-decision-problem"><a class="markdownIt-Anchor" href="#0x01-definition-of-sequential-decision-problem"></a> <strong>0x01 Definition of Sequential decision problem</strong></h2><h3 id="11-æ¦‚ç‡è®º"><a class="markdownIt-Anchor" href="#11-æ¦‚ç‡è®º"></a> 1.1 æ¦‚ç‡è®º</h3><p>å…³äºæ¦‚ç‡è®ºçš„è®°å·ï¼Œä¸ç ”ä¸€è¯¾ç¨‹ã€Šåº”ç”¨ç»Ÿè®¡ã€‹ä¸ä¸€æ ·ã€‚æˆ‘çŒœæƒ³å¤šæ˜¯å…·æœ‰å¦å¤–çš„è§„å®šï¼Œè¿™é‡Œå¼•ç”¨ä»ã€ŠDeep learningã€‹ï¼ˆ2015ï¼ŒLan Goodfellowï¼‰ä¸­çš„è¯´æ˜ï¼š</p><p>éšæœºå˜é‡ï¼ˆrandom variableï¼‰æ˜¯å¯ä»¥éšæœºå–ä¸åŒå€¼çš„å˜é‡ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨æ— æ ¼å¼å­—ä½“ï¼ˆplain typefaceï¼‰ä¸­çš„å°å†™å­—æ¯è¡¨ç¤ºéšæœºå˜é‡æœ¬èº«ï¼Œç”¨æ‰‹å†™ä½“ä¸­çš„å°å†™å­—æ¯è¡¨ç¤ºéšæœºå˜é‡èƒ½å¤Ÿå–çš„å€¼ã€‚<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_1,x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>è¡¨ç¤ºéšæœºå˜é‡xå¯èƒ½çš„å–å€¼ï¼Œå¯¹äºå‘é‡ï¼ˆvectorï¼‰çš„å˜é‡ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨xï¼Œå¯èƒ½çš„å–å€¼ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>ã€‚æ‰€ä»¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo></mrow><annotation encoding="application/x-tex">p(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span></span></span></span>x=xï¼‰å¯ä»¥ç®€å†™ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></p><h3 id="12-å¼ºåŒ–å­¦ä¹ "><a class="markdownIt-Anchor" href="#12-å¼ºåŒ–å­¦ä¹ "></a> 1.2 å¼ºåŒ–å­¦ä¹ </h3><p>ä¸å¼ºåŒ–å­¦ä¹ å…¸ä¸­å…¸çš„ï¼šç¯å¢ƒï¼ˆEnvironmentï¼‰ä¸æ™ºèƒ½ä½“ï¼ˆAgentï¼‰å’ŒåŠ¨ä½œï¼ˆActionï¼‰ä¸‰è€…äº¤äº’ç±»ä¼¼ï¼ŒCS285è¯¾ç¨‹åŒæ ·ä»¥è¿™æ ·çš„ä¾‹å­ä½œä¸ºå¼€ç«¯ï¼Œå¹¶åˆ©ç”¨æ¦‚ç‡å›¾çš„æ–¹å¼æ¥åˆ†æè¿™ä¸ªè¿‡ç¨‹ã€‚</p><ul><li>ï¼ˆç¬¬ä¸€å±‚ï¼‰åœ¨è‰åŸè¿™ä¸ªç¯å¢ƒä¸­çœ‹åˆ°äº†æŸä¸ªä¸œè¥¿ï¼Œç„¶åæˆ‘ä»¬åˆ¤åˆ«å‡ºæ¥å®ƒæ˜¯è€è™ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬é€šå¸¸åšå‡ºæŸä¸ªåŠ¨ä½œï¼Œä½†æ˜¯æˆ‘ä»¬çš„åŠ¨ä½œä¹Ÿä¼šå½±å“è‰åŸç¯å¢ƒï¼Œè¿›è€Œå½±å“è€è™çš„åŠ¨ä½œ</li><li>ï¼ˆç¬¬äºŒå±‚ï¼‰ï¼Œå‡è®¾è‰åŸç¯å¢ƒä½œä¸ºEnvironmentï¼ŒæŸä¸ªæ—¶é—´ç‚¹çš„çŠ¶æ€ä¸ºStateï¼Œæˆ‘ä»¬ä½œä¸ºAgenté€šè¿‡çœ‹è®¤è¯†è¿™ä¸ªçŠ¶æ€å¾—åˆ°Observationï¼ˆè€è™çš„æ¦‚ç‡ä¸º0.99ï¼ŒçŒ«çš„æ¦‚ç‡ä¸º0.01ï¼‰ï¼Œä¹‹åæˆ‘ä»¬ä¼šæ ¹æ®Observationæ¥é‡‡å–Policy( <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>o</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\pi_\theta(a_t|o_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span>)ï¼ˆå¦‚æœæ˜¯è€è™ï¼Œåˆ™é€ƒè·‘æ¦‚ç‡=0.9ï¼Œå½“å® ç‰©=0.1ï¼›å¦‚æœæ˜¯çŒ«ï¼Œåˆ™é€ƒè·‘æ¦‚ç‡=0.1ï¼Œå½“å® ç‰©=0.9ï¼‰ï¼›ä¹‹åæˆ‘ä»¬çš„åŠ¨ä½œactionç»“åˆç°æœ‰çš„stateä¼šå½±å“ä¸‹ä¸€æ­¥çš„next-state</li><li>(ç¬¬ä¸‰å±‚ï¼‰<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>å¾—åˆ°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">o_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span>ï¼Œä¹‹åæ ¹æ®ç­–ç•¥å¾—åˆ°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><msub><mi mathvariant="normal">Î </mi><mi>Î¸</mi></msub><mo>(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>o</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">a_t=\Pi_\theta(a_t|o_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">Î </span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span>,å†å½±å“ä¸‹ä¸€æ­¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">s_{t+1}=P(s_{t+1}|s_t,a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span>ï¼›state â€” observation â€” action â€” next_stateâ€¦</li></ul><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬ä¼šæœ‰å‡ ä¸ªç–‘é—®ï¼š</p><ol><li>æ™ºèƒ½ä½“å¯¹ç¯å¢ƒæ˜¯å¦æ˜¯å®Œå…¨è§‚æµ‹ï¼ˆfully observeï¼‰ï¼Œè¿™ç›´æ¥ä¼šå½±å“æˆ‘ä»¬å­¦ä¹ çš„ç­–ç•¥ï¼Œé€šå¸¸åˆ†ä¸º\pi_\theta(a_t|s_t)æˆ–è€…\pi_\theta(o_t|s_t) ï¼Œç»å¸¸ä¼šå‡ºé”™</li><li>ç”±å›¾å¯ä»¥çœ‹å‡ºçŠ¶æ€è½¬ç§»ï¼ˆstate transitï¼‰æ˜¯å…·æœ‰é©¬å°”å¯å¤«æ€§è´¨ï¼ˆMarkov propertyï¼‰ï¼Œä½†æ˜¯observationä¸ä¸€å®šã€actionä¹Ÿä¸ä¸€å®šã€policyä¹Ÿä¸ä¸€å®š</li><li>æˆ‘ä»¬çš„objectiveè¿˜ä¸ç¡®å®š</li></ol><p>åœ¨ä¸æ˜ç™½ç›®æ ‡æƒ…å†µä¸‹ï¼Œä¸å¦‚å»çœ‹ä¸€ç§ç®€å•çš„æ–¹å¼æ˜¯å¦‚ä½•å­¦ä¹ çš„</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7getc5ancj314w0nqn0j.jpg" alt="image-20221024152834540" /></p><p>PSï¼šå¼ºåŒ–å­¦ä¹ çš„è®°å·é€šå¸¸è®¤ä¸ºæ˜¯ç ”ç©¶è¿ç­¹æˆ–åŠ¨æ€è§„åˆ’ï¼ˆDynamic programmingï¼‰çš„Richard Bellmanå’Œç ”ç©¶è‡ªåŠ¨æ§åˆ¶çš„Lev Pontryaginä¸åŒçš„å‘å±•ã€‚</p><h2 id="0x02-imitation-learning"><a class="markdownIt-Anchor" href="#0x02-imitation-learning"></a> <strong>0x02 Imitation Learning</strong></h2><p>åœ¨Lecture01ä¸­è™½ç„¶å¯¹æ¯”äº†å¼ºåŒ–å­¦ä¹ ï¼ˆreinforcement learningï¼‰ä¸ç›‘ç£å­¦ä¹ ï¼ˆsupervised learningï¼‰ä¹‹é—´çš„å·®åˆ«ï¼Œä½†æ˜¯æˆ‘ä»¬ä¾æ—§ä¼šå‘ç°ä¸¤è€…ä¹‹é—´ç›¸ä¼¼çš„åœ°æ–¹</p><p><strong>ç»™å‡ºä¸€ä¸ªstateæˆ–è€…observationï¼Œæ¥è¾“å‡ºä¸€ä¸ªaction</strong></p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥å‡è®¾å­˜åœ¨ä¸€ä¸ªä¸“å®¶æ™ºèƒ½ä½“ï¼Œå…¶ç­–ç•¥å¯ä»¥çœ‹æˆæœ€ä¼˜ç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ¨¡ä»¿è¿™ä¸ªä¸“å®¶åœ¨ç¯å¢ƒä¸­äº¤äº’çŠ¶æ€åŠ¨ä½œï¼ˆstateï¼Œactionï¼‰æ•°æ®æ¥è®­ç»ƒä¸€ä¸ªpolicyï¼Œè€Œä¸éœ€è¦ç¯å¢ƒæä¾›çš„rewardï¼Œè¿™æ ·ä¾¿æ˜¯imitation learningç ”ç©¶çš„é—®é¢˜ï¼Œä¸éœ€è¦rewardä¿¡å·å˜å¯ä»¥è¾¾åˆ°ä¸€ä¸ªä¸“å®¶ç­–ç•¥ï¼Œå¸¸ç”¨çš„æ–¹æ³•åˆ†ä¸º</p><ol><li>Behaviour Cloning</li><li>Inverse RL</li><li>Generative Adversarial Imitation Learningï¼ŒGAIL</li></ol><h3 id="21-behaviour-cloning"><a class="markdownIt-Anchor" href="#21-behaviour-cloning"></a> 2.1 Behaviour cloning</h3><p>è¾“å…¥ï¼ˆs_tï¼Œa_tï¼‰ä¸­çš„stateä½œä¸ºæ ·æœ¬è¾“å…¥ï¼Œactionä½œä¸ºæ ‡ç­¾ï¼Œç›®æ ‡ä¸º</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Î¸</mi><mo>âˆ—</mo></msup><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>Î¸</mi></msub><msub><mi>E</mi><mrow><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>âˆ’</mo><mi>Ï„</mi></mrow></msub><mo>[</mo><mi>L</mi><mo>(</mo><msub><mi>Ï€</mi><mi>Î¸</mi></msub><mo>(</mo><mi>s</mi><mo>)</mo><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">\theta^*=argmin_\theta E_{(s,a)- \tau}[L(\pi_\theta(s),a)] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">âˆ—</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p><strong>Does it ok? â€” No</strong></p><p>åœ¨æ•°æ®é‡è¾ƒå°çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªèƒ½å¾—åˆ°å°‘é‡çš„ä¸“å®¶æ•°æ®ä½œä¸ºè®­ç»ƒï¼Œå› æ­¤åªæœ‰åœ¨æ•°æ®é›†çš„åˆ†å¸ƒä¸‹é¢„æµ‹å‡†ç¡®ã€‚ä½†æ˜¯å› ä¸ºæˆ‘ä»¬ä¸æ–­ç»å†state- observation- action- stateçš„å¾ªç¯ï¼Œå¹¶ä¸æ˜¯ç›‘ç£å­¦ä¹ çš„ä¸€æ¬¡ç»ˆæ­¢ï¼Œå› æ­¤æˆ‘ä»¬çš„æ¯æ¬¡åå·®éƒ½ä¼šç´¯ç§¯ï¼Œäº§ç”Ÿå¤åˆç‰©å·®ï¼ˆcompounding errorï¼‰çš„é—®é¢˜ï¼Œå¯¼è‡´å·®è·æ¥è¶Šæ¥å¤§è€Œå¤±è´¥ã€‚</p><p><img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/74e6a340-4a13-4510-9346-e8245997d62b/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&amp;X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20221024%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20221024T072857Z&amp;X-Amz-Expires=86400&amp;X-Amz-Signature=d2b5cfffb43cede993ee20eef195515f58c6275241b3572a7a27a2b506cf5e5f&amp;X-Amz-SignedHeaders=host&amp;response-content-disposition=filename%20%3D%22Untitled.png%22&amp;x-id=GetObject" alt="img" /></p><p><strong>Does it okï¼Ÿyesï¼Œbut more data</strong></p><p>ä½†æ˜¯åœ¨å…·æœ‰å¾ˆå¤šæ•°æ®çš„æƒ…å†µä¸‹æ˜¯å¯ä»¥å®ç°çš„ï¼Œæ¯”å¦‚****<a href="https://arxiv.org/abs/1604.07316">End to End Learning for Self-Driving Cars</a>æ–‡ç« ä¸­æ”¶é›†äº†è¶³å¤Ÿå¤šçš„æ•°æ®æ¥å®ç°è¿è¡Œçš„ç¨³å®šæ€§**</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7geu6kqg3j31360n0ad3.jpg" alt="image-20221024152923468" /></p><p><strong>How we make it more offenï¼Ÿ</strong></p><p>æˆ‘ä»¬åˆ†æä¹‹é—´ä¹‹å‰ä¸åŒ trajectoryäº§ç”Ÿåå·®çš„åŸå› æ˜¯ç”±äº<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub><mo>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>)</mo><mo>!</mo><mo>=</mo><msub><mi>p</mi><mrow><msub><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow></msub></mrow></msub><mo>(</mo><msub><mi>o</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p_{data}(o_t)!=p_{\pi_{\theta}}(o_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.00586em;vertical-align:-0.25586em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">a</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">!</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span>,å› æ­¤æˆ‘ä»¬å¸Œæœ›ç”¨æŸç§æ–¹å¼æ¥ä¿è¯ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ DAggerï¼ˆDataset Aggregationï¼‰ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7geuhk3ruj30uq098q3z.jpg" alt="image-20221024152938796" /></p><p>ä½†æ˜¯ç¬¬ä¸€ç‚¹ï¼šäººå·¥æ ‡è®°æœ¬èº«å°±ä¸å¯é ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ç›¸åŒçš„åœºæ™¯ä¸‹ä¹Ÿä¼šå‡ºç°ä¸åŒçš„è¡Œä¸ºï¼ŒåŒæ—¶æˆ‘ä»¬çš„åŠ¨ä½œä¼šå’Œä¸€å®šçš„è®°å¿†æœ‰å…³ï¼›ç¬¬äºŒç‚¹æˆ‘ä»¬åœ¨å¤æ‚åœºæ™¯ä¸­å¾ˆéš¾å‡†ç¡®ç»™å‡ºæ–°çš„stateçš„actionï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šæˆ‘ä»¬ä¾æ—§éœ€è¦å­¦ä¹ æœºå™¨ï¼Œæˆ‘ä»¬éœ€è¦åºåˆ—å­¦ä¹ çš„æ¦‚å¿µ</p><p>å½“ç„¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨CNN+RNNçš„ç‰¹ç‚¹ï¼Œä»–ä»¬ä¾æ—§åªæ˜¯å¤æ‚çš„æ¨¡ä»¿å­¦ä¹ ï¼Œå¹¶æ²¡æœ‰è§£å†³åˆ†å¸ƒä¸åŒ¹é…çš„é—®é¢˜ã€‚æ€»æ˜¯æˆ‘ä»¬ç”¨DAggeræ¥è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œä¾æ—§åªæ˜¯åœ¨ç‰¹å®šåœºæ™¯ä¸‹å…·æœ‰å¯èƒ½æ€§ã€‚</p><h2 id="0x03-a-little-bit-of-theory-for-imitation-learning"><a class="markdownIt-Anchor" href="#0x03-a-little-bit-of-theory-for-imitation-learning"></a> <strong>0x03 A little bit of theory</strong> for imitation learning</h2><p><strong>å¯ä»¥ä¸çœ‹ï¼Œå› ä¸ºçœ‹ä¸æ‡‚ï¼</strong></p><p>ç»“åˆä¹‹å‰åŸºæœ¬æ¦‚å¿µé‡Œçš„MRPï¼ˆMarkov reward processï¼‰æˆ‘ä»¬å¯ä»¥ç†è§£rewardï¼Œå› æ­¤åœ¨ä¸€æ®µè½¨è¿¹ä¸­æˆ‘ä»¬å¸Œæœ›,é¦–å…ˆæˆ‘ä»¬å®šä¹‰cost</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><msub><mi>E</mi><mrow><mi>s</mi><mn>1</mn><mo>âˆ’</mo><mi>t</mi><mo separator="true">,</mo><mi>a</mi><mn>1</mn><mo>âˆ’</mo><mi>t</mi></mrow></msub><mo>[</mo><mi mathvariant="normal">Î£</mi><mi>c</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">min E_{s1-t,a1-t}[\Sigma c(s_t,a_t)] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">s</span><span class="mord mathrm">1</span><span class="mbin">âˆ’</span><span class="mord mathit">t</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathrm">1</span><span class="mbin">âˆ’</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord mathrm">Î£</span><span class="mord mathit">c</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>åŒæ—¶coståé¢ç­‰äºå¥–åŠ±ï¼Œä¹Ÿå°±æ˜¯</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mo>âˆ’</mo><mi>c</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">r(s,a)=-c(s,a) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">âˆ’</span><span class="mord mathit">c</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span></span></span></span></span></p><p>æˆ‘ä»¬å°†çœŸå®çš„ç­–ç•¥è¡¨ç¤ºä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow><mo>âˆ—</mo></msubsup><mo>(</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\pi^*_{\theta}(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.008804em;vertical-align:-0.2588039999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.2588039999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">âˆ—</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„å¥–åŠ±å‡½æ•°åº”è¯¥æ˜¯</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>p</mi><mo>(</mo><mi>a</mi><mo>=</mo><msubsup><mi>Ï€</mi><mrow><mi>Î¸</mi></mrow><mo>âˆ—</mo></msubsup><mo>(</mo><mi>s</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">r(s,a)=log p(a=\pi^*_{\theta}(s))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.008804em;vertical-align:-0.2588039999999999em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="vlist"><span style="top:0.2588039999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">âˆ—</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>y</p><p>å› æ­¤åœ¨é‡‡æ ·é”™è¯¯ç‡ä½äºä¸€å®šç¨‹åº¦ä¹‹ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7geurlea5j31400maq68.jpg" alt="image-20221024152956985" /></p><p>æ”¹è¿›ä¹‹åæˆ‘ä»¬æœ‰éœ€è¦å…¶ä»–çš„æ–¹å¼æ¥å­¦ä¹ ï¼Œè¿™ç§ä¸»è¦æ˜¯ç”Ÿæˆæ¨¡å‹äº†ï½</p><h3 id="31-ç”Ÿæˆå¯¹æŠ—æ¨¡å‹å­¦ä¹ generative-adverbial-imitation-learning"><a class="markdownIt-Anchor" href="#31-ç”Ÿæˆå¯¹æŠ—æ¨¡å‹å­¦ä¹ generative-adverbial-imitation-learning"></a> 3.1 ç”Ÿæˆå¯¹æŠ—æ¨¡å‹å­¦ä¹ ï¼ˆgenerative adverbial imitation learningï¼‰</h3><p>æ‘˜è‡ª<a href="https://hrl.boyuai.com/chapter/3/%E6%A8%A1%E4%BB%BF%E5%AD%A6%E4%B9%A0">åŠ¨æ‰‹å­¦å¼ºåŒ–å­¦ä¹ </a></p><p>ï¼ˆgenerative adversarial imitation learningï¼ŒGAILï¼‰æ˜¯ 2016 å¹´ç”±æ–¯å¦ç¦å¤§å­¦ç ”ç©¶å›¢é˜Ÿæå‡ºçš„åŸºäºç”Ÿæˆå¼å¯¹æŠ—ç½‘ç»œçš„æ¨¡ä»¿å­¦ä¹ ï¼Œå®ƒè¯ é‡Šäº†ç”Ÿæˆå¼å¯¹æŠ—ç½‘ç»œçš„æœ¬è´¨å…¶å®å°±æ˜¯æ¨¡ä»¿å­¦ä¹ ã€‚GAIL å®è´¨ä¸Šæ˜¯æ¨¡ä»¿äº†ä¸“å®¶ç­–ç•¥çš„å ç”¨åº¦é‡å³å°½é‡ä½¿å¾—ç­–ç•¥åœ¨ç¯å¢ƒä¸­çš„æ‰€æœ‰çŠ¶æ€åŠ¨ä½œå¯¹çš„å ç”¨åº¦é‡å’Œä¸“å®¶ç­–ç•¥çš„å ç”¨åº¦é‡ä¸€è‡´ã€‚ä¸ºäº†è¾¾æˆè¿™ä¸ªç›®æ ‡ï¼Œç­–ç•¥éœ€è¦å’Œç¯å¢ƒè¿›è¡Œäº¤äº’ï¼Œæ”¶é›†ä¸‹ä¸€ä¸ªçŠ¶æ€çš„ä¿¡æ¯å¹¶è¿›ä¸€æ­¥åšå‡ºåŠ¨ä½œã€‚è¿™ä¸€ç‚¹å’Œ BC ä¸åŒï¼ŒBC å®Œå…¨ä¸éœ€è¦å’Œç¯å¢ƒäº¤äº’ã€‚GAIL ç®—æ³•ä¸­æœ‰ä¸€ä¸ªåˆ¤åˆ«å™¨å’Œä¸€ä¸ªç­–ç•¥ï¼Œç­–ç•¥å°±ç›¸å½“äºæ˜¯ç”Ÿæˆå¼å¯¹æŠ—ç½‘ç»œä¸­çš„<strong>ç”Ÿæˆå™¨</strong>ï¼ˆgeneratorï¼‰ï¼Œç»™å®šä¸€ä¸ªçŠ¶æ€ï¼Œç­–ç•¥ä¼šè¾“å‡ºè¿™ä¸ªçŠ¶æ€ä¸‹åº”è¯¥é‡‡å–çš„åŠ¨ä½œï¼Œè€Œ<strong>åˆ¤åˆ«å™¨</strong>ï¼ˆdiscriminatorï¼‰å°†çŠ¶æ€åŠ¨ä½œå¯¹ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„å®æ•°ï¼Œè¡¨ç¤ºåˆ¤åˆ«å™¨è®¤ä¸ºè¯¥çŠ¶æ€åŠ¨ä½œå¯¹æ˜¯æ¥è‡ªæ™ºèƒ½ä½“ç­–ç•¥è€Œéä¸“å®¶çš„æ¦‚ç‡ã€‚åˆ¤åˆ«å™¨çš„ç›®æ ‡æ˜¯å°½é‡å°†ä¸“å®¶æ•°æ®çš„è¾“å‡ºé è¿‘ 0ï¼Œå°†æ¨¡ä»¿è€…ç­–ç•¥çš„è¾“å‡ºé è¿‘ 1ï¼Œè¿™æ ·å°±å¯ä»¥å°†ä¸¤ç»„æ•°æ®åˆ†è¾¨å¼€æ¥ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7gev0mzw6j30ke0h4aar.jpg" alt="image-20221024153011985" /></p><h2 id="0x04-æ€»ç»“"><a class="markdownIt-Anchor" href="#0x04-æ€»ç»“"></a> <strong>0x04 æ€»ç»“</strong></h2><p>Lecture02ä¸»è¦è¿˜æ˜¯åˆ©ç”¨imitation learningä»‹ç»äº†</p><ol><li>ç›‘ç£å­¦ä¹ ç”¨äºå¼ºåŒ–å­¦ä¹ çš„å±€é™æ€§</li><li>å¼ºåŒ–å­¦ä¹ çš„notation</li></ol><p>ä¸‹ä¸€ç« æ˜¯åŠå…¶Fancyçš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•çš„æ€»ç»“</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç›®æ ‡æ˜¯æ˜ç™½RLä¸­çš„ä¸€äº›å®šä¹‰ï¼ˆdefinitionï¼‰å’Œè®°å·ï¼ˆnotationï¼‰ï¼Œä¸»è¦æ˜¯ä»MDPçš„å®šä¹‰ï¼Œç„¶åæ¨¡ä»¿å­¦ä¹ ï¼ˆImitation learningï¼‰å’Œ&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;&#92;epsilon&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base textstyle uncramped&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;Ïµ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;-greedy å­¦ä¹ çš„è§’åº¦ä»‹ç»äº†å¼ºåŒ–å­¦ä¹ ä¸­çš„case&lt;/p&gt;</summary>
    
    
    
    <category term="RL" scheme="https://blog.tjdata.site/categories/RL/"/>
    
    
    <category term="CS285" scheme="https://blog.tjdata.site/tags/CS285/"/>
    
  </entry>
  
  <entry>
    <title>åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ 05_å¾ªç¯ç¥ç»ç½‘ç»œRNNåŠå˜ç§</title>
    <link href="https://blog.tjdata.site/posts/2e4e1168.html"/>
    <id>https://blog.tjdata.site/posts/2e4e1168.html</id>
    <published>2022-10-19T02:23:50.000Z</published>
    <updated>2023-05-13T13:51:58.356Z</updated>
    
    <content type="html"><![CDATA[<p>æ‰¿æ¥ä¸Šä¸€ä¼šå¯¹Attentionä¸­seq2seqçš„æ¨¡å‹çš„å›°æƒ‘ï¼Œè¿™é‡Œä»RNNåˆ°ä»‹ç»åˆ°æ›´ä¼ ç»Ÿçš„Seq2Seqæ¨¡å‹ã€‚åŒæ—¶ç»“åˆæœ€è¿‘æ¥è§¦çš„èŠ±ä¹¦æ¥åˆ©ç”¨æ›´æœ‰åˆ©çš„å·¥å…·è§£é‡ŠRNNä¸­çš„æ¢¯åº¦ã€‚å¹¶ç»™å‡ºåºåˆ—å­¦ä¹ ä¸­å¯¹äºgradientæˆ–è€…hidden stateè½¬å˜çš„è¿‡ç¨‹ï¼Œåœ¨é’ˆå¯¹hidden stateä¸­çš„è½¬å˜ä¸­å¼•ç”³å‡ºGRUã€LSTMä¹‹ç±»çš„å˜ç§ï¼Œå¹¶ç»“åˆD@Lç»™å‡ºä»£ç çš„å®ç°ã€‚</p><span id="more"></span><h2 id="0x01-åºåˆ—å­¦ä¹ ä¸rnn"><a class="markdownIt-Anchor" href="#0x01-åºåˆ—å­¦ä¹ ä¸rnn"></a> 0x01 åºåˆ—å­¦ä¹ ä¸RNN</h2><h3 id="11-åºåˆ—å­¦ä¹ seq2seq"><a class="markdownIt-Anchor" href="#11-åºåˆ—å­¦ä¹ seq2seq"></a> 1.1 åºåˆ—å­¦ä¹ Seq2Seq</h3><p>è¾“å…¥ä¸è¾“å‡ºå‡ä¸ºåºåˆ—æ•°æ®çš„æ¨¡å‹å«åšSeq2Seqï¼Œæ³¨æ„è¿™é‡Œä¸åœ¨æŒ‰ç…§ä¼ ç»Ÿçš„ç›‘ç£æˆ–è€…éç›‘ç£çš„æ–¹å¼æ¥é™å®šæ¨¡å‹çš„ç±»å‹ã€‚å¸¸è§åºåˆ—æ¨¡å‹çš„åº”ç”¨åŒ…æ‹¬ï¼šè¯­éŸ³è¯†åˆ«Speech recognitionã€éŸ³ä¹ç”ŸæˆMusic generationã€æƒ…æ„Ÿåˆ†æ Sentiment classificationã€DNAåºåˆ—åˆ†æDNA sequence analysisã€æœºå™¨ç¿»è¯‘Machine translationã€è§†é¢‘è¡Œä¸ºè¯†åˆ«Video activity recognitionã€å‘½åå®ä½“è¯†åˆ«Name entity recognitionã€‚</p><p>åœ¨Seq2Seqè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¾ˆéš¾åƒMLPæˆ–è€…CNNå¾—åˆ°ä¸€ä¸ªæ˜ç¡®çš„ featureï¼Œlabelï¼›å¹¶ä¸”åºåˆ—æ•°æ®å¤§å¤šæ˜¯æŒ‰ç…§ä¸€å®šçš„é¡ºåºæ¥è¿›è¡Œçš„ï¼Œæ¯”å¦‚æ–‡æœ¬åºåˆ—ã€è§†é¢‘ä¿¡å·ã€ç½‘ç«™æµè§ˆè¡Œä¸ºç­‰ç­‰ï¼Œå¹¶ä¸æ»¡è¶³ä¹‹å‰çš„ç‹¬ç«‹åŒåˆ†å¸ƒçš„å‡è®¾ã€‚</p><p>ä¸ºä»€ä¹ˆRNNç±»ä¼¼çš„ç½‘ç»œåœ¨Seqä¸­ä¼šå–å¾—å¥½çš„æ•ˆæœï¼Ÿä¸»è¦æ˜¯è§£å†³20ä¸–çºª80å¹´ä»£æœºå™¨å­¦ä¹ å’Œç»Ÿè®¡æ¨¡å‹çš„æ€æƒ³çš„ä¼˜ç‚¹ï¼šåœ¨æ¨¡å‹çš„ä¸åŒéƒ¨åˆ†å…±äº«å‚æ•°ã€‚<strong>å‚æ•°å…±äº«</strong>ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ‹“å±•åˆ°ä¸åŒå½¢å¼çš„æ ·æœ¬å¹¶è¿›è¡Œæ³›åŒ–ã€‚speciallyï¼šå‡å¦‚åœ¨seqçš„æ¯ä¸€ä¸ªæ—¶é—´ç‚¹éƒ½å…·æœ‰ä¸€ä¸ªå•ç‹¬çš„å‚æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½æ³›åŒ–æˆ‘ä»¬æ²¡æœ‰è§è¿‡çš„ç±»å‹ï¼Œä¹Ÿä¸èƒ½åœ¨æ—¶é—´ä¸Šå…±äº«ä¸åŒåºåˆ—é•¿åº¦å’Œä¸åŒä½ç½®çš„ç»Ÿè®¡å¼ºåº¦ã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿä¸èƒ½ç†è§£ä¸åŒé¡ºåºseqçš„å«ä¹‰ï¼ˆæ¯”å¦‚In 2009ï¼ŒI went to Nepalå’ŒI went to Nepal in 2009ä¹‹é—´çš„åŒºåˆ«ï¼‰</p><p>Shortlyï¼šRNNçš„ä¼˜åŠ¿ä¸»è¦æ˜¯</p><ol><li>è·¨æ—¶é—´æƒé‡å…±äº«</li><li>æ—¶é—´å¹³ç§»ä¸å¯¹ç§°</li><li>åŒä¸€æ¶æ„é€‚åº”ä¸åŒé•¿åº¦</li></ol><h3 id="12-rnnç»“æ„å‰å‘ä¼ æ’­-forward-propagation"><a class="markdownIt-Anchor" href="#12-rnnç»“æ„å‰å‘ä¼ æ’­-forward-propagation"></a> 1.2 RNNç»“æ„å‰å‘ä¼ æ’­ Forward Propagation</h3><p>è¿™é‡Œå…ˆä¸ç®¡RNNå†…éƒ¨çš„å…·ä½“ç»“æ„çš„åŸå› ï¼Œåªè¦çŸ¥é“RNNåŒ…æ‹¬æ—¶é—´æ­¥çš„inputå’Œoutputä»¥åŠhidden stateå°±å¯ä»¥ï¼ŒåŸå› åœ¨åé¢ä¼šè¯´æ˜ã€‚è®¡ç®—å›¾æ˜¯å½¢å¼åŒ–ä¸€ç»„è®¡ç®—ç»“æ„çš„æ–¹å¼ï¼Œå¦‚æœè®¾è®¡å°†è¾“å…¥å’Œå‚æ•°æ˜ å°„åˆ°è¾“å‡ºå’ŒæŸå¤±çš„è®¡ç®—ã€‚</p><p>å…ˆå‡è®¾æ•°æ®é›†ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><mo>(</mo><msup><mi>x</mi><mn>1</mn></msup><mo separator="true">,</mo><msup><mi>x</mi><mn>2</mn></msup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msup><mi>x</mi><mi>t</mi></msup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>)</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>n</mi><mo>Ã—</mo><mi>d</mi></mrow></msup></mrow><annotation encoding="application/x-tex">X=(x^1,x^2,..,x^t,...)\mathbb{R}^{n \times d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mclose">)</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span><span class="mbin">Ã—</span><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></p><p>é€šå¸¸çš„è®­ç»ƒè¿‡ç¨‹æ˜¯å°†<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>H</mi><mi>t</mi></msup><mo>âˆˆ</mo><mrow><msup><mi mathvariant="double-struck">R</mi><mrow><mn mathvariant="normal">1</mn><mo>Ã—</mo><mi>h</mi></mrow></msup></mrow></mrow><annotation encoding="application/x-tex">H^t\in \mathbb{R^{1 \times h}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.888208em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbb">R</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">1</span><span class="mbin">Ã—</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span>ä½œä¸ºhidden stateæ¥è¿›è¡Œåˆ†æï¼Œå®ƒæ˜¯æ ¹æ®ä¸‹å¼å­è¿›è¡Œæ›´æ–°</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>H</mi><mi>t</mi></msup><mo>=</mo><mi>f</mi><mo>(</mo><msup><mi>H</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo separator="true">,</mo><msup><mi>x</mi><mi>t</mi></msup><mo separator="true">;</mo><mi>Î¸</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">H^t=f(H^{t-1},x^t;\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.864108em;"></span><span class="strut bottom" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">;</span><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span></span></span></span></span></p><p>å¦‚æœé‡‡ç”¨ç¥ç»ç½‘ç»œï¼Œæ ¼å¼é€šå¸¸æ˜¯</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>H</mi><mi>t</mi></msup><mo>=</mo><mi>Ï•</mi><mo>(</mo><msup><mi>x</mi><mrow><mi>t</mi></mrow></msup><msub><mi>W</mi><mrow><mi>x</mi><mi>h</mi></mrow></msub><mo>+</mo><msup><mi>H</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>h</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">H^t=\phi(x^{t}W_{xh}+H^{t-1}W_{hh}+b_h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.864108em;"></span><span class="strut bottom" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">Ï•</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">x</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">h</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>å…¶ä¸­å„é¡¹çš„åˆ†åˆ«ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mrow><mi>x</mi><mi>h</mi></mrow></msub><mo>âˆˆ</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>d</mi><mo>Ã—</mo><mi>h</mi></mrow></msup><mo separator="true">,</mo><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub><mo>âˆˆ</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>h</mi><mo>Ã—</mo><mi>h</mi></mrow></msup><mo separator="true">,</mo><msub><mi>b</mi><mi>h</mi></msub><mo>âˆˆ</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mn>1</mn><mo>Ã—</mo><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">W_{xh}\in \mathbb{R}^{d\times h},W_{hh}\in\mathbb{R}^{h\times h},b_h\in\mathbb{R}^{1\times h}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">x</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span><span class="mbin">Ã—</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">h</span><span class="mbin">Ã—</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">h</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">1</span><span class="mbin">Ã—</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></p><p>åœ¨å¾—åˆ°hidden stateæˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥çŠ¶æ€è½¬æ¢ï¼Œä¹Ÿå¯ä»¥è¾“å‡ºå½“å‰çš„å€¼</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>O</mi><mi>t</mi></msup><mo>=</mo><mi>g</mi><mo>(</mo><msup><mi>H</mi><mi>t</mi></msup><mo separator="true">;</mo><msub><mi>Î¸</mi><mi>o</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">O^t=g(H^t;\theta_o)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.843556em;"></span><span class="strut bottom" style="height:1.093556em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">;</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>O</mi><mi>t</mi></msup><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo>(</mo><msup><mi>H</mi><mi>t</mi></msup><msub><mi>W</mi><mrow><mi>o</mi><mi>h</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>o</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">O^t=tanh(H^tW_{oh}+b_o)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.843556em;"></span><span class="strut bottom" style="height:1.093556em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">o</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>å…¶ä¸­å„é¡¹çš„å½¢çŠ¶ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mrow><mi>o</mi><mi>h</mi></mrow></msub><mo>âˆˆ</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>h</mi><mo>Ã—</mo><mi>o</mi></mrow></msup><mo separator="true">,</mo><msub><mi>b</mi><mi>o</mi></msub><mo>âˆˆ</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mn>1</mn><mo>Ã—</mo><mi>o</mi></mrow></msup></mrow><annotation encoding="application/x-tex">W_{oh}\in\mathbb{R}^{h\times o},b_o\in\mathbb{R}^{1\times o}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">o</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">h</span><span class="mbin">Ã—</span><span class="mord mathit">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">1</span><span class="mbin">Ã—</span><span class="mord mathit">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></p><p>å¾—åˆ°æ¨¡å‹çš„è¾“å…¥å’Œè¾“å‡ºä¹‹åå°±å¯ä»¥è®¡ç®—æ¨¡å‹çš„æŸå¤±</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>=</mo><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>(</mo><msup><mi>o</mi><mi>t</mi></msup><mo separator="true">,</mo><msup><mi>y</mi><mi>t</mi></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">L=loss(o^t,y^t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.843556em;"></span><span class="strut bottom" style="height:1.093556em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">L</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathit">s</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>å¾—åˆ°</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ajy6gd75j316o0u0n6u.jpg" alt="image-20221019135246524" /></p><h3 id="13-åå‘ä¼ æ’­çš„æ¢¯åº¦ä¸‹é™-back-propagation"><a class="markdownIt-Anchor" href="#13-åå‘ä¼ æ’­çš„æ¢¯åº¦ä¸‹é™-back-propagation"></a> 1.3 åå‘ä¼ æ’­çš„æ¢¯åº¦ä¸‹é™ Back Propagation</h3><p>åœ¨ä¹‹å‰ä¸­æˆ‘ä»¬åŒ…æ‹¬è‡³å°‘äº”ä¸ªå‚æ•°ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><msub><mi>W</mi><mrow><mi>x</mi><mi>h</mi></mrow></msub><mo separator="true">,</mo><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>h</mi></msub><mo separator="true">,</mo><msub><mi>W</mi><mrow><mi>h</mi><mi>o</mi></mrow></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>o</mi></msub><mo>]</mo></mrow><annotation encoding="application/x-tex">[W_{xh},W_{hh},b_h,W_{ho},b_o]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">x</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">h</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">]</span></span></span></span>,é€šè¿‡ä¸Šå¤„æ›´æ–°çš„å¼å­æˆ‘ä»¬è®¡ç®—ä¸åŒçš„æ¢¯åº¦,æ¯”å¦‚é’ˆå¯¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{hh}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></p>\begin{split}\begin{aligned}\frac{\partial L}{\partial w_{hh}}  & = \frac{1}{T}\sum_{t=1}^T \frac{\partial l(y_t, o_t)}{\partial w_{hh}}  \\& = \frac{1}{T}\sum_{t=1}^T \frac{\partial l(y_t, o_t)}{\partial o_t} \frac{\partial g(h_t, \theta_o)}{\partial h_t}  \frac{\partial h_t}{\partial w_{hh}}.\end{aligned}\end{split}<p>æ³¨æ„è¿™é‡Œçš„ç¬¬ä¸€é¡¹æˆ‘ä»¬æ˜¯çŸ¥é“çš„ï¼Œç¬¬äºŒé¡¹æˆ‘ä»¬ä¹Ÿæ˜¯çŸ¥é“çš„ï¼Œä½†æ˜¯ç¬¬ä¸‰é¡¹å®ƒæ˜¯ä¼šä¸€ç›´Recurrentè®¡ç®—ä¸‹å»çš„</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">âˆ‚</mi><msub><mi>h</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><msub><mi>w</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">âˆ‚</mi><mi>f</mi><mo>(</mo><msub><mi>x</mi><mrow><mi>t</mi></mrow></msub><mo separator="true">,</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>Î¸</mi><mi>h</mi></msub><mo>)</mo></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><msub><mi>Î¸</mi><mi>h</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">âˆ‚</mi><mi>f</mi><mo>(</mo><msub><mi>x</mi><mrow><mi>t</mi></mrow></msub><mo separator="true">,</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>Î¸</mi><mi>h</mi></msub><mo>)</mo></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">âˆ‚</mi><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><msub><mi>w</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{\partial h_t}{\partial w_{hh}}= \frac{\partial f(x_{t},h_{t-1},\theta_h)}{\partial \theta_h} +\frac{\partial f(x_{t},h_{t-1},\theta_h)}{\partial h_{t-1}} \frac{\partial h_{t-1}}{\partial w_{hh}}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.321331em;vertical-align:-0.894331em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">h</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">h</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">Î¸</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">h</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathrm">.</span></span></span></span></span></p><p>è¿™æ ·æ¢¯åº¦å…¶å®æ˜¯ä¼šéšç€æ—¶é—´tä¸æ–­æ‹‰é•¿ï¼Œè¿™é‡Œé€šå¸¸ç§°ä¸º<strong>é•¿æœŸä¾èµ–</strong>çš„é—®é¢˜è¿™æ ·æˆ‘ä»¬å¯èƒ½å‡ºç°æ¢¯åº¦æ¶ˆå¤±ã€æˆ–è€…æ¢¯åº¦çˆ†ç‚¸çš„æƒ…å†µã€‚å¸¸è§çš„æ“ä½œæœ‰ä¸‰ç§</p><ol><li>å®Œå…¨è®¡ç®—ç›´åˆ°æ”¶æ•›</li><li>é‡‡ç”¨Næ­¥é©¬å°”å¯å¤«æ¨¡å‹ï¼Œæ¥æˆªæ–­æ—¶é—´æ­¥ï¼Œåˆ°è¾¾æ—¶é—´æ­¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï„</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.1132em;">Ï„</span></span></span></span></li><li>é‡‡ç”¨éšæœºæˆªæ–­çš„æ€æƒ³</li></ol><p>è¿˜æœ‰é’ˆå¯¹æ¢¯åº¦çš„ä¸€äº›æ“ä½œï¼Œå¸¸è§çš„æœ‰<strong>æˆªæ–­æ¢¯åº¦</strong>å’Œ<strong>å¼•å¯¼ä¿¡æ¯æµçš„æ­£åˆ™åŒ–</strong>ï¼Œ</p><ul><li>é’ˆå¯¹æ¢¯åº¦çˆ†ç‚¸ï¼Œæˆªæ–­æ¢¯åº¦ä¹Ÿå°±æ˜¯åœ¨å‚æ•°æ›´æ–°ä¹‹å‰æˆªæ–­æ¢¯åº¦çš„èŒƒæ•°ï¼Œåœ¨æ—¶é—´çš„è¿‡ç¨‹ä¸­è¢«è¯æ˜æ˜¯æœ‰ç”¨çš„ã€‚</li><li>é’ˆå¯¹æ¢¯åº¦æ¶ˆå¤±ï¼Œå¼•å¯¼ä¿¡æ¯æµçš„æ­£åˆ™åŒ–ï¼Œä¸€ç§æ˜¯åŠ å…¥é—¨æ§å•å…ƒï¼ˆå¦‚LSTMã€GRUï¼‰ï¼Œä¹Ÿå¯ä»¥è§£å†³æ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ï¼›ä¸€ç§æ˜¯æ­£åˆ™åŒ–é¡¹ï¼Œåè€…è¢«è¯æ˜ä¸æœ‰æ•ˆ</li></ul><h3 id="14-è¿›ä¸€æ­¥-é«˜çº§ä¸€ç‚¹çš„rnn"><a class="markdownIt-Anchor" href="#14-è¿›ä¸€æ­¥-é«˜çº§ä¸€ç‚¹çš„rnn"></a> 1.4 è¿›ä¸€æ­¥ã€‚é«˜çº§ä¸€ç‚¹çš„RNN</h3><p>åœ¨å•å‘RNNçš„åŸºç¡€ä¸Šï¼Œå¯ä»¥è‡ªç„¶è€Œç„¶çš„è”æƒ³åˆ°</p><ol><li>åŒå‘RNN</li><li>æ·±åº¦RNN</li><li>é€’å½’ç¥ç»ç½‘ç»œï¼Œä¸€ä¸ªæ½œåœ¨çš„ideaæ˜¯ç ”ç©¶æ¨è®º</li><li>å¢åŠ é—¨æ§å•å…ƒçš„ä¸åŒå˜ç§GRUã€LSTM</li><li>åŸºäºencoder- decoderçš„seq2seqæ¡†æ¶</li><li>å›å£°çŠ¶æ€ç½‘ç»œï¼ˆecho state networkï¼‰ï¼Œæµä½“çŠ¶æ€æœºï¼ˆliquid state machinesï¼‰</li></ol><h3 id="15-å›è¿‡å¤´è§£é‡Šrnn"><a class="markdownIt-Anchor" href="#15-å›è¿‡å¤´è§£é‡Šrnn"></a> 1.5 å›è¿‡å¤´è§£é‡ŠRNN</h3><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥å›é¡¾æˆ‘ä»¬åœ¨æ—¶é—´åºåˆ—é¢„æµ‹ä¸­å¸¸ç”¨çš„ä¸€äº›æ–¹æ³•ï¼šè‡ªå›å½’æ¨¡å‹ã€éšå˜é‡è‡ªå›å½’æ¨¡å‹ã€é©¬å°”å¯å¤«æ¨¡å‹ã€å› æœå…³ç³»æ¨¡å‹ç­‰ç­‰ï¼Œå¸¸ç”¨çš„æ˜¯</p><ul><li><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>x</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">x_t=P(x_t|x_{t-1},...,x_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p></li></ul><p>å› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥å¸Œæœ›å¾—åˆ°</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>x</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>)</mo><mo>=</mo><mi>p</mi><mo>(</mo><msub><mi>x</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>x</mi><mi>t</mi></msub><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(x_t|x_{t-1},...,x_1)=p(x_t|x_t-1,h_{t-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>ä¹Ÿå°±æ˜¯å‡å¦‚ä¸€ä¸ªhidden stateæ¥ä½œä¸ºå¯¹ä¹‹å‰åºåˆ—æ€»ç»“ï¼Œå°†å…¶é€å…¥çŠ¶æ€è½¬å˜ä¸­ã€‚</p><h2 id="0x02-å˜ç§ä¸æ€è€ƒgru-lstm"><a class="markdownIt-Anchor" href="#0x02-å˜ç§ä¸æ€è€ƒgru-lstm"></a> 0x02 å˜ç§ä¸æ€è€ƒGRUã€LSTM</h2><p>æˆ‘ä»¬ä¹‹å‰åˆ†æäº†é•¿æœŸä¾èµ–å¯¹äºæ¢¯åº¦æ¶ˆå¤±æˆ–è€…æ¢¯åº¦çˆ†ç‚¸çš„å½±å“ï¼Œä»å®é™…æ•ˆæœæ¥çœ‹å®ƒçš„å½±å“æ˜¯ï¼š</p><ol><li>æ—©æœŸçš„é¢„æµ‹å€¼å¯¹é¢„æµ‹æ‰€æœ‰æœªæ¥é¢„æµ‹å€¼å…·æœ‰éå¸¸é‡è¦çš„æ„ä¹‰</li><li>ä¸€äº›è¯å…ƒæ²¡æœ‰ç›¸å…³çš„è§‚æµ‹å€¼ï¼Œæ¯”å¦‚å¯¹ç½‘é¡µå†…å®¹è¿›è¡Œæƒ…æ„Ÿåˆ†æå¯èƒ½æœ‰ä¸€äº›è¾…åŠ©HTMLä»£ç ä¸ç½‘é¡µä¼ è¾¾çš„æƒ…ç»ªæ— å…³</li><li>åºåˆ—ä¹‹é—´çš„ä¸åŒéƒ¨åˆ†ä¹‹é—´å­˜åœ¨é€»è¾‘ä¸­æ–­</li></ol><p>åœ¨è¿‡å»é‡‡å–è¿‡å¾ˆå¤šæ–¹æ³•æ¥è¿›è¡Œæ”¹è¿›ï¼Œç›®å‰ä¸»æµçš„æ˜¯ä½¿ç”¨é—¨æ§çš„æ–¹å¼æ¥ç¡®å®šä»€ä¹ˆæ—¶å€™æ›´æ–°hidden stateã€ä»€ä¹ˆæ—¶å€™é‡ç½®resetã€‚</p><p><a href="https://www.google.com.hk/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjmi4L93uv6AhVHed4KHVDfBIEQFnoECAwQAQ&amp;url=http%3A%2F%2Fwww.bioinf.jku.at%2Fpublications%2Folder%2F2604.pdf&amp;usg=AOvVaw3mXlGPo2DVtYp8Vue3sl4y">LSTM</a></p><h3 id="21-gate"><a class="markdownIt-Anchor" href="#21-gate"></a> 2.1 Gate</h3><p>è®¾è®¡ä¸ºï¼ˆ0ï¼Œ1ï¼‰åŒºé—´å†…çš„å‘é‡ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥è¿›è¡Œå‡¸ç»„åˆï¼šreset-gateå…è®¸æˆ‘ä»¬æ§åˆ¶å¯èƒ½è¿˜æƒ³è®°ä½çš„è¿‡å»çŠ¶æ€çš„æ•°é‡ï¼Œæ›´æ–°ä»¬èƒ½è®²å…è®¸æˆ‘ä»¬æ§åˆ¶æ–°çŠ¶æ€ä¸­æœ‰å¤šå°‘æ˜¯æ—§çŠ¶æ€çš„å‰¯æœ¬</p><p>å…·ä½“çš„è®¡ç®—è¿‡ç¨‹å¦‚å›¾ï¼š</p><ul><li><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mi>t</mi></msub><mo>=</mo><mi>Ïƒ</mi><mo>(</mo><msub><mi>X</mi><mi>t</mi></msub><msub><mi>W</mi><mrow><mi>x</mi><mi>r</mi></mrow></msub><mo>+</mo><msub><mi>H</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><msub><mi>W</mi><mrow><mi>h</mi><mi>r</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>r</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">R_t=\sigma (X_tW_{xr}+H_{t-1}W_{hr}+b_r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">x</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p></li><li><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Z</mi><mi>t</mi></msub><mo>=</mo><mi>Ïƒ</mi><mo>(</mo><msub><mi>X</mi><mi>t</mi></msub><msub><mi>W</mi><mrow><mi>x</mi><mi>z</mi></mrow></msub><mo>+</mo><msub><mi>H</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><msub><mi>W</mi><mrow><mi>h</mi><mi>z</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>z</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">Z_t=\sigma (X_tW_{xz}+H_{t-1}W_{hz}+b_z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">x</span><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>æ³¨æ„åœ¨æ±‚å’Œè¿‡ç¨‹ä¼šè§¦å‘ å¹¿æ’­æœºåˆ¶,ä½¿ç”¨sigmoidå‡½æ•°å°†å…¶è½¬æ¢åˆ°0ï¼Œ1åŒºé—´ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šæ›´æ–° å€™é€‰éšè—çŠ¶æ€</p></li><li><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>H</mi><mo>Â¯</mo></mover><mi>t</mi></msub><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo>(</mo><msub><mi>X</mi><mi>t</mi></msub><msub><mi>W</mi><mrow><mi>x</mi><mi>h</mi></mrow></msub><mo>+</mo><mo>(</mo><msub><mi>R</mi><mi>t</mi></msub><mo>âŠ—</mo><msub><mi>H</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>h</mi></msub><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\bar H_t=tanh(X_tW_{xh}+(R_t \otimes H_{t-1}W_{hh}+b_h))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8201099999999999em;"></span><span class="strut bottom" style="height:1.07011em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.08125em;">H</span></span><span style="top:-0.25233em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>Â¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">x</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âŠ—</span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">h</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p></li></ul><p>ä½¿ç”¨tanhéçº¿æ€§æ¿€æ´»å‡½æ•°æ¥ä¿è¯hidden stateä¸­çš„å€¼æ˜¯ä¿æŒåœ¨åŒºé—´-1ï¼Œ1ä¹‹é—´çš„ï¼›Hadamarå…ƒç´ è¡¨ç¤ºæŒ‰ç…§å…ƒç´ è¿›è¡Œä¹˜ç§¯æˆ‘ä»¬ç»“åˆæ›´æ–°é—¨æ¥å¯¹å€™é€‰éšè—çŠ¶æ€è¿›è¡Œè¿›ä¸€æ­¥çš„ä¿®æ­£ï¼Œå¾—åˆ°æœ€ç»ˆhidden stateçš„å–å€¼</p><ul><li><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mi>t</mi></msub><mo>=</mo><msub><mi>Z</mi><mi>t</mi></msub><mo>âŠ—</mo><msub><mi>H</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>Z</mi><mi>t</mi></msub><mo>)</mo><mo>âˆ—</mo><msub><mover accent="true"><mi>H</mi><mo>Â¯</mo></mover><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">H_t=Z_t \otimes H_{t-1}+(1-Z_t)*\bar H_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8201099999999999em;"></span><span class="strut bottom" style="height:1.07011em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âŠ—</span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ—</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.08125em;">H</span></span><span style="top:-0.25233em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>Â¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p></li></ul><p>ç”±æ­¤å¾—åˆ°é—¨æ§å¾ªç¯å•å…ƒå…·æœ‰ä¸¤ä¸ªæ˜¾è‘—çš„ç‰¹å¾</p><ul><li>resetæœ‰åŠ©äºæ•è·åºåˆ—ä¸­çš„çŸ­æœŸä¾èµ–å…³ç³»</li><li>updateræœ‰åŠ©äºæ•è·åºåˆ—ä¸­çš„é•¿æœŸä¾èµ–å…³ç³»</li></ul><h3 id="22-gru"><a class="markdownIt-Anchor" href="#22-gru"></a> 2.2 GRU</h3><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7amii4vvxj311a0oq75l.jpg" alt="image-20221019152134663" /></p><h3 id="23-lstm"><a class="markdownIt-Anchor" href="#23-lstm"></a> 2.3 LSTM</h3><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7amhtys6bj30xq0u0q8c.jpg" alt="image-20221019152055705" /></p><h3 id="24-drnn"><a class="markdownIt-Anchor" href="#24-drnn"></a> 2.4 DRNN</h3><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7amj3nijmj30pi0mcaba.jpg" alt="image-20221019152209098" /></p><h3 id="25-brnn"><a class="markdownIt-Anchor" href="#25-brnn"></a> 2.5 BRNN</h3><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7amjcxg6xj30pw0gsmyc.jpg" alt="image-20221019152224395" /></p><h2 id="0x03-é€»è¾‘è¿‡ç¨‹åˆ†æ"><a class="markdownIt-Anchor" href="#0x03-é€»è¾‘è¿‡ç¨‹åˆ†æ"></a> 0x03 é€»è¾‘è¿‡ç¨‹åˆ†æ</h2><h3 id="31-åºåˆ—æ•°æ®è¯»å–exampleæ–‡æœ¬æ•°æ®-token-vocab"><a class="markdownIt-Anchor" href="#31-åºåˆ—æ•°æ®è¯»å–exampleæ–‡æœ¬æ•°æ®-token-vocab"></a> 3.1 åºåˆ—æ•°æ®è¯»å–ï¼ˆexampleï¼šæ–‡æœ¬æ•°æ®ï¼‰-token-vocab</h3><p>é¦–å…ˆæ–‡æœ¬æ•°æ®é›†ä»æ–‡æœ¬è¯»å–å‡ºæ¥æ˜¯è¿™æ ·å­çš„</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7amtdmdsfj31ss0hkk0l.jpg" alt="æ–‡æœ¬æ•°æ®é›†time machine" /></p><p>æˆ‘ä»¬æ€»çš„ideaæ˜¯å¸Œæœ›å°†ä¸Šè¿°ä¸è§„åˆ™çš„æ–‡æœ¬ï¼Œè½¬æ¢ä¸ºå¯ä»¥ç”¨å‘é‡è¡¨ç¤ºçš„æ•°å­—ï¼Œä¸”ä¸ºåºåˆ—æ•°æ®ã€‚Obviouslyï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªè¯å…¸vocabæ¥å°†è¿™äº›è¯è¯­è½¬æ¢ç§°ä¸ºæ•°å­—ã€‚é‚£ä¹ˆè¿™ä¸ªè¯å…¸çš„é¡ºåºæ€ä¹ˆç¡®å®šï¼Ÿé€šå¸¸æ˜¯æ ¹æ®è¯çš„å‡ºç°é¢‘ç‡æ¥å®ç°çš„ã€‚åŒæ—¶å¯¹äºå‡ºç°é¢‘ç‡è¿‡å°‘çš„è¯å¯ä»¥ç”¨<unk>æˆ–è€…å…¶ä»–æ¥è¡¨ç¤ºã€‚åŠ å…¥æˆ‘ä»¬ä½¿ç”¨æ¯ä¸ªå•è¯æ¥è¡¨ç¤ºï¼Œå¾—åˆ°çš„vocabå°±æ˜¯</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7amyzuha1j30sa0hmgou.jpg" alt="vocab-word" /></p><p>é™¤äº†å•è¯æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å•ä¸ªå­—ç¬¦charæ¥åˆ†å‰²æ•°æ®é›†</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7an0pl9x1j316403mq35.jpg" alt="vocab-word" /></p><h3 id="32-æ•°æ®é¢„å¤„ç†-input-batchsizenum_stepsdataloader"><a class="markdownIt-Anchor" href="#32-æ•°æ®é¢„å¤„ç†-input-batchsizenum_stepsdataloader"></a> 3.2 æ•°æ®é¢„å¤„ç†-inputï¼š batchsizeï¼Œnum_stepsâ€“dataloader</h3><p>åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæˆ‘ä»¬å°±å¯ä»¥ç”Ÿæˆæˆ‘ä»¬çš„dataloaderï¼Œå› ä¸ºseqåºåˆ—å¤©ç„¶å°±æœ‰é¡ºåºæ€§ï¼Œè€Œä¸ºäº†æé«˜æ³›åŒ–æ€§æˆ‘ä»¬å¸Œæœ›ä»–ä»¬å¯ä»¥å­¦ä¹ åˆ°é¡ºåºæ€§ï¼Œä½†æ˜¯å­¦ä¹ çš„åˆä¸å¤ªå¤šï¼Œå› æ­¤ä¼šæœ‰ä¸¤ç§é‡‡æ ·æ–¹å¼æ¥åšï¼š</p><ol><li>éšæœºé‡‡æ ·</li><li>é¡ºåºåˆ†åŒº</li></ol><p>æ‰¹é‡çš„å¤§å°ç”±batchsizeæ¥ç¡®å®šï¼ŒåŒæ—¶å•æ¬¡è®­ç»ƒçš„é¡ºåºåŒ…æ‹¬num_stepsä¸ªå•è¯ï¼Œå› æ­¤ç»è¿‡è¿™æ ·æˆ‘ä»¬é‡‡å–é€å…¥ç½‘ç»œè®­ç»ƒçš„å•ä¸ªbatchçš„å½¢çŠ¶ä¸º</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mo>=</mo><mrow><msub><mi>X</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><mo separator="true">,</mo><mi>i</mi><mo>=</mo><mrow><msup><mi>X</mi><mn>1</mn></msup><mo separator="true">,</mo><msup><mi>X</mi><mn>2</mn></msup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msup><mi>X</mi><mrow><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow></msup></mrow><mo separator="true">;</mo><msub><mi>X</mi><mi>i</mi></msub><mo>âˆˆ</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>p</mi><mi>s</mi><mo separator="true">,</mo><mi>l</mi><mi>e</mi><mi>n</mi><mo>(</mo><mi>v</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>b</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">batch={X_i,y_i},i={X^1,X^2,..,X^{batchsize}};X_i\in\mathbb{R}^{num\_steps,len(vocab)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:1.0824399999999998em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">b</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">c</span><span class="mord mathit">h</span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">b</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">c</span><span class="mord mathit">h</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord mathit">e</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mpunct">;</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span><span class="mord mathit">u</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mord mathit">p</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">o</span><span class="mord mathit">c</span><span class="mord mathit">a</span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></p><p>æ€»ä½“çš„shapeå°±æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator="true">,</mo><mi>n</mi><mi>u</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>p</mi><mi>s</mi><mo separator="true">,</mo><mi>l</mi><mi>e</mi><mi>n</mi><mo>(</mo><mi>v</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>b</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(batchsize,num\_steps,len(vocab))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.06em;vertical-align:-0.31em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">b</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">c</span><span class="mord mathit">h</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">n</span><span class="mord mathit">u</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mord mathit">p</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">o</span><span class="mord mathit">c</span><span class="mord mathit">a</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p><p>è¿™é‡Œæœ‰ä¸ªæ“ä½œæ˜¯ä¸ºäº†åé¢å°æ‰¹é‡çŸ©é˜µè¿ç®—ï¼Œä¼šåšä¸€ä¸ªreshapeï¼Œå˜æˆ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>n</mi><mi>u</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>p</mi><mi>s</mi><mo separator="true">,</mo><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator="true">,</mo><mi>l</mi><mi>e</mi><mi>n</mi><mo>(</mo><mi>v</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>b</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(num\_steps,batchsize,len(vocab))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.06em;vertical-align:-0.31em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">n</span><span class="mord mathit">u</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mord mathit">p</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">b</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">c</span><span class="mord mathit">h</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">o</span><span class="mord mathit">c</span><span class="mord mathit">a</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>;å¯ä»¥è‡ªè¡Œè®¡ç®—æ¢¯åº¦å˜æ¢çš„æ–¹å¼ä½“ä¼š</p><h3 id="33-æ¨¡å‹ä¸»å¹²-model-loss-optim"><a class="markdownIt-Anchor" href="#33-æ¨¡å‹ä¸»å¹²-model-loss-optim"></a> 3.3 æ¨¡å‹ä¸»å¹²-model-loss-optim</h3><p>åˆå§‹åŒ–å‚æ•°</p><p>é€‰æ‹©é€‚åˆçš„loss</p><p>å®šä¹‰RNN model</p><h3 id="34-è®­ç»ƒä¸å¯è§†åŒ–-train-predict-ppl"><a class="markdownIt-Anchor" href="#34-è®­ç»ƒä¸å¯è§†åŒ–-train-predict-ppl"></a> 3.4 è®­ç»ƒä¸å¯è§†åŒ–- train- predict-ppl</h3><p>trainä¹Ÿå°±æ˜¯è®¾ç½®learning rateå’Œepochè®­ç»ƒå°±å¥½äº†</p><h2 id="0x04-ä»£ç å®ç°123"><a class="markdownIt-Anchor" href="#0x04-ä»£ç å®ç°123"></a> 0x04 ä»£ç å®ç°1ï¼Œ2ï¼Œ3</h2><p>è¿™é‡Œå®Œå…¨å‚è€ƒææ²å¤§å¤§çš„ä»£ç ï¼Œç„¶åå°†å…¶ä¸­çš„d2lçš„éƒ¨åˆ†å®Œå…¨å‰”é™¤å¾—åˆ°å¦‚ä¸‹çš„ä»£ç </p><h3 id="41-æ•°æ®é›†è¯»å–è®¾ç½®"><a class="markdownIt-Anchor" href="#41-æ•°æ®é›†è¯»å–è®¾ç½®"></a> 4.1 æ•°æ®é›†è¯»å–è®¾ç½®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> math<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">from</span> torch.nn <span class="hljs-keyword">import</span> functional <span class="hljs-keyword">as</span> F<br><span class="hljs-comment">## ææ²ä¸­d2læœåŠ¡å™¨ä¸­å­˜å‚¨çš„æ•°æ®</span><br>DATA_HUB = <span class="hljs-built_in">dict</span>()<br>DATA_URL = <span class="hljs-string">&#x27;http://d2l-data.s3-accelerate.amazonaws.com/&#x27;</span><br>dataset=<span class="hljs-string">&#x27;time_machine&#x27;</span><br>dataset_sha256=<span class="hljs-string">&#x27;090b5e7e70c295757f55df93cb0a180b9691891a&#x27;</span><br>DATA_HUB[dataset]=(DATA_URL+<span class="hljs-string">&#x27;timemachine.txt&#x27;</span>,dataset_sha256)<br><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">download</span>(<span class="hljs-params">name, cache_dir=os.path.join(<span class="hljs-params"><span class="hljs-string">&#x27;..&#x27;</span>, <span class="hljs-string">&#x27;data&#x27;</span></span>)</span>):  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;ä¸‹è½½ä¸€ä¸ªDATA_HUBä¸­çš„æ–‡ä»¶ è¿”å›æœ¬åœ°æ–‡ä»¶å&quot;&quot;&quot;</span><br>    url, sha1_hash = DATA_HUB[name]<br>    os.makedirs(cache_dir, exist_ok=<span class="hljs-literal">True</span>)<br>    fname = os.path.join(cache_dir, url.split(<span class="hljs-string">&#x27;/&#x27;</span>)[-<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">if</span> os.path.exists(fname):<br>        sha1 = hashlib.sha1()<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(fname, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                data = f.read(<span class="hljs-number">1048576</span>)<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> data:<br>                    <span class="hljs-keyword">break</span><br>                sha1.update(data)<br>        <span class="hljs-keyword">if</span> sha1.hexdigest() == sha1_hash:<br>            <span class="hljs-keyword">return</span> fname  <span class="hljs-comment"># å‘½ä¸­ç¼“å­˜</span><br>    r = requests.get(url, stream=<span class="hljs-literal">True</span>, verify=<span class="hljs-literal">True</span>)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(fname, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(r.content)<br>    <span class="hljs-keyword">return</span> fname<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_time_machine</span>():  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;å°†æ—¶é—´æœºå™¨æ•°æ®é›†åŠ è½½åˆ°æ–‡æœ¬è¡Œçš„åˆ—è¡¨ä¸­&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(download(<span class="hljs-string">&#x27;time_machine&#x27;</span>), <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        lines = f.readlines()<br>    <span class="hljs-keyword">return</span> [re.sub(<span class="hljs-string">&#x27;[^A-Za-z]+&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, line).strip().lower() <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize</span>(<span class="hljs-params">lines, token=<span class="hljs-string">&#x27;char&#x27;</span></span>):  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;å°†æ–‡æœ¬è¡Œæ‹†åˆ†ä¸ºå•è¯æˆ–å­—ç¬¦&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> token == <span class="hljs-string">&#x27;word&#x27;</span>:<br>        <span class="hljs-keyword">return</span> [line.split(<span class="hljs-string">&#x27; &#x27;</span>) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines]<br>    <span class="hljs-keyword">elif</span> token == <span class="hljs-string">&#x27;char&#x27;</span>:<br>        <span class="hljs-keyword">return</span> [<span class="hljs-built_in">list</span>(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines]<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;é”™è¯¯ï¼šæœªçŸ¥ä»¤ç‰Œç±»å‹ï¼š&#x27;</span>+token)<br><br><span class="hljs-keyword">import</span> collections  <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vocab</span>:  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;æ–‡æœ¬è¯è¡¨&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, tokens=<span class="hljs-literal">None</span>, min_freq=<span class="hljs-number">0</span>, reserved_tokens=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-keyword">if</span> tokens <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            tokens = []<br>        <span class="hljs-keyword">if</span> reserved_tokens <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            reserved_tokens = []<br>        <span class="hljs-comment"># æŒ‰å‡ºç°é¢‘ç‡æ’åº</span><br>        counter = count_corpus(tokens)<br>        self._token_freqs = <span class="hljs-built_in">sorted</span>(counter.items(), key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>],<br>                                   reverse=<span class="hljs-literal">True</span>)<br>        <span class="hljs-comment"># æœªçŸ¥è¯å…ƒçš„ç´¢å¼•ä¸º0</span><br>        self.idx_to_token = [<span class="hljs-string">&#x27;&lt;unk&gt;&#x27;</span>] + reserved_tokens<br>        self.token_to_idx = &#123;token: idx<br>                             <span class="hljs-keyword">for</span> idx, token <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(self.idx_to_token)&#125;<br>        <span class="hljs-keyword">for</span> token, freq <span class="hljs-keyword">in</span> self._token_freqs:<br>            <span class="hljs-keyword">if</span> freq &lt; min_freq:<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">if</span> token <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> self.token_to_idx:<br>                self.idx_to_token.append(token)<br>                self.token_to_idx[token] = <span class="hljs-built_in">len</span>(self.idx_to_token) - <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__len__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.idx_to_token)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getitem__</span>(<span class="hljs-params">self, tokens</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(tokens, (<span class="hljs-built_in">list</span>, <span class="hljs-built_in">tuple</span>)):<br>            <span class="hljs-keyword">return</span> self.token_to_idx.get(tokens, self.unk)<br>        <span class="hljs-keyword">return</span> [self.__getitem__(token) <span class="hljs-keyword">for</span> token <span class="hljs-keyword">in</span> tokens]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">to_tokens</span>(<span class="hljs-params">self, indices</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(indices, (<span class="hljs-built_in">list</span>, <span class="hljs-built_in">tuple</span>)):<br>            <span class="hljs-keyword">return</span> self.idx_to_token[indices]<br>        <span class="hljs-keyword">return</span> [self.idx_to_token[index] <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> indices]<br><br><span class="hljs-meta">    @property</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">unk</span>(<span class="hljs-params">self</span>):  <span class="hljs-comment"># æœªçŸ¥è¯å…ƒçš„ç´¢å¼•ä¸º0</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br><span class="hljs-meta">    @property</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">token_freqs</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> self._token_freqs<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">count_corpus</span>(<span class="hljs-params">tokens</span>):  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;ç»Ÿè®¡è¯å…ƒçš„é¢‘ç‡&quot;&quot;&quot;</span><br>    <span class="hljs-comment"># è¿™é‡Œçš„tokensæ˜¯1Dåˆ—è¡¨æˆ–2Dåˆ—è¡¨</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(tokens) == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">isinstance</span>(tokens[<span class="hljs-number">0</span>], <span class="hljs-built_in">list</span>):<br>        <span class="hljs-comment"># å°†è¯å…ƒåˆ—è¡¨å±•å¹³æˆä¸€ä¸ªåˆ—è¡¨</span><br>        tokens = [token <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> tokens <span class="hljs-keyword">for</span> token <span class="hljs-keyword">in</span> line]<br>    <span class="hljs-keyword">return</span> collections.Counter(tokens)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_corpus_time_machine</span>(<span class="hljs-params">max_tokens=-<span class="hljs-number">1</span></span>):  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;è¿”å›æ—¶å…‰æœºå™¨æ•°æ®é›†çš„è¯å…ƒç´¢å¼•åˆ—è¡¨å’Œè¯è¡¨&quot;&quot;&quot;</span><br>    lines = read_time_machine()<br>    tokens = tokenize(lines, <span class="hljs-string">&#x27;char&#x27;</span>)<br>    vocab = Vocab(tokens)<br>    <span class="hljs-built_in">print</span>(vocab.idx_to_token)<br>    <span class="hljs-comment"># å› ä¸ºæ—¶å…‰æœºå™¨æ•°æ®é›†ä¸­çš„æ¯ä¸ªæ–‡æœ¬è¡Œä¸ä¸€å®šæ˜¯ä¸€ä¸ªå¥å­æˆ–ä¸€ä¸ªæ®µè½ï¼Œ</span><br>    <span class="hljs-comment"># æ‰€ä»¥å°†æ‰€æœ‰æ–‡æœ¬è¡Œå±•å¹³åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­</span><br>    corpus = [vocab[token] <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> tokens <span class="hljs-keyword">for</span> token <span class="hljs-keyword">in</span> line]<br>    <span class="hljs-keyword">if</span> max_tokens &gt; <span class="hljs-number">0</span>:<br>        corpus = corpus[:max_tokens]<br>    <span class="hljs-keyword">return</span> corpus, vocab<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">seq_data_iter_random</span>(<span class="hljs-params">corpus, batch_size, num_steps</span>):  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;ä½¿ç”¨éšæœºæŠ½æ ·ç”Ÿæˆä¸€ä¸ªå°æ‰¹é‡å­åºåˆ—&quot;&quot;&quot;</span><br>    <span class="hljs-comment"># ä»éšæœºåç§»é‡å¼€å§‹å¯¹åºåˆ—è¿›è¡Œåˆ†åŒºï¼ŒéšæœºèŒƒå›´åŒ…æ‹¬num_steps-1</span><br>    corpus = corpus[random.randint(<span class="hljs-number">0</span>, num_steps - <span class="hljs-number">1</span>):]<br>    <span class="hljs-comment"># å‡å»1ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦è€ƒè™‘æ ‡ç­¾</span><br>    num_subseqs = (<span class="hljs-built_in">len</span>(corpus) - <span class="hljs-number">1</span>) // num_steps<br>    <span class="hljs-comment"># é•¿åº¦ä¸ºnum_stepsçš„å­åºåˆ—çš„èµ·å§‹ç´¢å¼•</span><br>    initial_indices = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, num_subseqs * num_steps, num_steps))<br>    <span class="hljs-comment"># åœ¨éšæœºæŠ½æ ·çš„è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œ</span><br>    <span class="hljs-comment"># æ¥è‡ªä¸¤ä¸ªç›¸é‚»çš„ã€éšæœºçš„ã€å°æ‰¹é‡ä¸­çš„å­åºåˆ—ä¸ä¸€å®šåœ¨åŸå§‹åºåˆ—ä¸Šç›¸é‚»</span><br>    random.shuffle(initial_indices)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">data</span>(<span class="hljs-params">pos</span>):<br>        <span class="hljs-comment"># è¿”å›ä»posä½ç½®å¼€å§‹çš„é•¿åº¦ä¸ºnum_stepsçš„åºåˆ—</span><br>        <span class="hljs-keyword">return</span> corpus[pos: pos + num_steps]<br><br>    num_batches = num_subseqs // batch_size<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, batch_size * num_batches, batch_size):<br>        <span class="hljs-comment"># åœ¨è¿™é‡Œï¼Œinitial_indicesåŒ…å«å­åºåˆ—çš„éšæœºèµ·å§‹ç´¢å¼•</span><br>        initial_indices_per_batch = initial_indices[i: i + batch_size]<br>        X = [data(j) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> initial_indices_per_batch]<br>        Y = [data(j + <span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> initial_indices_per_batch]<br>        <span class="hljs-keyword">yield</span> torch.tensor(X), torch.tensor(Y)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">seq_data_iter_sequential</span>(<span class="hljs-params">corpus, batch_size, num_steps</span>):  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;ä½¿ç”¨é¡ºåºåˆ†åŒºç”Ÿæˆä¸€ä¸ªå°æ‰¹é‡å­åºåˆ—&quot;&quot;&quot;</span><br>    <span class="hljs-comment"># ä»éšæœºåç§»é‡å¼€å§‹åˆ’åˆ†åºåˆ—</span><br>    offset = random.randint(<span class="hljs-number">0</span>, num_steps)<br>    num_tokens = ((<span class="hljs-built_in">len</span>(corpus) - offset - <span class="hljs-number">1</span>) // batch_size) * batch_size<br>    Xs = torch.tensor(corpus[offset: offset + num_tokens])<br>    Ys = torch.tensor(corpus[offset + <span class="hljs-number">1</span>: offset + <span class="hljs-number">1</span> + num_tokens])<br>    Xs, Ys = Xs.reshape(batch_size, -<span class="hljs-number">1</span>), Ys.reshape(batch_size, -<span class="hljs-number">1</span>)<br>    num_batches = Xs.shape[<span class="hljs-number">1</span>] // num_steps<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, num_steps * num_batches, num_steps):<br>        X = Xs[:, i: i + num_steps]<br>        Y = Ys[:, i: i + num_steps]<br>        <span class="hljs-keyword">yield</span> X, Y<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SeqDataLoader</span>:  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;åŠ è½½åºåˆ—æ•°æ®çš„è¿­ä»£å™¨&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, batch_size, num_steps, use_random_iter, max_tokens</span>):<br>        <span class="hljs-keyword">if</span> use_random_iter:<br>            self.data_iter_fn = seq_data_iter_random<br>        <span class="hljs-keyword">else</span>:<br>            self.data_iter_fn = seq_data_iter_sequential<br>        self.corpus, self.vocab = load_corpus_time_machine(max_tokens)<br>        self.batch_size, self.num_steps = batch_size, num_steps<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__iter__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> self.data_iter_fn(self.corpus, self.batch_size, self.num_steps)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_data_time_machine</span>(<span class="hljs-params">batch_size, num_steps,  <span class="hljs-comment">#@save</span></span><br><span class="hljs-params">                           use_random_iter=<span class="hljs-literal">False</span>, max_tokens=<span class="hljs-number">10000</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;è¿”å›æ—¶å…‰æœºå™¨æ•°æ®é›†çš„è¿­ä»£å™¨å’Œè¯è¡¨&quot;&quot;&quot;</span><br>    data_iter = SeqDataLoader(<br>        batch_size, num_steps, use_random_iter, max_tokens)<br>    <span class="hljs-keyword">return</span> data_iter, data_iter.vocab<br></code></pre></td></tr></table></figure><h3 id="42-æ¨¡å‹æ­å»º"><a class="markdownIt-Anchor" href="#42-æ¨¡å‹æ­å»º"></a> 4.2 æ¨¡å‹æ­å»º</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">## define the RNN layer</span><br>num_hiddens=<span class="hljs-number">256</span><br>rnn_layer=nn.RNN(<span class="hljs-built_in">len</span>(vocab),num_hiddens)<br><br><span class="hljs-comment">## define the hidden state</span><br>state=torch.zeros((<span class="hljs-number">1</span>,batch_size,num_hiddens))<br><br><span class="hljs-comment">## define the RNN model</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RNNmodel</span>(nn.Module):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;Recurrent nerual netowrk model&#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,rnn_layer,vocab_size,**kwargs</span>):<br>        <span class="hljs-built_in">super</span>(RNNmodel,self).__init__(**kwargs)<br>        self.rnn=rnn_layer<br>        self.vocab_size=vocab_size<br>        self.num_hiddens=self.rnn.hidden_size<br><br>        <span class="hljs-comment"># prepare for the GRU</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.rnn.bidirectional:<br>            self.num_directions=<span class="hljs-number">1</span><br>            self.linear=nn.Linear(self.num_hiddens,self.vocab_size)<br>        <span class="hljs-keyword">else</span>:<br>            self.num_directions=<span class="hljs-number">2</span><br>            self.linear=nn.Linear(self.num_hiddens*<span class="hljs-number">2</span>,self.vocab_size)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self,inputs,state</span>):<br>        X=F.one_hot(inputs.T.long(),self.vocab_size)<br>        X=X.to(torch.float32)<br>        Y,state=self.rnn(X,state)<br><br>        <span class="hljs-comment"># è½¬æ¢yä¸ºnum_steps,batch_size,num_hiddens</span><br>        output=self.linear(Y.reshape((-<span class="hljs-number">1</span>,Y.shape[-<span class="hljs-number">1</span>])))<br>        <span class="hljs-keyword">return</span> output,state<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">begin_state</span>(<span class="hljs-params">self,device,batch_size=<span class="hljs-number">1</span></span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(self.rnn,nn.LSTM):<br>            <span class="hljs-keyword">return</span> torch.zeros(self.num_directions*self.rnn.num_layers,batch_size,self.num_hiddens,device=device)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># nn.LSTM is hidden state as dict</span><br>            <span class="hljs-keyword">return</span> (torch.zeros((<br>                self.num_directions*self.rnn.num_layers,<br>                batch_size,<br>                self.num_hiddens),device=device),<br>                torch.zeros((self.num_directions*self.rnn.num_layers,<br>                batch_size,self.num_hiddens),<br>                device=device<br>            ))<br></code></pre></td></tr></table></figure><h3 id="43-é¢„æµ‹ä¸è®­ç»ƒ"><a class="markdownIt-Anchor" href="#43-é¢„æµ‹ä¸è®­ç»ƒ"></a> 4.3 é¢„æµ‹ä¸è®­ç»ƒ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">try_gpu</span>(<span class="hljs-params">i=<span class="hljs-number">0</span></span>):  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;å¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å›gpu(i)ï¼Œå¦åˆ™è¿”å›cpu()&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> torch.cuda.device_count() &gt;= i + <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> torch.device(<span class="hljs-string">f&#x27;cuda:<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>)<br>    <span class="hljs-keyword">return</span> torch.device(<span class="hljs-string">&#x27;cpu&#x27;</span>)<br>device=try_gpu()<br>net=RNNmodel(rnn_layer,vocab_size=<span class="hljs-built_in">len</span>(vocab))<br>net=net.to(device)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">predict_ch8</span>(<span class="hljs-params">prefix, num_preds, net, vocab, device</span>):  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;åœ¨prefixåé¢ç”Ÿæˆæ–°å­—ç¬¦&quot;&quot;&quot;</span><br>    state = net.begin_state(batch_size=<span class="hljs-number">1</span>, device=device)<br>    outputs = [vocab[prefix[<span class="hljs-number">0</span>]]]<br><br>    get_input = <span class="hljs-keyword">lambda</span>: torch.tensor([outputs[-<span class="hljs-number">1</span>]], device=device).reshape((<span class="hljs-number">1</span>, <span class="hljs-number">1</span>))<br><br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> prefix[<span class="hljs-number">1</span>:]:  <span class="hljs-comment"># é¢„çƒ­æœŸ</span><br>        _, state = net(get_input(), state)<br>        outputs.append(vocab[y])<br><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_preds):  <span class="hljs-comment"># é¢„æµ‹num_predsæ­¥</span><br>        y, state = net(get_input(), state)<br>        outputs.append(<span class="hljs-built_in">int</span>(y.argmax(dim=<span class="hljs-number">1</span>).reshape(<span class="hljs-number">1</span>)))<br>        <br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join([vocab.idx_to_token[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> outputs])<br><br>predict_ch8(<span class="hljs-string">&#x27;time traveller&#x27;</span>,<span class="hljs-number">10</span>,net,vocab,device)<br></code></pre></td></tr></table></figure><p>ä¸‹é¢é€‰æ‹©ä¸€ä¸ªæ¨¡å‹å°±ok</p><ol><li><pre class="highlight"><code class=""># å®é™…è®­ç»ƒè¿‡ç¨‹# params settingfrom matplotlib.pyplot import isinteractive# model settingnet=RNNmodel(rnn_layer,vocab_size=len(vocab))net=net.to(device)<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><br><span class="hljs-number">2.</span> ```<br>   # ç¬¬äºŒç§GRU<br>   num_inputs=len(vocab)<br>   gru_layer=nn.<span class="hljs-constructor">GRU(<span class="hljs-params">num_inputs</span>,<span class="hljs-params">num_hiddens</span>)</span><br>   net=<span class="hljs-constructor">RNNmodel(<span class="hljs-params">gru_layer</span>,<span class="hljs-params">len</span>(<span class="hljs-params">vocab</span>)</span>)<br>   net=net.<span class="hljs-keyword">to</span>(device)<br></code></pre></td></tr></table></figure></code></pre></li><li><pre class="highlight"><code class=""># ç¬¬ä¸‰ç§LSTMnum_inputs=len(vocab)num_layers=2lstm_layer=nn.LSTM(num_inputs,num_hiddens,num_layers)net=RNNmodel(lstm_layer,len(vocab))net=net.to(device)<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>4. ```<br>   # ç¬¬å››ç§ Deep-LSTM<br>   <span class="hljs-attribute">num_inputs</span>=len(vocab)<br>   <span class="hljs-attribute">num_layers</span>=32<br>   <span class="hljs-attribute">lstm_layer</span>=nn.LSTM(num_inputs,num_hiddens,num_layers)<br>   <span class="hljs-attribute">net</span>=RNNmodel(lstm_layer,len(vocab))<br>   <span class="hljs-attribute">net</span>=net.to(device)<br></code></pre></td></tr></table></figure></code></pre></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs python">num_epochs, lr = <span class="hljs-number">5000</span>, <span class="hljs-number">0.5</span><br><span class="hljs-comment"># loss function</span><br>loss=nn.CrossEntropyLoss()<br><br><span class="hljs-comment"># optimer or updater</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sgd</span>(<span class="hljs-params">params, lr, batch_size</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Minibatch stochastic gradient descent.</span><br><span class="hljs-string">    Defined in :numref:`sec_utils`&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        <span class="hljs-keyword">for</span> param <span class="hljs-keyword">in</span> params:<br>            param -= lr * param.grad / batch_size<br>            param.grad.zero_()<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(net,nn.Module):<br>    <span class="hljs-comment"># what is for??</span><br>    updater=torch.optim.SGD(net.parameters(),lr)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;net is not as nnModule&#x27;</span>)<br>    updater=<span class="hljs-keyword">lambda</span> batch_size:sgd(net.params,lr,batch_size)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">grad_clipping</span>(<span class="hljs-params">net, theta</span>):  <span class="hljs-comment">#@save</span><br>    <span class="hljs-string">&quot;&quot;&quot;è£å‰ªæ¢¯åº¦&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(net, nn.Module):<br>        params = [p <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> net.parameters() <span class="hljs-keyword">if</span> p.requires_grad]<br>    <span class="hljs-keyword">else</span>:<br>        params = net.params<br>    norm = torch.sqrt(<span class="hljs-built_in">sum</span>(torch.<span class="hljs-built_in">sum</span>((p.grad ** <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> params))<br>    <span class="hljs-keyword">if</span> norm &gt; theta:<br>        <span class="hljs-keyword">for</span> param <span class="hljs-keyword">in</span> params:<br>            param.grad[:] *= theta / norm<br><br>predict=<span class="hljs-keyword">lambda</span> prefix:predict_ch8(prefix,<span class="hljs-number">50</span>,net,vocab,device)<br><br>use_random_iter=<span class="hljs-literal">False</span><br><br><span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_epoches):<br>    state=<span class="hljs-literal">None</span><br>    res=[]<br>    <span class="hljs-keyword">for</span> X,Y <span class="hljs-keyword">in</span> train_iter:<br>        <span class="hljs-keyword">if</span> state <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> use_random_iter:<br>            state=net.begin_state(batch_size=X.shape[<span class="hljs-number">0</span>],device=device)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(net,nn.Module) <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(state,<span class="hljs-built_in">tuple</span>):<br>                state.detach_()<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> state:<br>                    s.detach_()<br>        <br>        y=Y.T.reshape(-<span class="hljs-number">1</span>)<br>        X,y=X.to(device),y.to(device)<br>        y_hat,state=net(X,state)<br>        l=loss(y_hat,y.long()).mean()<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(updater,torch.optim.Optimizer):<br>            <span class="hljs-comment"># judge is handSGD</span><br>            updater.zero_grad()<br>            l.backward()<br>            grad_clipping(net,<span class="hljs-number">1</span>)<br>            updater.step()<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># define in d2l.sgd</span><br>            l.backward()<br>            grad_clipping(net,<span class="hljs-number">1</span>)<br>            updater(batch_size=<span class="hljs-number">1</span>)<br>        res.append(l)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;å›°æƒ‘åº¦&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(res[-<span class="hljs-number">1</span>])))<br></code></pre></td></tr></table></figure><h3 id="45-ç»“æœ"><a class="markdownIt-Anchor" href="#45-ç»“æœ"></a> 4.5 ç»“æœ</h3><ol><li>è‚¯å®šéƒ½èƒ½è®­ç»ƒå‡ºæ¥</li></ol><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7anjshbv2j30vq0oewfb.jpg" alt="GRUç»“æœ" /></p><ol><li>ä½¿ç”¨wordçš„è®­ç»ƒæ—¶é—´ä¼šå¤§äºcharå¾ˆå¤š</li></ol><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7anktytexj322w0iq7bj.jpg" alt="wordçš„è®­ç»ƒè¿‡ç¨‹" /></p><p>ç»™ä»–ä¸€ä¸ªtime travellerï¼Œå¯ä»¥å¾—åˆ°è¿™ä¸ªï¼š</p><p>time traveller stooping to light a spill at the fire then he turned lighting his pipe to look at the psychologist s face the psychologist to show that he was not unhinged helped himself to a cigar and tried to light it uncut what is more i have a big machine nearly</p><p>-----</p><p>æ—¶é—´æ—…è¡Œè€…å¼¯è…°åœ¨ç«ä¸Šç‚¹ç‡ƒä¸€ä¸ªæº¢å‡ºç‰©ï¼Œç„¶åä»–è½¬åŠ¨ç‚¹äº®ä»–çš„çƒŸæ–—ï¼Œçœ‹ç€å¿ƒç†å­¦å®¶çš„è„¸ï¼Œå¿ƒç†å­¦å®¶è¡¨æ˜ä»–ä¸æ˜¯ä¸åˆæ—¶å®œåœ°å¸®åŠ©è‡ªå·±æŠ½é›ªèŒ„ï¼Œå¹¶è¯•å›¾ç‚¹ç‡ƒå®ƒæœªåˆ‡å‰²ï¼Œæ›´é‡è¦çš„æ˜¯æˆ‘æœ‰ä¸€ä¸ªå¤§æœºå™¨å‡ ä¹</p><ol><li>æ·±å±‚RNNä¸ä¸€å®šæœ‰æ•ˆ</li></ol><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h7ang0qtdej30w80ny0tu.jpg" alt="32å±‚LSTMçš„ç»“æœ" /></p><h2 id="0x05-discussionä¸ªäººè§è¯†"><a class="markdownIt-Anchor" href="#0x05-discussionä¸ªäººè§è¯†"></a> 0x05 Discussionï¼ˆä¸ªäººè§è¯†ï¼‰</h2><ol><li><p>MLPæˆ–è€…CNNæœ‰ç‚¹åƒé¡ºåºç»“æ„ï¼ŒRNNæœ‰ç‚¹åƒå¾ªç¯ç»“æ„ï¼ŒAttentionæœ‰ç‚¹åƒåˆ¤æ–­ç»“æ„</p></li><li><p>ä¸åŒç»“æ„å¸¦æ¥çš„æ˜¯ä¸åŒçš„æ„Ÿå—é‡ï¼ŒMLPçš„æ„Ÿå—é‡æ˜¯ä¸ªç‚¹ï¼ŒCNNçš„æ„Ÿå—é‡å¯èƒ½æ˜¯é•¿æ–¹å½¢ï¼ŒRNNçš„æ„Ÿå—é‡å¯èƒ½æ˜¯å¾ˆé•¿çš„åºåˆ—ï¼ŒAttentionåˆ™æ˜¯é€‰æ‹©æ„Ÿå—é‡</p></li><li><p>RNNå¾ˆåœŸ</p></li></ol><p><a href="https://cloud.tencent.com/developer/article/1664708">åºåˆ—æ¨¡å‹â€”â€”å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨‹ç¬”è®°ï¼ˆäº”ï¼‰</a></p><p><a href="https://zh-v2.d2l.ai/chapter_natural-language-processing-pretraining/bert.html">åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ </a></p><p><a href="https://www.deeplearningbook.org">Deep learningï¼Œlan Goodfellow.etal</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æ‰¿æ¥ä¸Šä¸€ä¼šå¯¹Attentionä¸­seq2seqçš„æ¨¡å‹çš„å›°æƒ‘ï¼Œè¿™é‡Œä»RNNåˆ°ä»‹ç»åˆ°æ›´ä¼ ç»Ÿçš„Seq2Seqæ¨¡å‹ã€‚åŒæ—¶ç»“åˆæœ€è¿‘æ¥è§¦çš„èŠ±ä¹¦æ¥åˆ©ç”¨æ›´æœ‰åˆ©çš„å·¥å…·è§£é‡ŠRNNä¸­çš„æ¢¯åº¦ã€‚å¹¶ç»™å‡ºåºåˆ—å­¦ä¹ ä¸­å¯¹äºgradientæˆ–è€…hidden stateè½¬å˜çš„è¿‡ç¨‹ï¼Œåœ¨é’ˆå¯¹hidden stateä¸­çš„è½¬å˜ä¸­å¼•ç”³å‡ºGRUã€LSTMä¹‹ç±»çš„å˜ç§ï¼Œå¹¶ç»“åˆD@Lç»™å‡ºä»£ç çš„å®ç°ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="ML&amp;DL" scheme="https://blog.tjdata.site/categories/ML-DL/"/>
    
    
    <category term="D2L" scheme="https://blog.tjdata.site/tags/D2L/"/>
    
  </entry>
  
  <entry>
    <title>åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ 04_Attention</title>
    <link href="https://blog.tjdata.site/posts/907ab853.html"/>
    <id>https://blog.tjdata.site/posts/907ab853.html</id>
    <published>2022-10-13T02:23:50.000Z</published>
    <updated>2023-05-13T13:51:55.258Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ¥å°±ä»¥Attentionä¸ºåŸºç¡€çš„Transformerç»“æ„å¾ˆæ„Ÿå…´è¶£ï¼Œæƒ³ç›´æ¥ä»CNNè·³åˆ°Attentionæ¥å­¦ä¹ ï¼Œä½†æ˜¯é€šè¿‡äº†è§£ä¸€äº›åŸºæœ¬çš„èƒŒæ™¯å‘ç°å¹¶ä¸ç°å®ï¼Œtransformerçš„æå‡ºæœ¬æ¥å°±æ˜¯åœ¨æœºå™¨ç¿»è¯‘çš„åŸºç¡€ä¸Šï¼Œæ‰€ä»¥å…ˆå¤©çš„åœ¨ä¸€äº›é—®é¢˜åœºæ™¯çš„è§£é‡Šä¸­å¹¶ä¸æ˜¯ä»¥å›å½’æ•°æ®ã€æˆ–è€…è¯´äºŒç»´å›¾åƒæ•°æ®ï¼Œè€Œæ˜¯åŸºäºåºåˆ—ï¼ˆseqï¼‰ç±»å‹çš„æ•°æ®è¿›è¡Œè§£é‡Šçš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨äº†è§£è®¤æ¸…æ¥šseq2seqå­¦ä¹ ä¹‹åæ‰èƒ½å¯¹attentionæœ‰ä¸€äº›ç†è§£ã€‚è¿™æ¬¡åªæ˜¯å¯¹attentionä½œä¸ºç®€å•çš„äº†è§£ï¼Œå¹¶å¯¹æ·±åº¦å­¦ä¹ ä¸­ä¸€äº›åšå‡ºreviewï¼Œæ¥ä¿®æ­£è‡ªå·±ä¹‹å‰é”™è¯¯çš„çœ‹æ³•ä»¥åŠé‡å»ºæ–°çš„ä¸–ç•Œè§‚ã€‚</p><h2 id="0x01-ä»€ä¹ˆæ˜¯attentionæ–‡å­—ç‰ˆ"><a class="markdownIt-Anchor" href="#0x01-ä»€ä¹ˆæ˜¯attentionæ–‡å­—ç‰ˆ"></a> 0x01 ä»€ä¹ˆæ˜¯Attentionï¼ˆæ–‡å­—ç‰ˆï¼‰</h2><h3 id="11-ä»ç”Ÿç‰©å­¦ç„å­¦çš„è¯´èµ·æ³¨æ„åŠ›-attention"><a class="markdownIt-Anchor" href="#11-ä»ç”Ÿç‰©å­¦ç„å­¦çš„è¯´èµ·æ³¨æ„åŠ›-attention"></a> 1.1 ä»ç”Ÿç‰©å­¦ç„å­¦çš„è¯´èµ·æ³¨æ„åŠ› attention</h3><blockquote><p>â€‹ï¼ˆå¾ˆæœ‰æ„æ€çš„ä¸€æ®µï¼‰</p><p>æ³¨æ„åŠ›æ˜¯ç¨€ç¼ºçš„ï¼Œè€Œç¯å¢ƒä¸­å¹²æ‰°æ³¨æ„åŠ›çš„ä¿¡æ¯å¹¶ä¸å°‘ã€‚æ¯”å¦‚æˆ‘ä»¬çš„è§†è§‰ç¥ç»ç³»ç»Ÿå¤§çº¦æ”¶åˆ°10e8ä½çš„ä¿¡æ¯ï¼Œè¿œè¿œè¶…è¿‡äº†å¤§è„‘èƒ½å¤Ÿå®Œå…¨å¤„ç†çš„æ°´å¹³ï¼Œä½†æ˜¯å¹¸è¿çš„æ˜¯æˆ‘ä»¬çš„ç¥–å…ˆå·²ç»é€šè¿‡ç»éªŒè®¤è¯†åˆ°â€œå¹¶éæ„Ÿå®˜çš„æ‰€æœ‰è¾“å…¥éƒ½æ˜¯ä¸€æ ·çš„â€ï¼Œåœ¨æ•´ä¸ªäººç±»å†å²ä¸­ï¼Œè¿™ç§å°†æ³¨æ„åŠ›å¼•å‘æ„Ÿå…´è¶£çš„ä¸€éƒ¨åˆ†ä¿¡æ¯çš„èƒ½åŠ›ä½¿å¾—æˆ‘ä»¬çš„å¤§è„‘èƒ½å¤Ÿæ›´åŠ æ˜æ™ºåœ°åˆ†é…èµ„æºæ¥ç”Ÿå­˜ã€æˆé•¿å’Œç¤¾äº¤ï¼Œä¾‹å¦‚å‘ç°å¤©æ•Œã€æ‰¾å¯»é£Ÿç‰©æˆ–è€…ä¼´ä¾£</p></blockquote><p>ç”Ÿç‰©å­¦ä¸­å¸¸è§çš„åˆ©ç”¨åŒç»„ä»¶ï¼ˆtow- componentï¼‰æ¥è§£é‡Šæ³¨æ„åŠ›ï¼Œå°†æ³¨æ„åŠ›åˆ’åˆ†ä¸ºä¸¤ç±»ï¼š</p><ol><li>éè‡ªå‘ï¼šå•çº¯çš„æ ¹æ®è§‚å¯Ÿåˆ°çš„â€æ•°æ®â€œæ¥ç¡®å®šä½ æ‰€æ³¨æ„çš„çš„ä¸œè¥¿ï¼Œæ¯”å¦‚æ¡Œå­ä¸Šæœ‰è¯•å·ã€å¯ä¹ã€æ¸¸æˆæœºã€ä¸€ä¸ªé’¥åŒ™å’Œä¸€ä¸ªæ´»åŠ¨çš„å…¬é¸¡ï¼›ä½ å¯èƒ½æœ€å…ˆå…³æ³¨çš„é¸¡</li><li>è‡ªå‘æ€§ï¼šåœ¨è‡ªæˆ‘æ„è¯†çš„æ§åˆ¶ä¸‹æ¥é€‰æ‹©å…³æ³¨åˆé€‚çš„å…ƒç´ ï¼Œæ¯”å¦‚ä¸Šè¿°å¦‚æœä½ æ˜¯ä¸ºäº†å¯»æ‰¾ä¸€ä¸ªé’¥åŒ™è€Œæ¥ï¼Œé‚£ä¹ˆä½ å°±ä¼šå°†æ³¨æ„åŠ›ä¸“æ³¨åˆ°å¯¹åº”çš„å…ƒç´ ä¸­ã€‚</li></ol><h3 id="12-å®³æ­»äººçš„qquery-kkey-vvalue"><a class="markdownIt-Anchor" href="#12-å®³æ­»äººçš„qquery-kkey-vvalue"></a> 1.2 å®³æ­»äººçš„Qï¼ˆqueryï¼‰ã€Kï¼ˆkeyï¼‰ã€Vï¼ˆvalueï¼‰</h3><p>è¿™é‡Œçš„èµ·æºåˆ©ç”¨å¦å¤–ä¸€ç§Notationæ¥è¡¨è¿°ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><p>queryï¼šè‡ªä¸»æ€§æç¤ºæˆä¸ºquery</p><p>keyï¼šè‡ªä¸»æ€§æç¤º</p><p>attention poolingï¼šæ³¨æ„åŠ›æ±‡èšï¼Œå°† é€‰æ‹©ï¼ˆoutputï¼‰å¼•å¯¼æ„Ÿå®˜è¾“å…¥</p><p>æ„Ÿå®˜è¾“å…¥ç§°ä¸ºvalueï¼Œæ¯ä¸€ä¸ªvalueéƒ½ä¸ä¸€ä¸ªkeyåŒ¹é…</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h73xrybs3ij30m60cuaak.jpg" alt="image-20221013203214511" /></p><h3 id="14-åˆ©ç”¨æ‰¾ä¹¦å°æ•…äº‹æ¥è§£é‡Šqkvæ¨¡å‹ä¸ªäººçŒœæƒ³"><a class="markdownIt-Anchor" href="#14-åˆ©ç”¨æ‰¾ä¹¦å°æ•…äº‹æ¥è§£é‡Šqkvæ¨¡å‹ä¸ªäººçŒœæƒ³"></a> 1.4 åˆ©ç”¨æ‰¾ä¹¦å°æ•…äº‹æ¥è§£é‡ŠQKVæ¨¡å‹ï¼ˆä¸ªäººçŒœæƒ³ï¼ï¼‰</h3><p>æˆ‘ä»¬å°†å›¾ä¹¦é¦†é‡Œé¢æ‰€æœ‰çš„ä¹¦ç§°ä¸ºKeyï¼Œæ¯ä¸ªä¹¦å¯èƒ½ä¼šå¯¹åº”ä¸åŒçš„valueï¼ˆçœ‹æˆ–è€…ä¸çœ‹ï¼‰ï¼›å½“æˆ‘ä»¬æœ‰è‡ªå·±çš„queryï¼ˆæƒ³çœ‹äº¤é€šæ–¹é¢çš„ä¹¦ï¼‰ï¼Œå°±ä¼šå°†queryå¯¹ä¸åŒçš„keyè¿›è¡Œattention poolingï¼Œè¿™æ ·outputå°±æ˜¯ä¸äº¤é€šç›¸å…³çš„ä¹¦æ‰ä¼šçœ‹ï¼Œä¸äº¤é€šä¸ç›¸å…³çš„ä¹¦ä¸çœ‹ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h73xxxjk82j30v50u0mzj.jpg" alt="image-20221013203802267" /></p><h3 id="15-ä»æœºå™¨å­¦ä¹ é‡Œçš„xiyii1næ¥çœ‹ä¸ªäººçŒœæƒ³"><a class="markdownIt-Anchor" href="#15-ä»æœºå™¨å­¦ä¹ é‡Œçš„xiyii1næ¥çœ‹ä¸ªäººçŒœæƒ³"></a> 1.5 ä»æœºå™¨å­¦ä¹ é‡Œçš„<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><msup><mi>x</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>}</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">\{x^{(i)},y^{(i)}\}i=1,...n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:1.138em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">}</span><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathit">n</span></span></span></span>æ¥çœ‹ï¼ˆä¸ªäººçŒœæƒ³ï¼ï¼‰</h3><p>å…¶ä¸­çš„<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">X</span></span></span></span>ç›¸å½“äºKeyï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span>ç›¸å½“äºValue</p><p>å½“æˆ‘ä»¬å¯¹ä¸€ä¸ªæ–°çš„<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>é¢„æµ‹çš„æ—¶å€™ç›¸å½“äºæ˜¯å¯¹è¿™ä¸ªå‘å‡ºqueryï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¼šæ€ä¹ˆæ ·ï¼Ÿ</p><ol><li>é¦–å…ˆæ ¹æ®<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>ä¸<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><mrow><msup><mi>x</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup></mrow><mi>i</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">X={x^{(i)}}i=1...n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathit">n</span></span></span></span>è¿›è¡Œattention scoreçš„è®¡ç®—ï¼Œç„¶åå†å½’ä¸€åŒ–ï¼ˆæ¯”å¦‚softmaxï¼‰</li><li>ä¹‹åå†åˆ©ç”¨å½’ä¸€åŒ–çš„ç»“æœä½œä¸º æƒé‡ æ¥æ‹Ÿåˆå¾—åˆ°output</li></ol><p>è¿™é‡Œä¸çº¿æ€§å›å½’çš„åŒºåˆ«åœ¨äºæƒé‡çš„ç¡®å®šå’Œä½¿ç”¨ä¸Šï¼Œçº¿æ€§å›å½’çš„æƒé‡æ˜¯ä¸¥æ ¼æ¨å¯¼å¹¶ä½¿ç”¨åœ¨Xçš„ä¸åŒç‰¹å¾ä¸Šï¼Œè€Œattentionçš„æƒé‡æ˜¯é€šè¿‡å­¦ä¹ å¹¶ä½¿ç”¨åœ¨Xï¼ˆkeyï¼‰å¯¹åº”çš„yï¼ˆvalueï¼‰</p><p>åŒæ—¶è¿™é‡Œçš„attention valueçš„æƒé‡å¯ä»¥æ˜¯é€šè¿‡å­¦ä¹ ï¼Œä¹Ÿå¯ä»¥æ˜¯é€šè¿‡äººä¸ºå®šä¹‰æ¥å¾—åˆ°çš„ï¼Œå› ä¸ºæˆ‘ä»¬é‡‡ç”¨çš„vectorå½¢å¼çš„å­¦ä¹ ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨kernel functionæˆ–è€…çº¿æ€§ç©ºé—´ä¸€äº›è·ç¦»åº¦é‡æ¥ä½œä¸ºè®¡ç®—æ–¹å¼ï¼Œåœ¨åç»­è¿›åŒ–ç‰ˆçš„å‡çº§ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä¼šæœ‰å…¶ä»–scoreçš„åº¦é‡ï¼Œæ¯”å¦‚ä¹¦ä¸ä¹¦ä¹‹é—´æ˜¯å¥½åº¦é‡çš„ï¼Œä½†æ˜¯è¯´çš„è¯å’Œä¹¦ä¹‹é—´å¦‚ä½•åº¦é‡ï¼Ÿ</p><h2 id="0x02-å¯è§†åŒ–attention"><a class="markdownIt-Anchor" href="#0x02-å¯è§†åŒ–attention"></a> 0x02 å¯è§†åŒ–Attention</h2><p>æ¥ç€ä¸Šè¿°çš„1.5æˆ‘ä»¬å¯ä»¥çœ‹å‡ºã€ŠD2Lã€‹ä¹¦ä¸­ä»‹ç»Nadaraya- Watsonæ ¸å›å½’ï¼Œåªä¸è¿‡å…¶ä¸­çš„attention score çš„è®¡ç®—æ–¹å¼æ˜¯ç”¨<a href="https://en.wikipedia.org/wiki/Kernel_method">æ ¸æœºå™¨</a>ï¼›å¹¸è¿çš„æ˜¯æˆ‘ä»¬åœ¨<a href="https://blog.tjdata.site/2022/02/05/CS229-02--%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BASVM/">SVM</a>é‡Œé¢å·²ç»åˆæ­¥äº†è§£è¿‡ï¼Œå®ƒåªæ˜¯ä¸€ç§å°†ä½çº¬åº¦çš„å‘é‡è·ç¦»æŠ•å°„åˆ°é«˜çº¬åº¦ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥é‡‡ç”¨Gaussian Kernel</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mo>(</mo><mi>X</mi><mn>1</mn><mo separator="true">,</mo><mi>X</mi><mn>2</mn><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msqrt><mo>(</mo></msqrt><mn>2</mn><mo>âˆ—</mo><mi>Ï€</mi><mo>)</mo></mrow></mfrac><mo>âˆ—</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><mo>âˆ’</mo><mfrac><mrow><mo>(</mo><mi>X</mi><mn>1</mn><mo>âˆ’</mo><mi>X</mi><mn>2</mn><msup><mo>)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn></mrow></mfrac><mo>)</mo></mrow><annotation encoding="application/x-tex">K(X1,X2)=\frac{1}{\sqrt(2*\pi)}*exp(-\frac{(X1-X2)^2}{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.491108em;"></span><span class="strut bottom" style="height:2.621118em;vertical-align:-1.13001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord mathrm">2</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.825005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="sqrt mord"><span class="sqrt-sign" style="top:-0.04500500000000007em;"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">âˆš</span></span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span><span class="mopen">(</span></span><span style="top:-0.855005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">2</span><span class="mbin">âˆ—</span><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">âˆ—</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord mathrm">1</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord mathrm">2</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p><p>è¿™æ ·å–è¯„ä»·ä¹‹åå°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬å¯¹äºæ–°çš„queryçš„xçš„é¢„æµ‹ä¸º</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>y</mi><mo>Â¯</mo></mover><mo>=</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><mo>âˆ’</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mo>(</mo><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mi>i</mi></msub><msup><mo>)</mo><mn>2</mn></msup><mo>)</mo></mrow><mrow><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>j</mi><mo>=</mo><mi>n</mi></mrow></msubsup><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><mo>âˆ’</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mo>(</mo><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mi>j</mi></msub><msup><mo>)</mo><mn>2</mn></msup><mo>)</mo></mrow></mfrac><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\bar y=\Sigma_{i=1}^n\frac{exp(-0.5(x-x_i)^2)}{\Sigma_{j=1}^{j=n} exp(-0.5(x-x_j)^2)}y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.491108em;"></span><span class="strut bottom" style="height:2.7366520000000003em;vertical-align:-1.245544em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span><span style="top:0em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>Â¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.832572em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.276864em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><p>è¿™é‡Œå–çš„å°±æ˜¯æŒ‰ç…§ä¸€ç§é«˜æ–¯è·ç¦»ï¼Œç¦»çš„è¶Šè¿‘è¶Šå¥½ï¼Œå¦‚æœæŒ‰ç…§è¿™ä¸ªæ–¹å¼å¾—åˆ°çš„attention scoreå¯ä»¥çœ‹å‡ºè¿‘å¤§è¿œå°çš„ç‰¹ç‚¹ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h73yjoqerej30sw0n2wg7.jpg" alt="image-20221013205856315" /></p><p>ä½†æ˜¯å¦å¤–ä¸€ç§æˆ‘ä»¬å¸Œæœ›å¯ä»¥å¯¹äºä¸åŒqueryå…·æœ‰ä¸åŒçš„é«˜æ–¯å‡½æ•°çš„å®½åº¦ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸Œæœ›æ–¹å·®ä¸ä¸€æ ·</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>y</mi><mo>Â¯</mo></mover><mo>=</mo><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><mo>âˆ’</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mi>w</mi><mo>(</mo><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mi>i</mi></msub><msup><mo>)</mo><mn>2</mn></msup><mo>)</mo></mrow><mrow><msubsup><mi mathvariant="normal">Î£</mi><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>j</mi><mo>=</mo><mi>n</mi></mrow></msubsup><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><mo>âˆ’</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mi>w</mi><mo>(</mo><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mi>j</mi></msub><msup><mo>)</mo><mn>2</mn></msup><mo>)</mo></mrow></mfrac><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\bar y=\Sigma_{i=1}^n\frac{exp(-0.5w(x-x_i)^2)}{\Sigma_{j=1}^{j=n} exp(-0.5w(x-x_j)^2)}y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.491108em;"></span><span class="strut bottom" style="height:2.7366520000000003em;vertical-align:-1.245544em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span><span style="top:0em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>Â¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.832572em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathrm">Î£</span><span class="vlist"><span style="top:0.276864em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h73yl70phmj30sc0n4gmv.jpg" alt="image-20221013210023487" /></p><p>è¿™æ ·å¯¹äºä¸åŒçš„valueå°±ä¼šæœ‰ä¸åŒçš„æƒé‡ï¼ˆæ³¨æ„è¿™é‡Œçš„æƒé‡å€¼å¾—ä¸æ˜¯wï¼‰ï¼ŒæŒ‡çš„æ˜¯åˆ©ç”¨wè®¡ç®—å‡ºæ¥çš„attention score</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h73ym1xbhzj30tc0mk3zr.jpg" alt="image-20221013210112922" /></p><h2 id="0x03-å¯¹äºattentionçš„åˆè¯†"><a class="markdownIt-Anchor" href="#0x03-å¯¹äºattentionçš„åˆè¯†"></a> 0x03 å¯¹äºattentionçš„åˆè¯†</h2><p>æ‰€ä»¥attentionæ˜¯å•¥ï¼Œå¦‚æœåˆ©ç”¨QKVçš„è§’åº¦æ¥çœ‹æ¯”è¾ƒå¤æ‚ï¼Œå¦‚æœä»ç®€å•çš„å›å½’é—®é¢˜è§’åº¦æ¥çœ‹å®ƒåªæ˜¯å¦å¤–ä¸€ç§è®¡ç®—æƒé‡æ–¹å¼çš„å‡½æ•°ã€‚</p><p>ä½†æ˜¯ï¼attentionçš„ä½œç”¨ä¸ä»…å±€é™äºå›å½’é—®é¢˜ï¼Œå®ƒä»seqé—®é¢˜ä¸­è€Œæ¥ï¼Œè§£å†³çš„å°±æ˜¯CNNæˆ–è€…RNNå¯¹äºè·ç¦»çš„æ•æ„Ÿæ€§ã€‚</p><p>å°±åƒCNNçš„æ„Ÿå—é‡ï¼Œå¯¹äºå•å±‚æ„Ÿå—é‡å¯èƒ½æ˜¯å›ºå®šå¥½çš„ï¼ˆä¸kernel sizeã€paddingã€stepæœ‰å…³ï¼‰ï¼Œä½†æ˜¯å¤šå±‚ç´¯ç§¯ä¸­æ„Ÿå—é‡æ˜¯å¯ä»¥é€æ¸æ‰©å¤§çš„ã€‚ä½†æ˜¯CNNé€‚ç”¨äºå›¾åƒçš„å¯èƒ½è§£é‡Šæ˜¯ä¸€ï¼Œå›¾åƒçš„ç»´åº¦æ˜¯å›ºå®šsizeçš„ï¼ˆåƒç´ æ— è®ºå¤šå¤§éƒ½æ˜¯æœ‰é™çš„ï¼‰</p><p>è€ŒRNNçš„æ„Ÿå—é‡ï¼Œå€Ÿé‰´è¢«äººçš„è¯´æ³•æ˜¯å–å†³äºè¯å…ƒæ¨¡å‹å’Œhidden layerï¼Œä½†æ˜¯ç”±äºhidden layerä¹Ÿæ˜¯å…·æœ‰é¡ºåºçš„ç‰¹å¾ï¼Œå®ƒçš„æ„Ÿå—é‡ä¹Ÿä¸ä¼šä¼ é€’çš„å¤ªè¿œã€‚</p><p>attentionåˆ©ç”¨attention socreå¯¹ä¸åŒçš„keyè¿›è¡Œç­›é€‰ï¼Œæ¥å¾—åˆ°ä¸€ä¸ªè¶³å¤Ÿè¿œä½†æ˜¯é‡ä¸å¤§çš„æ„Ÿå—é‡ã€‚é€‰æ‹©é‡è¦çš„æ•°æ®ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h73ytykgh8j30vy0fsq6j.jpg" alt="image-20221013210849152" /></p><p>åŒæ—¶åœ¨Attentionä¸­å…³äºattention scoreçš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œç”±äºæ²¡æœ‰æ¥è§¦è¿‡seq2seqæ¨¡å‹ï¼Œåœ¨åé¢çš„è®¡ç®—ä¸­å¯èƒ½éœ€è¦äº†è§£ä¹‹åæ‰èƒ½æœ‰æ›´è¿‘ä¸€æ­¥çš„è®¤è¯†ã€‚ç›®å‰çš„ç†è§£æ˜¯åˆ©ç”¨ä¸€ç§å¯å­¦ä¹ çš„æ–¹å¼æ¥å¾—åˆ°åˆç†çš„attention scoreçš„è®¡ç®—æ–¹å¼ã€‚</p><p>flagï¼š</p><p>çœ‹æ‡‚RNNã€GRUã€LSTM</p><p>æ˜ç™½seq2seqæ¡†æ¶ï¼Œencoder- decoderçš„æ¡†æ¶</p><h2 id="0x04-discussion"><a class="markdownIt-Anchor" href="#0x04-discussion"></a> 0x04 Discussion</h2><h3 id="41-ä¸€è‡´è®°å·çš„é‡è¦æ€§"><a class="markdownIt-Anchor" href="#41-ä¸€è‡´è®°å·çš„é‡è¦æ€§"></a> 4.1 ä¸€è‡´è®°å·çš„é‡è¦æ€§</h3><p>è¿˜æ˜¯å¾ˆå–œæ¬¢CS229çš„è®²ä¹‰ä¸­Notationä¸€è‡´æ€§çš„æ€è€ƒï¼Œè¿™æ ·å‰åçš„å…¬å¼æ¨å¯¼ä¼šå¾ˆæ¸…æ™°ï¼Œåœ¨è§£é‡Šé—®é¢˜ä¸­ä¼šæœ‰ä¸€è‡´æ€§</p><p>D2Lä¸­æ²ç¥è®²çš„çœŸçš„å¾ˆå¥½ï¼Œä½†æ˜¯åœ¨å†™ä½œä¸­ä¼¼ä¹è¿˜æ˜¯ç¼ºå°‘è¿™ç§åŸºæœ¬çš„ç´ å…»ã€‚è¿™æ ·çš„ç´ å…»å¯¹äºå¤§ä½¬æ˜¯é”¦ä¸Šæ·»èŠ±ï¼Œä½†æ˜¯å¯¹äºåˆå­¦è€…æ˜¯ä¿è¯ä¸å‡ºé”™çš„å›´æ ã€‚</p><h3 id="42-æ¨¡æ‹Ÿprintçš„é‡è¦æ€§"><a class="markdownIt-Anchor" href="#42-æ¨¡æ‹Ÿprintçš„é‡è¦æ€§"></a> 4.2 æ¨¡æ‹Ÿï¼ˆprintï¼‰çš„é‡è¦æ€§</h3><p>å¯¹äºä¸åŒçš„æŠ½è±¡é—®é¢˜ï¼Œåˆ©ç”¨å…·ä½“çš„ä¸œè¥¿æ‰“å°å‡ºæ¥ä¸€æ­¥ä¸€æ­¥å°±å¥½äº†ã€‚å°¤å…¶æ˜¯å‘é‡çš„æ¯ä¸€æ­¥çš„size</p><h3 id="43-mldlçš„ä¸€äº›æ€è€ƒ"><a class="markdownIt-Anchor" href="#43-mldlçš„ä¸€äº›æ€è€ƒ"></a> 4.3 ML&amp;DLçš„ä¸€äº›æ€è€ƒ</h3><p>å¯èƒ½æ˜¯æ²¿ç€D2Lä¹¦çš„ç¼˜æ•…ï¼Œå¯¹æ·±åº¦å­¦ä¹ çš„è®¤è¯†è¿‡ç¨‹æ˜¯ä»MLPåˆ°CNN/GCNåˆ°RNNåˆ°Transformerï¼Œå¯èƒ½è¿˜æœ‰å…¶ä»–çš„ï¼Œè¿™æ ·ç½‘ç»œç»“æœä¸€æ ·ä½†åˆä¼¼ä¹ä¸å¤ªä¸€æ ·ï¼Œä¸»è¦å¯¹ç‰¹å¾æå–æ–¹å¼ä¸Šã€‚</p><p>ä¸‹é¢è¿™å¼ å›¾å¯èƒ½å†…å®¹ä¸å¯¹æˆ–è€…ä¸å…¨ï¼Œä½†æ˜¯åˆ†ç±»çš„æ€è·¯ä»å­¦ä¹ çš„è§’åº¦è¿˜æ˜¯æœ‰ç›Šçš„</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGly1h73zdhgwuxj31fa0u0k56.jpg" alt="image-20221013212732442" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬æ¥å°±ä»¥Attentionä¸ºåŸºç¡€çš„Transformerç»“æ„å¾ˆæ„Ÿå…´è¶£ï¼Œæƒ³ç›´æ¥ä»CNNè·³åˆ°Attentionæ¥å­¦ä¹ ï¼Œä½†æ˜¯é€šè¿‡äº†è§£ä¸€äº›åŸºæœ¬çš„èƒŒæ™¯å‘ç°å¹¶ä¸ç°å®ï¼Œtransformerçš„æå‡ºæœ¬æ¥å°±æ˜¯åœ¨æœºå™¨ç¿»è¯‘çš„åŸºç¡€ä¸Šï¼Œæ‰€ä»¥å…ˆå¤©çš„åœ¨ä¸€äº›é—®é¢˜åœºæ™¯çš„è§£é‡Šä¸­å¹¶ä¸æ˜¯ä»¥å›å½’æ•°æ®ã€æˆ–è€…è¯´äºŒç»´å›¾åƒ</summary>
      
    
    
    
    <category term="ML&amp;DL" scheme="https://blog.tjdata.site/categories/ML-DL/"/>
    
    
    <category term="D2L" scheme="https://blog.tjdata.site/tags/D2L/"/>
    
  </entry>
  
  <entry>
    <title>å¼ºåŒ–å­¦ä¹ 01_åŸºæœ¬æ¦‚å¿µ</title>
    <link href="https://blog.tjdata.site/posts/3e3a5c92.html"/>
    <id>https://blog.tjdata.site/posts/3e3a5c92.html</id>
    <published>2022-09-30T08:02:58.000Z</published>
    <updated>2023-05-13T13:52:18.553Z</updated>
    
    <content type="html"><![CDATA[<p>åˆå§‹å¼ºåŒ–å­¦ä¹ æœ€éš¾çš„åœ°æ–¹åœ¨äºæ™¦æ¶©çš„ä¸“ä¸šè¯æ±‡ä»¥åŠå¤æ‚çš„æ•°å­¦æ¨å¯¼ï¼›åŒæ—¶æ·±åº¦å¼ºåŒ–å­¦ä¹ å¹¶ä¸æ˜¯å¼ºåŒ–å­¦ä¹ çš„ç»ˆç‚¹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¾æ—§éœ€è¦humanåœ¨å…¶ä¸­æ‰®æ¼”çš„åœ°æ–¹ã€‚è¿™é‡Œæµ…è–„çœ‹<a href="https://datawhalechina.github.io/easy-rl/#/">è˜‘è‡ä¹¦æ¥äº†è§£</a>ã€‚ä¸»è¦ä½œä¸ºäº†è§£å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µï¼Œå¸Œæœ›ä»éšæœºè¿‡ç¨‹å‡ºå‘ï¼Œæ¥ç»™å‡ºå¼ºåŒ–å­¦ä¹ ä¸­æ™ºèƒ½ä½“agentä¸ç¯å¢ƒ envä¹‹é—´çš„åŸºæœ¬æ¦‚å¿µ</p><span id="more"></span><h2 id="0x01-éšæœºè¿‡ç¨‹çš„åŸºç¡€"><a class="markdownIt-Anchor" href="#0x01-éšæœºè¿‡ç¨‹çš„åŸºç¡€"></a> 0x01 éšæœºè¿‡ç¨‹çš„åŸºç¡€</h2><p>æ¦‚ç‡è®ºå’Œåº”ç”¨ç»Ÿè®¡æ˜¯ç ”ç©¶æ¦‚ç‡è®ºä¸­å¤šä¸ªéšæœºäº‹ä»¶æ‰€æ„æˆçš„å…·æœ‰ä¸€èˆ¬æ€§è§„å¾‹çš„å­¦ç§‘ï¼›è€Œéšæœºè¿‡ç¨‹åˆ™æ˜¯å¯¹è¿™ä¸ªè¿‡ç¨‹è¿›è¡Œæè¿°ã€‚</p><h3 id="11-é©¬å°”å¯å¤«è¿‡ç¨‹-mp-markov-process"><a class="markdownIt-Anchor" href="#11-é©¬å°”å¯å¤«è¿‡ç¨‹-mp-markov-process"></a> 1.1 é©¬å°”å¯å¤«è¿‡ç¨‹ MP- Markov process</h3><p>é©¬å°”å¯å¤«æ€§è´¨æŒ‡çš„æ˜¯ä¸€ä¸ªéšæœºè¿‡ç¨‹åœ¨ç»™å®šç°åœ¨çŠ¶æ€å’Œæ‰€æœ‰è¿‡å»çŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œæœªæ¥åˆ†å¸ƒæ¦‚ç‡ä»…ä¾èµ–äºå½“å‰çš„çŠ¶æ€ï¼›ä¹Ÿå°±æ˜¯åœ¨çŸ¥é“å½“å‰çš„çŠ¶æ€ï¼Œå°†æ¥ä¸æœªæ¥æ˜¯ç‹¬ç«‹çš„</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>X</mi><mrow><mi>T</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>X</mi><mn>0</mn></msub><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>X</mi><mi>T</mi></msub><mo>=</mo><msub><mi>x</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>X</mi><mrow><mi>T</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>X</mi><mi>T</mi></msub><mo>=</mo><msub><mi>x</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(X_{T+1}=x_{t+1}|X_0=x_0,x_1=x_1,...,X_T=x_t)=P(X_{T+1}=x_{t+1}|X_T=x_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>å¦‚æœä¸€ä¸ªéšæœºè¿‡ç¨‹æ˜¯ç¦»æ•£çš„ï¼Œå¯ä»¥è¢«ç§°ä¸ºé©¬å°”å¯å¤«é“¾ï¼ˆMarkov chainï¼‰</p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬çœ‹åˆ°ä¸åŒçŠ¶æ€ä¹‹é—´çš„æ¦‚ç‡è½¬æ¢</p><h3 id="12-é©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹-mrp-markov-reward-process"><a class="markdownIt-Anchor" href="#12-é©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹-mrp-markov-reward-process"></a> 1.2 é©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹-MRP- Markov reward- process</h3><p>åœ¨ä¸Šè¿°é©¬å°”å¯å¤«é“¾çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªæ–°çš„æ¦‚å¿µï¼š</p><p>å¥–åŠ±- reward functionï¼šæ˜¯ä¸€ä¸ªæœŸæœ›ï¼Œè¡¨ç¤ºæˆ‘ä»¬åˆ°è¾¾æŸä¸ªè¿‡ç¨‹èƒ½å¤Ÿè·å¾—çš„æœ€å¤§çš„å¥–åŠ±ï¼Œé€šå¸¸ç”¨horizonè¡¨ç¤ºæœ‰ä¸ªå›åˆçš„é•¿åº¦ï¼Œé‚£ä¹ˆåœ¨å¥–åŠ±çš„åŸºç¡€ä¸Šæˆ‘ä»¬å¯ä»¥å¾—åˆ°éšæœºè¿‡ç¨‹åºåˆ—çš„å›æŠ¥</p><p>å›æŠ¥- return <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>Î³</mi><mo>âˆ—</mo><msub><mi>r</mi><mrow><mi>t</mi><mo>+</mo><mn>2</mn></mrow></msub><mo>+</mo><msup><mi>Î³</mi><mn>2</mn></msup><mo>âˆ—</mo><msub><mi>r</mi><mrow><mi>t</mi><mo>+</mo><mn>3</mn></mrow></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">G_t=r_{t+1}+\gamma*r_{t+2}+\gamma^2*r_{t+3}+...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.0224389999999999em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="mbin">âˆ—</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">Î³</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ—</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span></span></span></span></p><p>è¿™é‡Œçš„<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î³</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05556em;">Î³</span></span></span></span>ä»£è¡¨æŠ˜æ‰£ç³»æ•°ï¼›è¿™ä¸ªä½ç½®æ˜¯è¡¨ç¤ºè¿™ä¸ªä¸€ç³»åˆ—çš„éšæœºè¿‡ç¨‹æ‰€å¸¦æ¥çš„å›æŠ¥ï¼Œä½†æ˜¯é€šå¸¸ä¸ºæ”¶æ•›ä¼šè§„å®š å›æŠ¥- returnçš„é•¿åº¦æ¥ï¼›åœ¨å›æŠ¥- returnçš„åŸºç¡€ä¸Šæˆ‘ä»¬å¯ä»¥å¾—åˆ°æ¯ä¸ªçŠ¶æ€- stateçš„ä»·å€¼- valueï¼›ä¹Ÿå°±æ˜¯å›æŠ¥- returnçš„æœŸæœ›å°±æ˜¯ä»·å€¼</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mo>(</mo><msub><mi>S</mi><mi>T</mi></msub><mo>)</mo><mo>=</mo><mi>E</mi><mo>(</mo><msub><mi>G</mi><mi>T</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>S</mi><mi>T</mi></msub><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">V(S_T)=E(G_T|S_T=s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>è¿™é‡Œæœ‰å¾…è®¨è®ºï¼Œæ„Ÿè§‰å’Œé«˜ä¸­ç‰©ç†ä¸­çš„ä¸‡æœ‰å¼•åŠ›ä¸åŠ¿èƒ½å¾ˆç›¸ä¼¼</p><p>å…³äºä»·å€¼- valueçš„æ±‚è§£ä¼šæœ‰å¾ˆå¤šæ–¹æ³•</p><ol><li>åˆ©ç”¨å®šä¹‰ï¼Œéå†å¤šç§çŠ¶æ€å¾—åˆ°value</li><li>åˆ©ç”¨è’™ç‰¹å¡æ´›MCéšæœºé‡‡æ ·çš„æ–¹æ³•</li><li>åˆ©ç”¨Bellman equationå¾—åˆ°è§£æè§£</li><li>å…¶ä»–çš„æ–¹æ³•ï¼Œæ¯”å¦‚TD learningç­‰</li></ol><h3 id="125å…³äºmrpè´å°”æ›¼æ–¹ç¨‹æ±‚è§£"><a class="markdownIt-Anchor" href="#125å…³äºmrpè´å°”æ›¼æ–¹ç¨‹æ±‚è§£"></a> 1.25å…³äºMRPè´å°”æ›¼æ–¹ç¨‹æ±‚è§£</h3><p>å¤ªèœäº†ï¼Œæ‰€ä»¥ç”¨æ‰‹å†™ï¼Œè¿™æ ·æˆ‘ä»¬çœ‹å‡ºMRPé‡ç‚¹æ˜¯åœ¨çŸ¥é“è½¬ç§»æ¦‚ç‡På’Œå„çŠ¶æ€å¥–åŠ±rewardä»¥åŠæŠ˜æ‰£å› å­<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î³</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05556em;">Î³</span></span></span></span>çš„åŸºç¡€ä¸Šï¼Œæ±‚è§£å‡ºçŠ¶æ€çš„ä»·å€¼ï¼ˆç”¨ä¸åŒçš„æ–¹æ³•ï¼‰</p><p><img src="https://pica.zhimg.com/80/v2-a8e283e4093bbf799726b3d53a8e3986_1440w.png" alt="image-20220930163324332" /></p><p><img src="https://pica.zhimg.com/80/v2-2a7bb6b705e17efd979e214a92d425f7_1440w.png" alt="image-20220930163334308" /></p><p><img src="https://pic1.zhimg.com/80/v2-ff43b46c8d01f592a86c35f166ac2493_1440w.png" alt="image-20220930163352911" /></p><h3 id="13-é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹-mdp-markov-decision-process"><a class="markdownIt-Anchor" href="#13-é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹-mdp-markov-decision-process"></a> 1.3 é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹-MDP-Markov- decision- process</h3><p>MRPåœ¨MPä¸­å¢åŠ æ¥ â€œå¥–åŠ±rewardã€å›æŠ¥returnå’Œä»·å€¼valueâ€ï¼ŒMDPåˆ™æ˜¯ç»§ç»­åœ¨MRPçš„åŸºç¡€ä¸­å¢åŠ åŠ¨ä½œé¡¹ç›®action</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi><mo>(</mo><mi>a</mi><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>A</mi><mi>T</mi></msub><mo>=</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>S</mi><mi>T</mi></msub><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\pi(a|s)=P(A_T=a_t|S_T=s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mord mathrm">âˆ£</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>è¿™é‡Œçš„<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span></span></span></span>ç§°ä¸ºæ˜¯ç­–ç•¥ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œä¸‹ä¸€ä¸ªçŠ¶æ€åº”è¯¥å–å†³äºå½“å‰çš„çŠ¶æ€å’ŒåŠ¨ä½œ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>T</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>S</mi><mi>T</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>T</mi></msub><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>T</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>h</mi><mi>T</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>T</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(S_{T+1}|S_T,A_T)=P(S_{T+1}|h_T,a_T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><p>åŒæ · å¥–åŠ±reward çš„å®šä¹‰ä¹Ÿä¼šæ›´åŠ å¤æ‚</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>(</mo><msub><mi>S</mi><mi>T</mi></msub><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><mi>E</mi><mo>(</mo><msub><mi>r</mi><mi>t</mi></msub><mo>[</mo><msub><mi>S</mi><mi>T</mi></msub><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo>]</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">R(S_T=s_t)=E(r_t[S_T=s_t,A_t=a])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></span></p><p>2022-09-30 è¿™éƒ¨åˆ†åé¢å°±ä¸å¤ªæ‡‚å•¦ï½ï½æœªå®Œå¾…ç»­</p><h3 id="14-ä¸¾ä¸ªä¾‹å­"><a class="markdownIt-Anchor" href="#14-ä¸¾ä¸ªä¾‹å­"></a> 1.4 ä¸¾ä¸ªä¾‹å­</h3><p>è®¡ç®—çŠ¶æ€</p><p>æ¯”å¦‚çŠ¶æ€ç©ºé—´åŒ…æ‹¬{wechatï¼›class1;class2;class3;sleep;pass;pub}</p><p>ä¹‹é—´çš„çŠ¶æ€æ¦‚ç‡ä¸º</p><p><img src="https://pica.zhimg.com/80/v2-b3c3404e0dd9231f2584b6ebedcd1eaf_1440w.png" alt="image-20220930164228814" /></p><p>ä¸åŒçŠ¶æ€çš„rewardæ˜¯</p><p><img src="https://pica.zhimg.com/80/v2-5a00345aa837a5d7641513eff8fae762_1440w.png" alt="image-20220930164245788" /></p><p>åˆ©ç”¨è´å°”æ›¼æ–¹ç¨‹å°±å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„valueç»“æœ</p><h3 id="15-mdpçš„æ ¸å¿ƒé—®é¢˜"><a class="markdownIt-Anchor" href="#15-mdpçš„æ ¸å¿ƒé—®é¢˜"></a> 1.5 MDPçš„æ ¸å¿ƒé—®é¢˜</h3><p>è™½ç„¶2022-09-30è¿˜æ²¡æœ‰ææ‡‚MDPçš„æ•°å­¦è¿‡ç¨‹ï¼Œä½†æ˜¯å¯ä»¥çœ‹å‡ºèµ·æ ¸å¿ƒçš„é—®é¢˜åŒ…æ‹¬</p><p>ã€é¢„æµ‹ã€‘ä¸ã€æ§åˆ¶ã€‘</p><p>é¢„æµ‹å°±æ˜¯ç»™å‡º stateã€actionã€Pã€Rä¸policyæ¥å¾—åˆ°æ¯ä¸ªçŠ¶æ€çš„value</p><p>æ§åˆ¶å°±æ˜¯ç»™å‡ºstateã€actionã€Pã€Ræ¥å¾—åˆ°valueä¸policy</p><p>åœ¨æ±‚è§£ä¸­å¸¸åˆ†ä¸º ç­–ç•¥è¿­ä»£policy- iterationä¸ä»·å€¼è¿­ä»£ value- iteration</p><p>ç»†èŠ‚åé¢åœ¨äº†è§£</p><h2 id="0x02-å¼ºåŒ–å­¦ä¹ æ¦‚è¿°"><a class="markdownIt-Anchor" href="#0x02-å¼ºåŒ–å­¦ä¹ æ¦‚è¿°"></a> 0x02 å¼ºåŒ–å­¦ä¹ æ¦‚è¿°</h2><p>æœ€ç»å…¸å°±æ˜¯è¿™æ ·çš„å›¾ï¼Œå¼ºåŒ–å­¦ä¹ çš„è¿‡ç¨‹å¯ä»¥çœ‹ä½œæ˜¯å®é™…åŒ–çš„MDPè¿‡ç¨‹ï¼›æˆ‘ä»¬å¯ä»¥çŸ¥é“æˆ‘ä»¬å°†é—®é¢˜åˆ†ä¸º æ™ºèƒ½ä½“agentä¸ç¯å¢ƒenvä¸¤éƒ¨åˆ†ï¼›çŠ¶æ€stateä¸å¥–åŠ±rewardç”±envç»™å‡ºï¼›agentä¼šæ ¹æ®çŠ¶æ€ä¸å¥–åŠ±æ¥å®ç°ä¸åŒçš„åŠ¨ä½œactionï¼ˆåŠ¨ä½œåºåˆ—ä¹Ÿå°±æ˜¯éœ€è¦å­¦ä¹ çš„ç­–ç•¥policyï¼‰ï¼Œå†å¾—åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ä»¥åŠå½“å‰çŠ¶æ€å¾—åˆ°çš„å¥–åŠ±</p><p><img src="https://pica.zhimg.com/80/v2-fc6cd1cf1a397b72cb6a791f328b352f_1440w.png" alt="image-20220930164808387" /></p><h2 id="0x03-å¼ºåŒ–å­¦ä¹ ä¸ç›‘ç£å­¦ä¹ "><a class="markdownIt-Anchor" href="#0x03-å¼ºåŒ–å­¦ä¹ ä¸ç›‘ç£å­¦ä¹ "></a> 0x03 å¼ºåŒ–å­¦ä¹ ä¸ç›‘ç£å­¦ä¹ </h2><h3 id="31-ç›‘ç£å­¦ä¹ "><a class="markdownIt-Anchor" href="#31-ç›‘ç£å­¦ä¹ "></a> 3.1 ç›‘ç£å­¦ä¹ </h3><ul><li>æˆ‘ä»¬é¦–å…ˆå‡è®¾æˆ‘ä»¬æœ‰å¤§é‡è¢«æ ‡æ³¨çš„æ•°æ®ï¼Œå‡è®¾ä¹‹é—´æ»¡è¶³åŒåˆ†å¸ƒï¼Œä¹‹é—´æ˜¯æ²¡æœ‰å…³è”çš„ã€‚åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæˆ‘ä»¬è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ï¼ˆæ¯”å¦‚ä¸€ä¸ªåˆ†ç±»å™¨ï¼‰ï¼Œæˆ‘ä»¬å¯èƒ½é€šè¿‡å°†æ ‡ç­¾ä¿¡æ¯ä¼ é€’ç»™ç¥ç»ç½‘ç»œï¼Œå½“ç¥ç»ç½‘ç»œåšå‡ºé”™è¯¯çš„é¢„æµ‹çš„æ—¶å€™æˆ‘ä»¬ä¼šç»™ä»–ä¸€ä¸ªé”™è¯¯çš„åé¦ˆï¼Œæˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªé”™è¯¯å†™å‡ºä¸€ä¸ª æŸå¤±å‡½æ•° loss- functionï¼Œé€šè¿‡ åå‘ä¼ æ’­ back propagateæ¥è®­ç»ƒ</li><li>å‡è®¾1:è¾“å‡ºçš„æ•°æ®åº”è¯¥æ˜¯æ²¡æœ‰å…³è”çš„</li><li>å‡è®¾2:æˆ‘ä»¬éœ€è¦å‘Šè¯‰å­¦ä¹ æ­£ç¡®çš„æ ‡ç­¾æ˜¯ä»€ä¹ˆï¼Œè¿™æ ·å®ƒå¯ä»¥é€šè¿‡æ­£ç¡®çš„æ ‡ç­¾æ¥ä¿®æ­£è‡ªå·±çš„é¢„æµ‹</li></ul><h3 id="32-å¼ºåŒ–å­¦ä¹ "><a class="markdownIt-Anchor" href="#32-å¼ºåŒ–å­¦ä¹ "></a> 3.2 å¼ºåŒ–å­¦ä¹ </h3><ul><li>åœ¨å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œç›‘ç£å­¦ä¹ çš„ä¸Šè¿°çš„ä¸¤ä¸ªå‡è®¾éƒ½ä¸æ»¡è¶³</li><li>æ¯ä¸ªframeä¹‹é—´å…·æœ‰éå¸¸å¼ºçš„è¿ç»­æ€§ï¼ŒåŒæ—¶æ²¡æœ‰iid</li><li>å¼ºåŒ–å­¦ä¹ ä¸­å¾—åˆ°çš„è®­ç»ƒæ•°æ®æ˜¯ä¸€ä¸ªç©æ¸¸æˆçš„åºåˆ—ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªåºåˆ—æ”¾è¿›ç½‘ç»œã€å¸Œæœ›ç½‘ç»œè¾“å‡ºä¸€äº›åŠ¨ä½œï¼Œåœ¨è¿™ä¸ªé—®é¢˜ä¸­æˆ‘ä»¬å¹¶æ²¡æœ‰æ ‡ç­¾æ¥è¯´æ˜ç°åœ¨è¿™ä¸ªåŠ¨ä½œæ˜¯æ­£ç¡®çš„è¿˜æ˜¯ié”™è¯¯çš„ï¼Œå¿…é¡»ç­‰åˆ°æ¸¸æˆç»“æŸæ‰èƒ½çŸ¥é“ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬é¢ä¸´ [[å»¶è¿Ÿå¥–åŠ±delayed- reward]] çš„é—®é¢˜</li></ul><h3 id="33-åŒºåˆ«æ€»ç»“"><a class="markdownIt-Anchor" href="#33-åŒºåˆ«æ€»ç»“"></a> 3.3 åŒºåˆ«æ€»ç»“</h3><ul><li>ç¬¬ä¸€ç‚¹ï¼Œå¼ºåŒ–å­¦ä¹ è¾“å…¥çš„æ ·æœ¬æ˜¯åºåˆ—æ•°æ®ï¼Œä¸æ˜¯iid</li><li>ç¬¬äºŒç‚¹ï¼Œå­¦ä¹ å™¨å¹¶æ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬æ¯ä¸€æ­¥æ­£ç¡®çš„åŠ¨ä½œåº”è¯¥æ˜¯ä»€ä¹ˆï¼Œå­¦ä¹ å™¨éœ€è¦è‡ªå·±å»å‘ç°é‚£ç»†å¾®åŠ¨ä½œå¯ä»¥å¸¦æ¥æœ€å¤šçš„å¥–åŠ±</li><li>ç¬¬ä¸‰ç‚¹ï¼Œæ™ºèƒ½ä½“è·å¾—è‡ªå·±èƒ½åŠ›çš„è¿‡ç¨‹å°±æ˜¯ [[ä¸æ–­è¯•é”™æ¢ç´¢trial-and-error- exploration]]çš„è¿‡ç¨‹ï¼Œ æ¢ç´¢exploration å’Œ åˆ©ç”¨exploitation</li><li>ç¬¬å››ç‚¹ï¼Œåœ¨å¼ºåŒ–å­¦ä¹ è¿‡ç¨‹ä¸­å¹¶æ²¡æœ‰éå¸¸å¼ºçš„ ç›‘ç£è€…supervisor ï¼Œåªæœ‰ [[å¥–åŠ±ä¿¡å·reward- signal]]ï¼Œå¹¶ä¸”å…·æœ‰ [[å»¶è¿Ÿå¥–åŠ±delayed- reward]] çš„æƒ…å†µ</li></ul><h2 id="0x04-åºåˆ—å†³ç­–"><a class="markdownIt-Anchor" href="#0x04-åºåˆ—å†³ç­–"></a> 0x04 åºåˆ—å†³ç­–</h2><h3 id="41-å¥–åŠ±-rewardçš„å®šä¹‰"><a class="markdownIt-Anchor" href="#41-å¥–åŠ±-rewardçš„å®šä¹‰"></a> 4.1 å¥–åŠ± rewardçš„å®šä¹‰</h3><p>æ˜¯ç¯å¢ƒç»™çš„ä¸€ç§ [[æ ‡é‡åé¦ˆä¿¡å·-scalar-feedback-signal]]ï¼Œè¿™ç§ä¿¡å·æ˜¾ç¤ºæ™ºèƒ½ä½“åœ¨æŸä¸€æ­¥æ‰å»æŸä¸ªç­–ç•¥çš„è¡¨ç°å¦‚ä½•</p><h3 id="42-åºåˆ—è¿‡ç¨‹æè¿°"><a class="markdownIt-Anchor" href="#42-åºåˆ—è¿‡ç¨‹æè¿°"></a> 4.2 åºåˆ—è¿‡ç¨‹æè¿°</h3><p>å¼ºåŒ–å­¦ä¹ ä¸­ä¸€ä¸ªé‡è¦çš„è¯¾é¢˜å°±æ˜¯è¿‘æœŸå¥–åŠ±å’Œè¿œæœŸå¥–åŠ±çš„æƒè¡¡ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•è®©æ™ºèƒ½ä½“å¯ä»¥è·å¾—æ›´å¤šçš„è¿œæœŸå¥–åŠ±</p><p>åœ¨ä¸ç¯å¢ƒçš„äº¤äº’è¿‡ç¨‹ä¸­ï¼Œ [[æ™ºèƒ½ä½“agent]] ä¼šè·å¾—å¾ˆå¤š [[è§‚æµ‹observation]] ï¼Œé’ˆå¯¹æ¯ä¸ª [[è§‚æµ‹observation]] ï¼Œ [[æ™ºèƒ½ä½“agent]]ä¼šé‡‡å–ä¸€ä¸ª [[åŠ¨ä½œaction]]ï¼Œç„¶åè·å¾— [[å¥–åŠ±reward]]ï¼Œæ‰€ä»¥è¿™æ ·çš„åºåˆ—æ˜¯</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mi>t</mi></msub><mo>=</mo><msub><mi>o</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>o</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">H_t=o_1,a_1,r_1,...,o_t,a_t,r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><p>[[æ™ºèƒ½ä½“agent]]åœ¨é‡‡å–å½“å‰åŠ¨ä½œçš„æ—¶å€™ä¼šä¾èµ–ä¹‹å‰å¾—åˆ°çš„å†å²ï¼Œå› æ­¤å¯ä»¥å°†æ•´ä¸ªå­¦ä¹ çš„[[çŠ¶æ€state]]çœ‹ä½œæ˜¯è¿™ä¸ªå†å²çš„å‡½æ•°</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>f</mi><mo>(</mo><msub><mi>H</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">s_t=f(H_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></p><h3 id="43-è§‚æµ‹-observation-ä¸-çŠ¶æ€stateåŒºåˆ«"><a class="markdownIt-Anchor" href="#43-è§‚æµ‹-observation-ä¸-çŠ¶æ€stateåŒºåˆ«"></a> 4.3 è§‚æµ‹ observation ä¸ çŠ¶æ€stateåŒºåˆ«</h3><p><img src="https://pica.zhimg.com/80/v2-8e7ac501e53cfff71e32f8caef5da84a_1440w.png" alt="image-20220930165746802" /></p><h3 id="44-åŠ¨ä½œaction"><a class="markdownIt-Anchor" href="#44-åŠ¨ä½œaction"></a> 4.4 åŠ¨ä½œaction</h3><p>åˆ†ä¸ºç¦»æ•£ä¸è¿ç»­</p><h3 id="45-æ™ºèƒ½ä½“åˆ†ç±»"><a class="markdownIt-Anchor" href="#45-æ™ºèƒ½ä½“åˆ†ç±»"></a> 4.5 æ™ºèƒ½ä½“åˆ†ç±»</h3><p>ç¬¬ä¸€ç§åˆ†ç±»ï¼š</p><ol><li>åŸºäºpolicyåˆ’åˆ†ï¼›éšæœºä¸ç¡®å®š</li><li>åŸºäºvalue- functionï¼›valueæˆ–Qå‡½æ•°</li><li>æ¨¡å‹modelï¼›æ¨¡å‹å†³å®šä¸‹ä¸€æ­¥çš„çŠ¶æ€ï¼ŒçŠ¶æ€å–å†³äºå½“å‰çš„çŠ¶æ€ä»¥åŠå½“å‰é‡‡å–çš„åŠ¨ä½œï¼Œç”± [[çŠ¶æ€è½¬ç§»æ¦‚ç‡]]å’Œ [[å¥–åŠ±å‡½æ•°]]ç»„æˆ</li></ol><p><img src="https://picx.zhimg.com/80/v2-1ce7e41f2f475a4f754d5ac1496e917a_1440w.png" alt="image-20220930170200097" /></p><p>ç¬¬äºŒç§åˆ†ç±»ï¼š</p><ol><li>åŸºäºä»·å€¼çš„æ™ºèƒ½ä½“</li><li>åŸºäºç­–ç•¥çš„æ™ºèƒ½ä½“</li><li>æ¼”å‘˜è¯„è®ºå‘˜æ™ºèƒ½ä½“</li></ol><p><img src="https://picx.zhimg.com/80/v2-29b80bae0bdeb4686b984a55a27b73f4_1440w.png" alt="image-20220930171222116" /></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;åˆå§‹å¼ºåŒ–å­¦ä¹ æœ€éš¾çš„åœ°æ–¹åœ¨äºæ™¦æ¶©çš„ä¸“ä¸šè¯æ±‡ä»¥åŠå¤æ‚çš„æ•°å­¦æ¨å¯¼ï¼›åŒæ—¶æ·±åº¦å¼ºåŒ–å­¦ä¹ å¹¶ä¸æ˜¯å¼ºåŒ–å­¦ä¹ çš„ç»ˆç‚¹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¾æ—§éœ€è¦humanåœ¨å…¶ä¸­æ‰®æ¼”çš„åœ°æ–¹ã€‚è¿™é‡Œæµ…è–„çœ‹&lt;a href=&quot;https://datawhalechina.github.io/easy-rl/#/&quot;&gt;è˜‘è‡ä¹¦æ¥äº†è§£&lt;/a&gt;ã€‚ä¸»è¦ä½œä¸ºäº†è§£å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µï¼Œå¸Œæœ›ä»éšæœºè¿‡ç¨‹å‡ºå‘ï¼Œæ¥ç»™å‡ºå¼ºåŒ–å­¦ä¹ ä¸­æ™ºèƒ½ä½“agentä¸ç¯å¢ƒ envä¹‹é—´çš„åŸºæœ¬æ¦‚å¿µ&lt;/p&gt;</summary>
    
    
    
    <category term="RL" scheme="https://blog.tjdata.site/categories/RL/"/>
    
    
    <category term="è˜‘è‡ä¹¦" scheme="https://blog.tjdata.site/tags/%E8%98%91%E8%8F%87%E4%B9%A6/"/>
    
  </entry>
  
  <entry>
    <title>åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ 03_ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œå®ç°</title>
    <link href="https://blog.tjdata.site/posts/d43999e4.html"/>
    <id>https://blog.tjdata.site/posts/d43999e4.html</id>
    <published>2022-09-23T08:12:59.000Z</published>
    <updated>2023-05-13T13:51:52.377Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨åˆç­‰å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºä»å¹³ç§»ä¸å˜å’Œç¼©æ”¾ä¸å˜æ€§è´¨è€Œå¾—åˆ°çš„å·ç§¯æ€§è´¨çš„åŸºç¡€ä¸Šï¼Œåœ¨ä¸Šä¸ªä¸–çºªè¯ç”Ÿçš„LeNetæˆåŠŸå®ç°ä¸ä¹‹å‰ä¸åŒçš„è·¯å¾„ï¼Œåœ¨GPUè¯ç”Ÿä¹‹åï¼Œæ–°çš„ç½‘ç»œAlexNetã€VGGã€NiNã€GoogLeNetã€Residual Netã€DenseNeté€æ¸å‘å±•ã€‚å·ç§¯ç¥ç»ç½‘ç»œä»å˜æ·±å˜å¤šï¼Œé€æ¸åˆ°å˜æˆå—ä»¥åŠä¸€äº›trickçš„å¢åŠ ã€‚</p><span id="more"></span><h2 id="0x01-introduction"><a class="markdownIt-Anchor" href="#0x01-introduction"></a> 0x01 introduction</h2><h3 id="11-pytorch"><a class="markdownIt-Anchor" href="#11-pytorch"></a> 1.1 PyTorch</h3><p>ä¹‹å‰åœ¨è®²åº§ä¸­å¬åˆ°æ·±åº¦å­¦ä¹ æ¡†æ¶æ˜¯æ·±åº¦å­¦ä¹ æ—¶ä»£çš„æ“ä½œç³»ç»Ÿï¼Œæ€ä¹ˆè¯´è¿™ä¸ªæ¯”å–»æœ‰ç‚¹ç²—æ—·ä½†æ˜¯åˆä¸å¤±æ­£ç¡®æ€§ã€‚ä¸ªäººæ„Ÿè§‰åœ¨è®¡ç®—æœºæ—¶ä»£äººä»¬åä½œçš„èƒ½åŠ›è¾¾åˆ°ç©ºå‰çš„åœ°æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥ä¸Šåƒäººå…±åŒå¼€å‘appï¼Œè¿™ç§å’Œå»ºé€ æˆ¿å±‹ä¼¼çš„è¿‡ç¨‹å……åˆ†ä½“ç°äº†è½¯ä»¶å·¥ç¨‹çš„é­…åŠ›ã€‚ä¸åœŸå»ºä¸­è§„åˆ’ã€è®¾è®¡ã€å»ºé€ ã€ éªŒæ”¶ç­‰æµç¨‹ç›¸ä¼¼ï¼Œä¸ªäººéªŒè¯è®¡ç®—æœºæˆå°±çš„ç»“æœæ˜¯å»ºç«‹åœ¨ä¸€å±‚ä¸€å±‚çš„æŠ½è±¡çš„åŸºç¡€ä¸Šçš„ã€‚</p><p>ä»ç¡¬ä»¶çš„è§’åº¦ï¼Œç°åœ¨å¹¶ä¸æ˜¯æ‰€æœ‰äººéƒ½éœ€è¦å…³å¿ƒèŠ¯ç‰‡ä¸Šçš„ä¸‰æç®¡ï¼Œä¹Ÿä¸éœ€è¦å…³å¿ƒåŠ æ³•å™¨çš„æ„æˆã€‚ä»ä¹‹å‰æ‰‹å·¥ç„Šæœºï¼Œåˆ°èŠ¯ç‰‡çš„æ¨¡å—åŒ–è®¾è®¡ï¼Œåˆ°æ›´é«˜çº§çš„æŠ½è±¡å·¥è‰ºå’Œå»ºé€ å·¥è‰ºçš„è¯ç”Ÿï¼Œäººä»¬è®¾è®¡æ›´é«˜æ°´å¹³çš„èŠ¯ç‰‡äº§ç”Ÿäº†å¯èƒ½ã€‚æ­£æ˜¯æœ‰è¿™äº›æŠ½è±¡æˆ‘ä»¬æ‰èƒ½å¾€å‰èµ°ã€‚</p><p>ä»æ·±åº¦å­¦ä¹ æ¡†æ¶çš„è§’åº¦ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä»é›¶å®ç°æŸä¸ªç½‘ç»œåœ¨å­¦ä¹ è¿‡ç¨‹æ˜¯æœ‰æ„æ€çš„ï¼Œä½†æ˜¯ä»æ±‡ç¼–è¯­è¨€åŒ…è£…æˆé«˜çº§ç¼–ç¨‹è¯­è¨€ï¼Œå†åŒ…è£…æˆä¸€ä¸ªä¸€ä¸ªpackageè€Œå½¢æˆæ¡†æ¶ï¼Œåœ¨å‰äººæŠ½è±¡å¥½çš„åŸºç¡€ä¸Šï¼Œåœ¨æ·±åº¦å­¦ä¹ æ¡†æ¶æ­å»ºçš„åŸºç¡€ä¸Šï¼Œåœ¨ä½¿ç”¨è€…çš„è§’åº¦æ›´åº”è¯¥é‡è§†å¦‚ä½•é«˜æ•ˆçš„ä½¿ç”¨ã€‚</p><p>åŸºäºtorchæ„å»ºçš„PyTorchä¾¿æ˜¯æŠ½è±¡å¥½æ·±åº¦å­¦ä¹ çš„æ¡†æ¶ã€‚</p><p>è¿™é‡Œå¹¶æ²¡æœ‰å‚ç…§ <a href="https://pytorch.org/">PyTorchå®˜ç½‘</a></p><p>è€Œæ˜¯æ‰¾åˆ°ä¸€ä¸ªå¼€æºçš„ <a href="https://handbook.pytorch.wiki/index.html">PyTorchä¸­æ–‡æ‰‹å†Œ</a> æ¥äº†è§£è¿™ä¸ªæ·±åº¦å­¦ä¹ æ¡†æ¶</p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs vhdl">Torch <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> going anywhere. PyTorch <span class="hljs-keyword">and</span> Torch <span class="hljs-keyword">use</span> the same C libraries that contain <span class="hljs-keyword">all</span> the performance: TH, THC, THNN, THCUNN <span class="hljs-keyword">and</span> they will continue <span class="hljs-keyword">to</span> be <span class="hljs-keyword">shared</span>.<br>We still <span class="hljs-keyword">and</span> will have continued engineering <span class="hljs-keyword">on</span> Torch itself, <span class="hljs-keyword">and</span> we have no immediate plan <span class="hljs-keyword">to</span> remove that.<br>PyTorch <span class="hljs-keyword">is</span> an <span class="hljs-keyword">open</span> source machine learning <span class="hljs-keyword">library</span> <span class="hljs-keyword">for</span> Python, based <span class="hljs-keyword">on</span> Torch, used <span class="hljs-keyword">for</span> applications such as <span class="hljs-built_in">natural</span> language processing. It <span class="hljs-keyword">is</span> primarily developed by Facebook<span class="hljs-symbol">&#x27;s</span> artificial-intelligence research <span class="hljs-keyword">group</span>, <span class="hljs-keyword">and</span> Uber<span class="hljs-symbol">&#x27;s</span> <span class="hljs-string">&quot;Pyro&quot;</span> software <span class="hljs-keyword">for</span> probabilistic programming <span class="hljs-keyword">is</span> built <span class="hljs-keyword">on</span> it.<br>PyTorch <span class="hljs-keyword">is</span> a Python <span class="hljs-keyword">package</span> that provides two high-level features:<br><br>    Tensor computation (like NumPy) <span class="hljs-keyword">with</span> <span class="hljs-keyword">strong</span> GPU acceleration<br><br>    Deep neural networks built <span class="hljs-keyword">on</span> a tape-based autograd system<br>You can reuse your favorite Python packages such as NumPy, SciPy <span class="hljs-keyword">and</span> Cython <span class="hljs-keyword">to</span> extend PyTorch <span class="hljs-keyword">when</span> needed.<br></code></pre></td></tr></table></figure><h3 id="12-gpu"><a class="markdownIt-Anchor" href="#12-gpu"></a> 1.2 GPU</h3><p>è¿™é‡Œå‚ç…§wikiæ‰€ç»™çš„è§£é‡Šï¼š<a href="https://zh.wikipedia.org/zh-sg/%E5%9C%96%E5%BD%A2%E8%99%95%E7%90%86%E5%99%A8">å›¾å½¢å¤„ç†å™¨GPUè§£é‡Š</a></p><p><strong>å›¾å½¢å¤„ç†å™¨</strong>ï¼ˆè‹±è¯­ï¼š<strong>G</strong>raphics <strong>P</strong>rocessing <strong>U</strong>nitï¼Œç¼©å†™ï¼š<strong>GPU</strong>ï¼›åˆç§°<strong>æ˜¾ç¤ºæ ¸å¿ƒ</strong>ã€<strong>æ˜¾å¡</strong>ã€<strong>è§†è§‰å¤„ç†å™¨</strong>ã€<strong>æ˜¾ç¤ºèŠ¯ç‰‡</strong>æˆ–<strong>ç»˜å›¾èŠ¯ç‰‡</strong>ï¼‰æ˜¯ä¸€ç§ä¸“é—¨åœ¨<a href="https://zh.wikipedia.org/wiki/%E5%80%8B%E4%BA%BA%E9%9B%BB%E8%85%A6">ä¸ªäººç”µè„‘</a>ã€<a href="https://zh.wikipedia.org/wiki/%E5%B7%A5%E4%BD%9C%E7%AB%99">å·¥ä½œç«™</a>ã€<a href="https://zh.wikipedia.org/wiki/%E9%81%8A%E6%88%B2%E6%A9%9F">æ¸¸æˆæœº</a>å’Œä¸€äº›<a href="https://zh.wikipedia.org/wiki/%E8%A1%8C%E5%8B%95%E8%A3%9D%E7%BD%AE">ç§»åŠ¨è®¾å¤‡</a>ï¼ˆå¦‚<a href="https://zh.wikipedia.org/wiki/%E5%B9%B3%E6%9D%BF%E9%9B%BB%E8%85%A6">å¹³æ¿ç”µè„‘</a>ã€<a href="https://zh.wikipedia.org/wiki/%E6%99%BA%E6%85%A7%E5%9E%8B%E6%89%8B%E6%A9%9F">æ™ºèƒ½æ‰‹æœº</a>ç­‰ï¼‰ä¸Šæ‰§è¡Œç»˜å›¾è¿ç®—å·¥ä½œçš„<a href="https://zh.wikipedia.org/wiki/%E5%BE%AE%E8%99%95%E7%90%86%E5%99%A8">å¾®å¤„ç†å™¨</a>ã€‚</p><p>GPUä¸åŒäºä¼ ç»Ÿçš„CPUï¼Œå¦‚<a href="https://zh.wikipedia.org/wiki/Intel">Intel</a> <a href="https://zh.wikipedia.org/wiki/Intel_Core_i5">i5</a>æˆ–<a href="https://zh.wikipedia.org/wiki/Intel_Core_i7">i7</a>å¤„ç†å™¨ï¼Œå…¶<a href="https://zh.wikipedia.org/wiki/%E5%86%85%E6%A0%B8">å†…æ ¸</a>æ•°é‡è¾ƒå°‘ï¼Œä¸“ä¸ºé€šç”¨è®¡ç®—è€Œè®¾è®¡ã€‚ç›¸åï¼ŒGPUæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å¤„ç†å™¨ï¼Œå…·æœ‰æ•°ç™¾æˆ–æ•°åƒä¸ªå†…æ ¸ï¼Œç»è¿‡ä¼˜åŒ–ï¼Œå¯å¹¶è¡Œè¿è¡Œå¤§é‡è®¡ç®—ã€‚è™½ç„¶GPUåœ¨æ¸¸æˆä¸­ä»¥<a href="https://zh.wikipedia.org/wiki/3D%E6%B8%B2%E6%9F%93">3Dæ¸²æŸ“</a>è€Œé—»åï¼Œä½†å®ƒä»¬å¯¹è¿è¡Œåˆ†æã€<a href="https://zh.wikipedia.org/wiki/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0">æ·±åº¦å­¦ä¹ </a>å’Œ<a href="https://zh.wikipedia.org/wiki/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0">æœºå™¨å­¦ä¹ </a>ç®—æ³•å°¤å…¶æœ‰ç”¨ã€‚GPUå…è®¸æŸäº›è®¡ç®—æ¯”ä¼ ç»ŸCPUä¸Šè¿è¡Œç›¸åŒçš„è®¡ç®—é€Ÿåº¦å¿«10å€è‡³100å€ã€‚</p><h3 id="13-æ•°æ®é›†è¾“å…¥å’Œç»“æœè®¡ç®—"><a class="markdownIt-Anchor" href="#13-æ•°æ®é›†è¾“å…¥å’Œç»“æœè®¡ç®—"></a> 1.3 æ•°æ®é›†è¾“å…¥å’Œç»“æœè®¡ç®—</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># è¯»å–fashionæ•°æ®é›†</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_fashion_mnist</span>(<span class="hljs-params">batchsize,resize=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-comment"># resizeç›¸å½“äºåŸºæœ¬çš„å¡«å……æ¨¡å—</span><br>    <span class="hljs-keyword">import</span> torch<br>    <span class="hljs-keyword">from</span> torch.utils <span class="hljs-keyword">import</span> data<br>    <span class="hljs-keyword">import</span> torchvision<br>    <span class="hljs-keyword">from</span> torchvision <span class="hljs-keyword">import</span> transforms<br><br>    <span class="hljs-keyword">if</span> resize:<br>        trans=[transforms.ToTensor()]<br>        trans.insert(<span class="hljs-number">0</span>, transforms.Resize(resize))<br>        trans = transforms.Compose(trans)<br>    <span class="hljs-keyword">else</span>:<br>        trans=transforms.ToTensor()<br>    train_mnist=torchvision.datasets.FashionMNIST(root=<span class="hljs-string">&#x27;../data/FashionMNIST&#x27;</span>,train=<span class="hljs-literal">True</span>,transform=trans,download=<span class="hljs-literal">True</span>)<br>    test_mnist=torchvision.datasets.FashionMNIST(root=<span class="hljs-string">&#x27;../data/FashionMNIST&#x27;</span>,train=<span class="hljs-literal">False</span>,transform=trans,download=<span class="hljs-literal">True</span>)<br>    train_iter=data.DataLoader(train_mnist,batch_size=batchsize,shuffle=<span class="hljs-literal">True</span>,num_workers=<span class="hljs-number">4</span>)<br>    test_iter=data.DataLoader(test_mnist,batch_size=batchsize,shuffle=<span class="hljs-literal">True</span>,num_workers=<span class="hljs-number">4</span>)<br>    <span class="hljs-keyword">return</span> train_iter,test_iter<br>    <br>batchsize=<span class="hljs-number">256</span><br>train_iter,test_iter=load_fashion_mnist(batchsize,<span class="hljs-number">224</span>)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">accuracy</span>(<span class="hljs-params">y_hat,y</span>):<br>    <span class="hljs-comment"># æ•°æ­£ç¡®çš„æ•°é‡</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(y_hat.shape)&gt;<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> y_hat.shape[<span class="hljs-number">1</span>]&gt;<span class="hljs-number">1</span>:<br>        y_hat=y_hat.argmax(axis=<span class="hljs-number">1</span>)<br>    cmp=y_hat.<span class="hljs-built_in">type</span>(y.dtype)==y<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">float</span>(cmp.<span class="hljs-built_in">type</span>(y.dtype).<span class="hljs-built_in">sum</span>())<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gpu_acc</span>(<span class="hljs-params">model,data_iter,device=<span class="hljs-literal">None</span></span>):<br>    acc=<span class="hljs-number">0</span><br>    num=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(net,nn.Module):<br>        net.<span class="hljs-built_in">eval</span>()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> device:<br>            device=<span class="hljs-built_in">next</span>(<span class="hljs-built_in">iter</span>(net.parameters())).device<br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        <span class="hljs-keyword">for</span> X,y <span class="hljs-keyword">in</span> data_iter:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(X,<span class="hljs-built_in">list</span>):<br>                <span class="hljs-comment"># è¿™é‡Œçš„ifä»…ä»…æ˜¯ä¸ºä¹‹åbertå¾®è°ƒæ‰€éœ€çš„</span><br>                X=[x.to(device) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> X]<br>            <span class="hljs-keyword">else</span>:<br>                X=X.to(device)<br>            y=y.to(device)<br>            acc+=accuracy(net(X),y)<br>            num+=y.numel()<br>    <span class="hljs-keyword">return</span> acc/num<br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">trainer</span>(<span class="hljs-params">net,train_iter,test_iter,num_epoches,lr,device</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;ç”¨GPUè®­ç»ƒæ¨¡å‹&#x27;&#x27;&#x27;</span><br>    <span class="hljs-comment">#åˆå§‹åŒ–å‚æ•°</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">init_weights</span>(<span class="hljs-params">m</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(m)==nn.Linear <span class="hljs-keyword">or</span> <span class="hljs-built_in">type</span>(m)==nn.Conv2d:<br>            nn.init.xavier_uniform_(m.weight)<br>            <span class="hljs-comment">#nn.init.normal_(m.weight,std=0.01)</span><br>    net.apply(init_weights)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;training on&#x27;</span>,device)<br>    <span class="hljs-comment"># print(torch.cuda.get_device_name(0))</span><br>    net.to(device)<br>    optimizer=torch.optim.SGD(net.parameters(),lr=lr)<br>    loss=nn.CrossEntropyLoss()<br><br>    train_acc=[]<br>    test_acc=[]<br>    loss_epoches=[]<br>    <span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_epoches):<br>        temp_train_acc=<span class="hljs-number">0</span><br>        loss_epoch=<span class="hljs-number">0</span><br>        num=<span class="hljs-number">0</span><br>        net.train()<br>        <span class="hljs-keyword">for</span> i,(X,y) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(train_iter):<br>            optimizer.zero_grad()<br>            X,y=X.to(device),y.to(device)<br>            <span class="hljs-keyword">with</span> torch.no_grad():<br>                temp_train_acc+=accuracy(net(X),y)<br>            y_hat=net(X)<br>            l=loss(y_hat,y)<br>            l.backward()<br>            optimizer.step()<br>            loss_epoch+=l*X.shape[<span class="hljs-number">0</span>]<br>            num+=y.numel()<br>        train_acc.append(<span class="hljs-built_in">float</span>(temp_train_acc/num))<br>        test_acc.append(gpu_acc(net,test_iter))<br>        loss_epoches.append(<span class="hljs-built_in">float</span>(loss_epoch)/num)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æœ¬è½®&#123;&#125;è®­ç»ƒçš„ç»“æœï¼Œtestâ€”acc:&#123;&#125;,train-acc:&#123;&#125;,train-loss:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(epoch+<span class="hljs-number">1</span>),<span class="hljs-built_in">str</span>(test_acc[-<span class="hljs-number">1</span>]),<span class="hljs-built_in">str</span>(train_acc[-<span class="hljs-number">1</span>]),<span class="hljs-built_in">str</span>(loss_epoches[-<span class="hljs-number">1</span>])))<br>    <span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>    plt.plot(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>+num_epoches)),test_acc,label=<span class="hljs-string">&#x27;test_acc&#x27;</span>)<br>    plt.plot(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>+num_epoches)),train_acc,label=<span class="hljs-string">&#x27;train_acc&#x27;</span>)<br>    plt.plot(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>+num_epoches)),loss_epoches,label=<span class="hljs-string">&#x27;loss&#x27;</span>)<br>    plt.legend()<br>    plt.show()<br>    <br>        <br>lr,num_epoches=<span class="hljs-number">0.2</span>,<span class="hljs-number">20</span><br><br><br>device = torch.device(<span class="hljs-string">&quot;cuda:0&quot;</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;cpu&quot;</span>)<br>trainer(net,train_iter,test_iter,num_epoches,lr,device)<br></code></pre></td></tr></table></figure><h2 id="0x02-ç»å…¸çš„cnn"><a class="markdownIt-Anchor" href="#0x02-ç»å…¸çš„cnn"></a> 0x02 ç»å…¸çš„CNN</h2><h3 id="21-alexnet"><a class="markdownIt-Anchor" href="#21-alexnet"></a> 2.1 AlexNet</h3><p>ä¹‹å‰çš„é˜…è¯»ç¬”è®°<a href="https://blog.tjdata.site/2022/08/27/paper02-2012-imagenet-classification-with-deep-convolutional-neural-networks/">paper02-2012-imagenet-classification-with-deep-convolutional-neural-networks</a></p><p>ä¸»è¦çš„è´¡çŒ®ï¼Œä»¥åŠåé¢æ²¡æœ‰ç”¨çš„åœ°æ–¹</p><ol><li>å¼•å…¥äº†ReLuæ¿€æ´»å‡½æ•°ï¼Œè®©è®­ç»ƒçš„æ›´å¿«</li><li>åˆ©ç”¨åŒGPUè®­ç»ƒï¼Œæ³¨æ„è¿™é‡Œå¯¹ç½‘ç»œç»“æ„è¿›è¡Œåˆ’åˆ†ï¼ˆå¯¹ç½‘ç»œä¸åŒå±‚è¿›è¡Œåˆ‡å‰²è€Œä¸æ˜¯åˆ‡å‰²æˆä¸¤ç§å°çš„éƒ¨åˆ†ï¼‰ï¼Œå·¥ç¨‹èƒ½åŠ›å¤ªå¼ºäº†</li><li>ï¼ˆæ²¡æœ‰ç”¨ï¼‰ä¸€ç§local response normalizationï¼Œä½†æ˜¯ç¡®å®éœ€è¦åœ¨è¿™ä¸ªæ–¹é¢åštrickï¼Œåœ¨åé¢çš„resNetä¸­å¯ä»¥çœ‹åˆ°</li><li>ï¼ˆæ²¡æœ‰ç”¨ï¼‰æ–°çš„overlapping poolingï¼Œä¸€ç§æ–°çš„æ± åŒ–æ–¹æ³•ï¼Œè¿™ä¸ªä¸åŒGPUæœ‰å…³</li><li>ï¼ˆæœ‰ç”¨ï¼Œä½†æ˜¯è§£é‡Šä¸å¯¹ï¼‰å°†dropoutå¼•å…¥è®­ç»ƒè¿‡ç¨‹ï¼Œå°è¯•è§£é‡Šä¸ºensemble learningï¼Œä½†ç°åœ¨æ›´åå‘äºregularization</li><li>æ•°æ®å¢å¼ºï¼Œæ‰æœ‰éšæœºæŠ½æ ·æ•°æ®çš„æ–¹å¼ï¼Œå°†256æå–å¾—åˆ°224æ¥æ‰©å……æ•°æ®é›†</li></ol><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6gmxhdh2sj20t60gmtb7.jpg" alt="image-20220923164858838" /></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch <br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-comment">#AlexNet</span><br>net = nn.Sequential(<br>    <span class="hljs-comment"># è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª11*11çš„æ›´å¤§çª—å£æ¥æ•æ‰å¯¹è±¡ã€‚</span><br>    <span class="hljs-comment"># åŒæ—¶ï¼Œæ­¥å¹…ä¸º4ï¼Œä»¥å‡å°‘è¾“å‡ºçš„é«˜åº¦å’Œå®½åº¦ã€‚</span><br>    <span class="hljs-comment"># å¦å¤–ï¼Œè¾“å‡ºé€šé“çš„æ•°ç›®è¿œå¤§äºLeNet</span><br>    nn.Conv2d(<span class="hljs-number">1</span>, <span class="hljs-number">96</span>, kernel_size=<span class="hljs-number">11</span>, stride=<span class="hljs-number">4</span>, padding=<span class="hljs-number">1</span>), nn.ReLU(),<br>    nn.MaxPool2d(kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">2</span>),<br>    <span class="hljs-comment"># å‡å°å·ç§¯çª—å£ï¼Œä½¿ç”¨å¡«å……ä¸º2æ¥ä½¿å¾—è¾“å…¥ä¸è¾“å‡ºçš„é«˜å’Œå®½ä¸€è‡´ï¼Œä¸”å¢å¤§è¾“å‡ºé€šé“æ•°</span><br>    nn.Conv2d(<span class="hljs-number">96</span>, <span class="hljs-number">256</span>, kernel_size=<span class="hljs-number">5</span>, padding=<span class="hljs-number">2</span>), nn.ReLU(),<br>    nn.MaxPool2d(kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">2</span>),<br>    <span class="hljs-comment"># ä½¿ç”¨ä¸‰ä¸ªè¿ç»­çš„å·ç§¯å±‚å’Œè¾ƒå°çš„å·ç§¯çª—å£ã€‚</span><br>    <span class="hljs-comment"># é™¤äº†æœ€åçš„å·ç§¯å±‚ï¼Œè¾“å‡ºé€šé“çš„æ•°é‡è¿›ä¸€æ­¥å¢åŠ ã€‚</span><br>    <span class="hljs-comment"># åœ¨å‰ä¸¤ä¸ªå·ç§¯å±‚ä¹‹åï¼Œæ±‡èšå±‚ä¸ç”¨äºå‡å°‘è¾“å…¥çš„é«˜åº¦å’Œå®½åº¦</span><br>    nn.Conv2d(<span class="hljs-number">256</span>, <span class="hljs-number">384</span>, kernel_size=<span class="hljs-number">3</span>, padding=<span class="hljs-number">1</span>), nn.ReLU(),<br>    nn.Conv2d(<span class="hljs-number">384</span>, <span class="hljs-number">384</span>, kernel_size=<span class="hljs-number">3</span>, padding=<span class="hljs-number">1</span>), nn.ReLU(),<br>    nn.Conv2d(<span class="hljs-number">384</span>, <span class="hljs-number">256</span>, kernel_size=<span class="hljs-number">3</span>, padding=<span class="hljs-number">1</span>), nn.ReLU(),<br>    nn.MaxPool2d(kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">2</span>),<br>    nn.Flatten(),<br>    <span class="hljs-comment"># è¿™é‡Œï¼Œå…¨è¿æ¥å±‚çš„è¾“å‡ºæ•°é‡æ˜¯LeNetä¸­çš„å¥½å‡ å€ã€‚ä½¿ç”¨dropoutå±‚æ¥å‡è½»è¿‡æ‹Ÿåˆ</span><br>    nn.Linear(<span class="hljs-number">6400</span>, <span class="hljs-number">4096</span>), nn.ReLU(),<br>    nn.Dropout(p=<span class="hljs-number">0.5</span>),<br>    nn.Linear(<span class="hljs-number">4096</span>, <span class="hljs-number">4096</span>), nn.ReLU(),<br>    nn.Dropout(p=<span class="hljs-number">0.5</span>),<br>    <span class="hljs-comment"># æœ€åæ˜¯è¾“å‡ºå±‚ã€‚ç”±äºè¿™é‡Œä½¿ç”¨Fashion-MNISTï¼Œæ‰€ä»¥ç”¨ç±»åˆ«æ•°ä¸º10ï¼Œè€Œéè®ºæ–‡ä¸­çš„1000</span><br>    nn.Linear(<span class="hljs-number">4096</span>, <span class="hljs-number">10</span>))<br></code></pre></td></tr></table></figure><h3 id="22-vgg"><a class="markdownIt-Anchor" href="#22-vgg"></a> 2.2 VGG</h3><p><a href="https://arxiv.org/pdf/1409.1556.pdf">VERY DEEP CONVOLUTIONAL NETWORKS FOR LARGE-SCALE IMAGE RECOGNITION</a></p><p>AlexNetè¯æ˜ #å·ç§¯ç¥ç»ç½‘ç»œ CNN convolutional- neural-network çš„æ·±åº¦æ˜¯æœ‰æ•ˆçš„ï¼Œä½†å¹¶æ²¡æœ‰ç»™å‡ºæ¨¡ç‰ˆæ¥è¿›è¡Œåˆ›å»ºç½‘ç»œã€‚è¿™é‡Œä¸€ä¸ªç›´è§‰çš„æƒ³æ³•</p><p>ä¸èŠ¯ç‰‡è®¾è®¡ä¸­å·¥ç¨‹å¸ˆä»æ”¾ç½®æ™¶ä½“ç®¡åˆ°é€»è¾‘å…ƒä»¶å†åˆ°é€»è¾‘å—çš„è¿‡ç¨‹ç±»ä¼¼ï¼Œç¥ç»ç½‘ç»œæ¶æ„è®¾è®¡ä¹Ÿé€æ¸å˜æˆæ›´åŠ æŠ½è±¡ï¼Œç ”ç©¶äººå‘˜å¼€å§‹ä»å•ä¸ªç¥ç»å…ƒçš„è§’åº¦æ€è€ƒé—®é¢˜ï¼Œå‘å±•åˆ°æ•´ä¸ªå±‚ï¼Œè½¬å‘å¯ä»¥å¤ç”¨å±‚çš„å—çš„æ¨¡å¼ #memo</p><p>ä½¿ç”¨ #å¾ªç¯loop å’Œ å­å‡½æ•° æ¥å®ç° #VGG</p><p>ä¸»è¦åšå‡ºçš„è´¡çŒ®</p><ol><li>åˆ©ç”¨å¤ç”¨çš„æ€è·¯æ„å»ºå·ç§¯å—</li><li>ä½œè€…å°è¯•å„ç§æ¶æ„ï¼Œæœ€ç»ˆå‘ç°æ·±ä¸”çª„çš„ç½‘ç»œæ•ˆæœæ˜¯è¾ƒå¥½çš„</li></ol><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6gn1hnzssj20ng0kmgnu.jpg" alt="image-20220923165253079" /></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch <br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">vgg_block</span>(<span class="hljs-params">num_convs, in_channels, out_channels</span>):<br>    layers = []<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_convs):<br>        layers.append(nn.Conv2d(in_channels, out_channels,<br>                                kernel_size=<span class="hljs-number">3</span>, padding=<span class="hljs-number">1</span>))<br>        layers.append(nn.ReLU())<br>        in_channels = out_channels<br>    layers.append(nn.MaxPool2d(kernel_size=<span class="hljs-number">2</span>,stride=<span class="hljs-number">2</span>))<br>    <span class="hljs-keyword">return</span> nn.Sequential(*layers)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">vgg</span>(<span class="hljs-params">conv_arch</span>):<br>    conv_blks = []<br>    in_channels = <span class="hljs-number">1</span><br>    <span class="hljs-comment"># å·ç§¯å±‚éƒ¨åˆ†</span><br>    <span class="hljs-keyword">for</span> (num_convs, out_channels) <span class="hljs-keyword">in</span> conv_arch:<br>        conv_blks.append(vgg_block(num_convs, in_channels, out_channels))<br>        in_channels = out_channels<br><br>    <span class="hljs-keyword">return</span> nn.Sequential(<br>        *conv_blks, nn.Flatten(),<br>        <span class="hljs-comment"># å…¨è¿æ¥å±‚éƒ¨åˆ†</span><br>        nn.Linear(out_channels * <span class="hljs-number">7</span> * <span class="hljs-number">7</span>, <span class="hljs-number">4096</span>), nn.ReLU(), nn.Dropout(<span class="hljs-number">0.5</span>),<br>        nn.Linear(<span class="hljs-number">4096</span>, <span class="hljs-number">4096</span>), nn.ReLU(), nn.Dropout(<span class="hljs-number">0.5</span>),<br>        nn.Linear(<span class="hljs-number">4096</span>, <span class="hljs-number">10</span>))<br><br>conv_arch = ((<span class="hljs-number">1</span>, <span class="hljs-number">64</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">128</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">256</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">512</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">512</span>))<br>ratio = <span class="hljs-number">4</span><br>small_conv_arch = [(pair[<span class="hljs-number">0</span>], pair[<span class="hljs-number">1</span>] // ratio) <span class="hljs-keyword">for</span> pair <span class="hljs-keyword">in</span> conv_arch]<br>net = vgg(small_conv_arch)<br></code></pre></td></tr></table></figure><h3 id="23-nin"><a class="markdownIt-Anchor" href="#23-nin"></a> 2.3 NiN</h3><p><a href="https://arxiv.org/pdf/1312.4400.pdf">Network in network</a></p><p>AlexNetæå‡ºä½¿ç”¨æ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œï¼ŒVGGç»™å‡ºå¦‚ä½•å¤ç”¨çš„æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œï¼ŒVGGåˆ™æ˜¯åœ¨è¿™ä¸ªåŸºç¡€ä¸Šåˆ©ç”¨MLPå¯¹å¤šé€šé“è¾“å…¥å’Œå¤šé€šé“è¾“å‡ºè¿›è¡Œæ“ä½œï¼Œå–ä»£ä¹‹å‰ç®€å•çš„åŠ æƒæ–¹å¼ï¼ŒNiNåˆ©ç”¨è¿™æ¥å¯¹ç½‘ç»œçš„æ‰©å¤§å’Œæ·±åº¦ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6gn6t6xxmj20xl0u0dj3.jpg" alt="image-20220923165759261" /></p><h3 id="24-googlenet"><a class="markdownIt-Anchor" href="#24-googlenet"></a> 2.4 GoogLeNet</h3><p><a href="https://arxiv.org/pdf/1409.4842.pdf">Going deeper with convolutions</a></p><p>GoogLeNetå€Ÿç”¨NiNçš„æ€æƒ³ï¼Œåœ¨å®ƒçš„åŸºç¡€ä¸Šè®¾ç½®æ¥inceptionå—ï¼Œç”¨æ¥å®ç°å¤šä¸ªå·ç§¯æ ¸å¯¹å›¾å½¢ç‰¹å¾çš„æå–</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6gn7umg3uj212e0da3zz.jpg" alt="image-20220923165859815" /></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç½‘ç»œ3.5 GoogLeNet</span><br><br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">from</span> torch.nn <span class="hljs-keyword">import</span> functional <span class="hljs-keyword">as</span> F<br><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Inception</span>(nn.Module):<br>    <span class="hljs-comment"># c1--c4æ˜¯æ¯æ¡è·¯å¾„çš„è¾“å‡ºé€šé“æ•°</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, in_channels, c1, c2, c3, c4, **kwargs</span>):<br>        <span class="hljs-built_in">super</span>(Inception, self).__init__(**kwargs)<br>        <span class="hljs-comment"># çº¿è·¯1ï¼Œå•1x1å·ç§¯å±‚</span><br>        self.p1_1 = nn.Conv2d(in_channels, c1, kernel_size=<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># çº¿è·¯2ï¼Œ1x1å·ç§¯å±‚åæ¥3x3å·ç§¯å±‚</span><br>        self.p2_1 = nn.Conv2d(in_channels, c2[<span class="hljs-number">0</span>], kernel_size=<span class="hljs-number">1</span>)<br>        self.p2_2 = nn.Conv2d(c2[<span class="hljs-number">0</span>], c2[<span class="hljs-number">1</span>], kernel_size=<span class="hljs-number">3</span>, padding=<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># çº¿è·¯3ï¼Œ1x1å·ç§¯å±‚åæ¥5x5å·ç§¯å±‚</span><br>        self.p3_1 = nn.Conv2d(in_channels, c3[<span class="hljs-number">0</span>], kernel_size=<span class="hljs-number">1</span>)<br>        self.p3_2 = nn.Conv2d(c3[<span class="hljs-number">0</span>], c3[<span class="hljs-number">1</span>], kernel_size=<span class="hljs-number">5</span>, padding=<span class="hljs-number">2</span>)<br>        <span class="hljs-comment"># çº¿è·¯4ï¼Œ3x3æœ€å¤§æ±‡èšå±‚åæ¥1x1å·ç§¯å±‚</span><br>        self.p4_1 = nn.MaxPool2d(kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">1</span>, padding=<span class="hljs-number">1</span>)<br>        self.p4_2 = nn.Conv2d(in_channels, c4, kernel_size=<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        p1 = F.relu(self.p1_1(x))<br>        p2 = F.relu(self.p2_2(F.relu(self.p2_1(x))))<br>        p3 = F.relu(self.p3_2(F.relu(self.p3_1(x))))<br>        p4 = F.relu(self.p4_2(self.p4_1(x)))<br>        <span class="hljs-comment"># åœ¨é€šé“ç»´åº¦ä¸Šè¿ç»“è¾“å‡º</span><br>        <span class="hljs-keyword">return</span> torch.cat((p1, p2, p3, p4), dim=<span class="hljs-number">1</span>)<br><br>b1 = nn.Sequential(nn.Conv2d(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>, kernel_size=<span class="hljs-number">7</span>, stride=<span class="hljs-number">2</span>, padding=<span class="hljs-number">3</span>),<br>                   nn.ReLU(),<br>                   nn.MaxPool2d(kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">2</span>, padding=<span class="hljs-number">1</span>))<br><br>b2 = nn.Sequential(nn.Conv2d(<span class="hljs-number">64</span>, <span class="hljs-number">64</span>, kernel_size=<span class="hljs-number">1</span>),<br>                   nn.ReLU(),<br>                   nn.Conv2d(<span class="hljs-number">64</span>, <span class="hljs-number">192</span>, kernel_size=<span class="hljs-number">3</span>, padding=<span class="hljs-number">1</span>),<br>                   nn.ReLU(),<br>                   nn.MaxPool2d(kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">2</span>, padding=<span class="hljs-number">1</span>))<br>b3 = nn.Sequential(Inception(<span class="hljs-number">192</span>, <span class="hljs-number">64</span>, (<span class="hljs-number">96</span>, <span class="hljs-number">128</span>), (<span class="hljs-number">16</span>, <span class="hljs-number">32</span>), <span class="hljs-number">32</span>),<br>                   Inception(<span class="hljs-number">256</span>, <span class="hljs-number">128</span>, (<span class="hljs-number">128</span>, <span class="hljs-number">192</span>), (<span class="hljs-number">32</span>, <span class="hljs-number">96</span>), <span class="hljs-number">64</span>),<br>                   nn.MaxPool2d(kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">2</span>, padding=<span class="hljs-number">1</span>))<br>b4 = nn.Sequential(Inception(<span class="hljs-number">480</span>, <span class="hljs-number">192</span>, (<span class="hljs-number">96</span>, <span class="hljs-number">208</span>), (<span class="hljs-number">16</span>, <span class="hljs-number">48</span>), <span class="hljs-number">64</span>),<br>                   Inception(<span class="hljs-number">512</span>, <span class="hljs-number">160</span>, (<span class="hljs-number">112</span>, <span class="hljs-number">224</span>), (<span class="hljs-number">24</span>, <span class="hljs-number">64</span>), <span class="hljs-number">64</span>),<br>                   Inception(<span class="hljs-number">512</span>, <span class="hljs-number">128</span>, (<span class="hljs-number">128</span>, <span class="hljs-number">256</span>), (<span class="hljs-number">24</span>, <span class="hljs-number">64</span>), <span class="hljs-number">64</span>),<br>                   Inception(<span class="hljs-number">512</span>, <span class="hljs-number">112</span>, (<span class="hljs-number">144</span>, <span class="hljs-number">288</span>), (<span class="hljs-number">32</span>, <span class="hljs-number">64</span>), <span class="hljs-number">64</span>),<br>                   Inception(<span class="hljs-number">528</span>, <span class="hljs-number">256</span>, (<span class="hljs-number">160</span>, <span class="hljs-number">320</span>), (<span class="hljs-number">32</span>, <span class="hljs-number">128</span>), <span class="hljs-number">128</span>),<br>                   nn.MaxPool2d(kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">2</span>, padding=<span class="hljs-number">1</span>))<br>b5 = nn.Sequential(Inception(<span class="hljs-number">832</span>, <span class="hljs-number">256</span>, (<span class="hljs-number">160</span>, <span class="hljs-number">320</span>), (<span class="hljs-number">32</span>, <span class="hljs-number">128</span>), <span class="hljs-number">128</span>),<br>                   Inception(<span class="hljs-number">832</span>, <span class="hljs-number">384</span>, (<span class="hljs-number">192</span>, <span class="hljs-number">384</span>), (<span class="hljs-number">48</span>, <span class="hljs-number">128</span>), <span class="hljs-number">128</span>),<br>                   nn.AdaptiveAvgPool2d((<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)),<br>                   nn.Flatten())<br><br>net = nn.Sequential(b1, b2, b3, b4, b5, nn.Linear(<span class="hljs-number">1024</span>, <span class="hljs-number">10</span>))<br></code></pre></td></tr></table></figure><h3 id="25-resnet"><a class="markdownIt-Anchor" href="#25-resnet"></a> 2.5 ResNet</h3><p><a href="https://arxiv.org/abs/1512.03385">Deep Residual Learning for Image Recognition</a></p><p>åœ¨ä¹‹å‰ä»‹ç»æ›´æ·±ã€æ›´å¹¿çš„åŸºç¡€ä¸Šï¼Œresnetæ›´å¤šçš„æ˜¯è§£é‡Šå¦‚ä½•æé«˜ç¥ç»ç½‘ç»œçš„æ€§èƒ½</p><p>éƒ¨åˆ†çš„æ•°å­¦åŸºç¡€ï¼Œä»å­¦ä¹ ç†è®ºçš„è§’åº¦å‡ºå‘ï¼Œå¦‚æœæ¨¡å‹çš„å¤æ‚ç¨‹åº¦é€æ¸å¢åŠ ï¼Œè¿™æ ·å¯»æ‰¾ä¹‹å‰çš„å‡½æ•°é›†åˆçš„èŒƒå›´æ˜¯æ¯”è¾ƒå¤§ï¼Œè¿™æ ·å¯»æ‰¾åˆ°ä¹‹åçš„ç»“æœæ˜¯éå¸¸å›°éš¾çš„ï¼Œå› æ­¤å¯ä»¥å°è¯•å°†æ’ç­‰æ˜ å°„è½¬æ¢æˆä¸ºåŒ…å«æ•°é‡æœ¬èº«å’Œæ®‹å·®ä¹‹é—´çš„å…³ç³»</p><p>å€Ÿé‰´GBDTä¸­æ¢¯åº¦æå‡çš„æ€æƒ³ï¼Œæ®‹å·®é—®é¢˜åœ¨ç°å®ä¸­å¾€å¾€æ›´åŠ å®¹æ˜“ä¼˜åŒ–ï¼ŒåŒæ—¶åœ¨æ¨¡å‹ä¸ºç†æƒ³å‚æ•°æ›´å®¹æ˜“æ•æ‰æ’ç­‰æ˜ å°„çš„ç»†å¾®æ³¢åŠ¨ï¼Œï¼›åœ¨å®é™…è®­ç»ƒä¸­ï¼Œæ®‹å·®å—ä¸­è¾“å…¥å¯ä»¥é€šè¿‡è·¨å±‚æ•°æ®çº¿è·¯æ›´å¿«çš„å‘å‰ä¼ æ’­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">from</span> torch.nn <span class="hljs-keyword">import</span> functional <span class="hljs-keyword">as</span> F<br><span class="hljs-keyword">from</span> d2l <span class="hljs-keyword">import</span> torch <span class="hljs-keyword">as</span> d2l<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Residual</span>(nn.Module):  <span class="hljs-comment">#@save</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, input_channels, num_channels,</span><br><span class="hljs-params">                 use_1x1conv=<span class="hljs-literal">False</span>, strides=<span class="hljs-number">1</span></span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.conv1 = nn.Conv2d(input_channels, num_channels,<br>                               kernel_size=<span class="hljs-number">3</span>, padding=<span class="hljs-number">1</span>, stride=strides)<br>        self.conv2 = nn.Conv2d(num_channels, num_channels,<br>                               kernel_size=<span class="hljs-number">3</span>, padding=<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span> use_1x1conv:<br>            self.conv3 = nn.Conv2d(input_channels, num_channels,<br>                                   kernel_size=<span class="hljs-number">1</span>, stride=strides)<br>        <span class="hljs-keyword">else</span>:<br>            self.conv3 = <span class="hljs-literal">None</span><br>        self.bn1 = nn.BatchNorm2d(num_channels)<br>        self.bn2 = nn.BatchNorm2d(num_channels)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, X</span>):<br>        Y = F.relu(self.bn1(self.conv1(X)))<br>        Y = self.bn2(self.conv2(Y))<br>        <span class="hljs-keyword">if</span> self.conv3:<br>            X = self.conv3(X)<br>        Y += X<br>        <span class="hljs-keyword">return</span> F.relu(Y)<br>b1 = nn.Sequential(nn.Conv2d(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>, kernel_size=<span class="hljs-number">7</span>, stride=<span class="hljs-number">2</span>, padding=<span class="hljs-number">3</span>),<br>                   nn.BatchNorm2d(<span class="hljs-number">64</span>), nn.ReLU(),<br>                   nn.MaxPool2d(kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">2</span>, padding=<span class="hljs-number">1</span>))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">resnet_block</span>(<span class="hljs-params">input_channels, num_channels, num_residuals,</span><br><span class="hljs-params">                 first_block=<span class="hljs-literal">False</span></span>):<br>    blk = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_residuals):<br>        <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> first_block:<br>            blk.append(Residual(input_channels, num_channels,<br>                                use_1x1conv=<span class="hljs-literal">True</span>, strides=<span class="hljs-number">2</span>))<br>        <span class="hljs-keyword">else</span>:<br>            blk.append(Residual(num_channels, num_channels))<br>    <span class="hljs-keyword">return</span> blk<br>b2 = nn.Sequential(*resnet_block(<span class="hljs-number">64</span>, <span class="hljs-number">64</span>, <span class="hljs-number">2</span>, first_block=<span class="hljs-literal">True</span>))<br>b3 = nn.Sequential(*resnet_block(<span class="hljs-number">64</span>, <span class="hljs-number">128</span>, <span class="hljs-number">2</span>))<br>b4 = nn.Sequential(*resnet_block(<span class="hljs-number">128</span>, <span class="hljs-number">256</span>, <span class="hljs-number">2</span>))<br>b5 = nn.Sequential(*resnet_block(<span class="hljs-number">256</span>, <span class="hljs-number">512</span>, <span class="hljs-number">2</span>))<br>net = nn.Sequential(b1, b2, b3, b4, b5,<br>                    nn.AdaptiveAvgPool2d((<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)),<br>                    nn.Flatten(), nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">10</span>))<br></code></pre></td></tr></table></figure><h3 id="26-densenet"><a class="markdownIt-Anchor" href="#26-densenet"></a> 2.6 DenseNet</h3><p><a href="https://arxiv.org/pdf/1608.06993.pdf">Densely Connected Convolutional Networks</a></p><p>ï½è¿˜æ²¡çœ‹ä¸é‡è¦æ</p><h2 id="0x03-result"><a class="markdownIt-Anchor" href="#0x03-result"></a> 0x03 Result</h2><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6goeu8sttj21430u0761.jpg" alt="AlexNet" /></p><h2 id="0x04-discussion"><a class="markdownIt-Anchor" href="#0x04-discussion"></a> 0x04 Discussion</h2><p>å·ç§¯ç¥ç»ç½‘ç»œæå–ç‰¹å¾çš„åŸºæœ¬åœ¨äºç‰¹å¾çš„å¹³ç§»ä¸å˜å’Œç¼©æ”¾ä¸å˜ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šåˆ©ç”¨äº’ç›¸å…³æ“ä½œï¼ˆé”™è¯¯çš„è¢«ç§°ä¸ºå·ç§¯ï¼‰åœ¨æå–ç‰¹å¾ã€‚åŒæ—¶åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å›´ç»•äº†å¦‚ä½•æ„å»ºæ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œï¼Œä¸»æµçš„blakcboneç»™å‡ºè‡ªå·±è‡ªå·±çš„å‘å±•å†å²ï¼š</p><ol><li>lenetæœ€æ—©ç»™å‡ºå·ç§¯ç¥ç»ç½‘ç»œçš„é›å½¢</li><li>alexnetä»è®­ç»ƒç¡¬ä»¶ã€è®­ç»ƒç½‘ç»œã€è®­ç»ƒæ•°æ®ã€æ•°æ®é¢„å¤„ç†ã€è®­ç»ƒè¿‡ç¨‹å¤šä¸ªæ–¹é¢ç»™å‡ºäº†è‡ªå·±çš„trickï¼Œä¸ºåé¢æ‰“ä¸‹åŸºç¡€</li><li>vggå›´ç»•å¦‚ä½•æ„å»ºæ›´æ·±çš„ç½‘ç»œï¼Œå¼•å…¥å¤ç”¨</li><li>ninæå‡ºä¸€ä¸ªtrickæ¥æ„å»ºæ›´å¹¿çš„ç½‘ç»œ</li><li>Googlenetåœ¨ninçš„åŸºç¡€ä¸Šï¼Œå—å¯å‘é‡‡ç”¨å¤šä¸ªå·ç§¯æ ¸æå–ç‰¹å¾</li><li>åœ¨å‰äººæ„å»ºå¥½å®Œæ•´çš„ç½‘ç»œçš„åŸºç¡€ä¸Šï¼Œresnetç»™å‡ºå¦‚ä½•ä¿æŒç½‘ç»œç¨³å®šæ€§çš„æ–¹æ³•</li><li>densenetè¿˜æ²¡æœ‰äº†è§£</li></ol><p>è¿™ä¸ªè¿‡ç¨‹éå¸¸çš„æœ‰æ„æ€ï¼Œå¯ä»¥çœ‹åˆ°åˆ«äººæ˜¯å¦‚ä½•å‰è¿›çš„ã€‚è¿™äº›éƒ½å½’åŠŸææ²è€å¸ˆçš„æ€»ç»“ï¼</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;åœ¨åˆç­‰å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºä»å¹³ç§»ä¸å˜å’Œç¼©æ”¾ä¸å˜æ€§è´¨è€Œå¾—åˆ°çš„å·ç§¯æ€§è´¨çš„åŸºç¡€ä¸Šï¼Œåœ¨ä¸Šä¸ªä¸–çºªè¯ç”Ÿçš„LeNetæˆåŠŸå®ç°ä¸ä¹‹å‰ä¸åŒçš„è·¯å¾„ï¼Œåœ¨GPUè¯ç”Ÿä¹‹åï¼Œæ–°çš„ç½‘ç»œAlexNetã€VGGã€NiNã€GoogLeNetã€Residual Netã€DenseNeté€æ¸å‘å±•ã€‚å·ç§¯ç¥ç»ç½‘ç»œä»å˜æ·±å˜å¤šï¼Œé€æ¸åˆ°å˜æˆå—ä»¥åŠä¸€äº›trickçš„å¢åŠ ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="ML&amp;DL" scheme="https://blog.tjdata.site/categories/ML-DL/"/>
    
    
    <category term="D2L" scheme="https://blog.tjdata.site/tags/D2L/"/>
    
  </entry>
  
  <entry>
    <title>åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ 02_åˆç­‰å·ç§¯ç¥ç»LeNetå®ç°</title>
    <link href="https://blog.tjdata.site/posts/c3baf47e.html"/>
    <id>https://blog.tjdata.site/posts/c3baf47e.html</id>
    <published>2022-09-16T14:41:17.000Z</published>
    <updated>2023-05-13T13:51:49.580Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä»‹ç»ä¸€ä¸ªåŸºæœ¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹çº¿æ€§å›å½’å®ç°çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œå°†å…¶æ­¥éª¤åˆ†ä¸ºå…«ä¸ªéƒ¨åˆ†ã€‚ä¹‹åD2Lä¸­ä»‹ç»äº†soft Maxã€MLPç­‰ç®€å•çš„æ¨¡å‹ã€‚è¿™é‡Œè¿ˆå‘æ·±åº¦å­¦ä¹ ï¼Œåˆ©ç”¨ç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œæ¥ä»‹ç»æ·±åº¦å­¦ä¹ APIçš„ä½¿ç”¨è¿‡ç¨‹ï¼Œä»é›¶å¼€å§‹æ­å»ºæ¨¡å‹ï¼Œå°†å…¶åˆ†ä¸ºæ•°æ®é›†é¢„å¤„ç†ã€æ„å»ºæ¨¡å‹å’Œè®­ç»ƒåŠè¯„ä¼°ä¸‰ä¸ªæ­¥éª¤ã€‚</p><span id="more"></span><h2 id="0x01-introduction-of-cnn"><a class="markdownIt-Anchor" href="#0x01-introduction-of-cnn"></a> 0x01 Introduction of CNN</h2><h3 id="11-å·ç§¯çš„ç”±æ¥"><a class="markdownIt-Anchor" href="#11-å·ç§¯çš„ç”±æ¥"></a> 1.1 å·ç§¯çš„ç”±æ¥</h3><p>æˆ‘ä»¬å¯ä»¥å°†MNISTæ•°æ®é›†ä¸­çš„è¾“å…¥å˜é‡ï¼ˆ28ï¼Œ28ï¼‰çš„äºŒç»´å¼ é‡ç»™å±•å¹³ï¼ˆflattenï¼‰æˆä¸º784çš„å‘é‡ï¼Œç„¶ååœ¨ä½¿ç”¨è¶³å¤Ÿæ·±çš„MLPæ¥è¿›è¡Œè®­ç»ƒï¼Œä½†æ˜¯è¿™æ ·é€ æˆæœ€ç›´è§‚çš„ç»“æœå°±æ˜¯æ¨¡å‹çš„å‚æ•°ä¼šç›´çº¿ä¸Šå‡ï¼Œå› ä¸ºæˆ‘çš„è¾“å…¥è¶³å¤Ÿå¤šï¼ŒåŒæ—¶ä¸ºå¸Œæœ›æ¨¡å‹ç»“æœå¥½çš„æƒ…å†µéœ€è¦ä¹Ÿéœ€è¦è¶³å¤Ÿæ·±ï¼Œè¿™æ ·é€ æˆè®­ç»ƒè¿‡ç¨‹çš„è®¡ç®—å¼€é”€æ˜¯å·¨å¤§çš„ã€‚ï¼ˆè¿™æ˜¯å¾ˆç›´è§‚çš„ï¼Œä½†æ˜¯ç†è®ºä¸Šè¿™æ ·è®­ç»ƒå‡ºæ¥çš„ç½‘ç»œä¼šéå¸¸å¥½ã€‚å¯èƒ½æ˜¯è¿™æ ·ï¼Ÿï¼‰</p><p>ä¸ºäº†å¼¥è¡¥ç®—åŠ›çš„ä¸è¶³ï¼Œéœ€è¦å¯»æ‰¾æ–°çš„æ–¹å¼ï¼Ÿåˆ†æå›¾åƒè¯†åˆ«ä¸­ç›®æ ‡æˆ‘ä»¬ä¼šçœ‹å‡ºå…·æœ‰ä¸¤ä¸ªåŸºæœ¬ç‰¹æ€§ï¼š</p><ol><li>å¹³ç§»ä¸å˜æ€§translating- invarianceï¼Œä¸ç®¡æ£€æµ‹å¯¹è±¡å‡ºç°åœ¨å›¾åƒçš„å“ªä¸ªä½ç½®ï¼Œç¥ç»ç½‘ç»œçš„å‰é¢å‡ å±‚åº”è¯¥å¯¹ç›¸åŒçš„å›¾åƒåŒºåŸŸå…·æœ‰ç›¸ä¼¼çš„ååº”</li><li>å±€éƒ¨æ€§localityï¼Œç¥ç»ç½‘ç»œå‰å‡ å±‚åº”è¯¥åªæ¢ç´¢è¾“å…¥å›¾åƒä¸­çš„å±€éƒ¨åŒºåŸŸï¼Œè€Œä¸æ˜¯è¿‡åº¦åœ¨æ„æ•´ä¸ªå›¾åƒå…¶ä»–åŒºåŸŸçš„å…³ç³»</li></ol><p>åŒæ—¶åœ¨ä¿¡å·å¤„ç†ä¸­æˆ‘ä»¬ä¹Ÿæœ‰ä¼šæ»¤æ³¢å™¨çš„æ¦‚å¿µï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯åˆ©ç”¨åƒç´ ä¹‹é—´å˜åŒ–çš„è¶‹åŠ¿æ¥è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚ä¸­å€¼æ»¤æ³¢å¯ä»¥é™å™ªã€åˆ©ç”¨å·®åˆ†å¯ä»¥è¯†åˆ«å›¾åƒè½®å»“</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h68s07nrauj20vv0u0jwe.jpg" alt="image-20220916214004258" /></p><p>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºå·ç§¯çš„æ“ä½œæ˜¯æœ‰æ•ˆçš„ï¼ŒåŒæ—¶ä½¿ç”¨ï¼ˆ3ï¼Œ3ï¼‰çš„filteræ¥å¯¹ï¼ˆ28ï¼Œ28ï¼‰çš„å›¾åƒå¤„ç†æœ€ç»ˆå¾—åˆ°ï¼ˆ26ï¼Œ26ï¼‰çš„å›¾åƒï¼Œæ‰§è¡Œçš„æ“ä½œæ¬¡æ•°ä»…ä¸º26*26.ä¼šè®©å‚æ•°æ•°é‡ä¸‹é™</p><h3 id="12-å·ç§¯çš„å®ç°äº’ç›¸å…³è¿ç®—-å¡«å……padding-æ­¥é•¿stride-å¤šé€šé“"><a class="markdownIt-Anchor" href="#12-å·ç§¯çš„å®ç°äº’ç›¸å…³è¿ç®—-å¡«å……padding-æ­¥é•¿stride-å¤šé€šé“"></a> 1.2 å·ç§¯çš„å®ç°ï¼ˆäº’ç›¸å…³è¿ç®—ã€å¡«å……paddingã€æ­¥é•¿strideã€å¤šé€šé“ï¼‰</h3><p>å…·ä½“å…¬å¼å°±ä¸å†è¿™é‡Œå±•å¼€ï¼Œddddã€‚</p><p>ç»è¿‡ä¸‹åˆ—çš„äºŒç»´å·ç§¯æ“ä½œä¼šå°†ï¼ˆnï¼Œmï¼‰ç»è¿‡ï¼ˆkï¼Œkï¼‰è½¬æ¢ä¸ºå¤§å°ï¼ˆn+1-kï¼Œm+1-kï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Conv2D</span>(nn.module):<br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,kernel_size</span>):<br>    <span class="hljs-built_in">super</span>().__init__()<br>    self.weight=nn.Parameter(torch.rand(kernel_size))<br>    self.bias=nn.Parameter(torch.zeros(<span class="hljs-number">1</span>))<br>  <br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self,x</span>):<br>    <span class="hljs-keyword">return</span> corr2d(x,self.weight)+self.bias<br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">corr2d</span>(<span class="hljs-params">X,k</span>):<br>    â€˜â€™â€˜è®¡ç®—äºŒç»´äº’ç›¸å…³è¿ç®—```<br>    h,w=k.shape<br>    Y=torch.zeros((X.shape[<span class="hljs-number">0</span>]-h+<span class="hljs-number">1</span>,X.shape[<span class="hljs-number">1</span>]-w+<span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Y.shape[<span class="hljs-number">0</span>]):<br>      <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Y.shape[<span class="hljs-number">1</span>]):<br>        Y[i,j]=(X[i:i+h,j:j+w]*K).<span class="hljs-built_in">sum</span>()<br>    <span class="hljs-keyword">return</span> Y<br></code></pre></td></tr></table></figure><p>ç›´æ¥è¿›è¡Œå·ç§¯æ“ä½œå¯ä»¥çœ‹å‡ºå‘é‡æ˜¯ä¼šå˜åŒ–çš„ï¼Œæˆ‘ä»¬è¿˜ä¼šæœ‰ä¸¤ç§æ“ä½œï¼šå¡«å……paddingå’Œæ­¥é•¿strideã€‚</p><p>é’ˆå¯¹äºŒç»´çš„å›¾åƒè¾¹ç¼˜ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦è®¾ç½®å¡«å……paddingæ¥ä¿ç•™å‘¨è¾¹ä¿¡æ¯ï¼Œé€šå¸¸æ˜¯å¡«å……0</p><p>ï¼ˆn,m)ç»è¿‡ï¼ˆkï¼Œkï¼‰åï¼Œå¡«å……pï¼Œå¾—åˆ°çš„ç»“æœä¸ºï¼ˆn+p+1-kï¼Œm+p+1-kï¼‰</p><p>é’ˆå¯¹æ¸…æ™°åº¦ä¸å¤Ÿçš„ç…§ç‰‡ï¼Œæˆ‘ä»¬å¯èƒ½è®¤ä¸ºå…¶ä¸­éƒ¨åˆ†åƒç´ å†—ä½™ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨æ­¥å¹…strideæ¥é™ä½é‡‡æ ·</p><p>ï¼ˆnï¼Œmï¼‰ç»è¿‡ï¼ˆkï¼Œkï¼‰åŠ ä¸Špä¹‹åsçš„è¾“å‡ºæ˜¯ï¼ˆï¼ˆn+p-k+sï¼‰//sï¼Œï¼ˆm+p-k+sï¼‰//s ï¼‰ï¼ˆå‘ä¸‹å–æ•´ï¼‰</p><ul><li><p>åœ¨äºŒç»´åŸºç¡€ä¸Šï¼Œç†è§£å¤šé€šé“å·ç§¯ï¼Œé¦–å…ˆæ˜¯å¤šé€šé“è¾“å‡ºä¸€ä¸ªçš„æƒ…å†µï¼Œå°±æ˜¯è®¾è®¡ä¸‰ä¸ªå·ç§¯æ ¸ç„¶åç›¸åŠ </p></li><li><p>ç„¶åå¤šé€šé“è¾“å…¥å¯¹åº”å¤šé€šé“è¾“å‡ºï¼Œå°±æ˜¯è®¾è®¡output*inputä¸ªå·ç§¯æ ¸ï¼Œç„¶åoutputçš„å·ç§¯æ ¸ç›¸åŠ å³å¯</p></li></ul><h3 id="13-cnnä¸æ·±åº¦ä¹‹é—´çš„å…³ç³»æ„Ÿå—é‡-receptive-field-æ±‡èšå±‚pooling"><a class="markdownIt-Anchor" href="#13-cnnä¸æ·±åº¦ä¹‹é—´çš„å…³ç³»æ„Ÿå—é‡-receptive-field-æ±‡èšå±‚pooling"></a> 1.3 CNNä¸æ·±åº¦ä¹‹é—´çš„å…³ç³»ï¼ˆæ„Ÿå—é‡ receptive- fieldã€æ±‡èšå±‚poolingï¼‰</h3><p>CNNä¸­æ„Ÿå—é‡çš„é—®é¢˜ï¼Œå¯¹äºä¸€ä¸ªï¼ˆ3ï¼Œ3ï¼‰æ‰€æ„Ÿå—çš„æ˜¯ä¸€ä¸ªï¼ˆ3ï¼Œ3ï¼‰çš„åŒºåŸŸï¼Œä½†æ˜¯å¦‚æœå†æœ‰ä¸€ä¸ªï¼ˆ3ï¼Œ3ï¼‰ä»–æ‰€æ„Ÿå—çš„å°±æ˜¯ï¼ˆ5ï¼Œ5ï¼‰çš„åŒºåŸŸã€‚å› æ­¤éšç€å·ç§¯å±‚æ•°çš„å¢åŠ ï¼Œå·ç§¯ç¥ç»è€ƒè™‘åˆ°çš„å€¼æ˜¯è¶Šæ¥è¶Šå¤§çš„ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h68shdk7wxj212i0nwwh2.jpg" alt="image-20220916215637261" /></p><p>è¿™é‡Œä¹Ÿä¼šå­˜åœ¨ä¸€ä¸ªtrade-offï¼Œæˆ‘ä»¬å¸Œæœ›å·ç§¯çš„ç»“æœæ„Ÿå—é‡ä¸ä¼šå¤ªå°ï¼Œè¿™æ ·æˆ‘å¯ä»¥å¾—åˆ°ä¸€äº›çº¹ç†ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿä¸å¸Œæœ›æ„Ÿå—é‡å¤ªå¤§ï¼Œä¸ç„¶æ‰€è®­ç»ƒå‡ºæ¥çš„CNNä¼šå¯¹è¾“å…¥æ•æ„Ÿï¼Œå› æ­¤åœ¨å¸¸è§çš„æ“ä½œä¸­æˆ‘ä»¬ä¼šä½¿ç”¨æ±‡èšå±‚æ¥å¯¹å·ç§¯ç»“æœè¿›è¡Œå¹³æ»‘æˆ–è€…é‡æ–°é‡‡æ ·ã€‚</p><h2 id="0x02-program-structure-analysis-with-pytorch-api"><a class="markdownIt-Anchor" href="#0x02-program-structure-analysis-with-pytorch-api"></a> 0x02 Program structure analysis with PyTorch API</h2><h3 id="21-ä»£ç æ•´ä½“æ¡†æ¶åˆ†æå°½å¯èƒ½è§£è€¦"><a class="markdownIt-Anchor" href="#21-ä»£ç æ•´ä½“æ¡†æ¶åˆ†æå°½å¯èƒ½è§£è€¦"></a> 2.1 ä»£ç æ•´ä½“æ¡†æ¶åˆ†æï¼ˆå°½å¯èƒ½è§£è€¦ï¼‰</h3><p>é¦–å…ˆç¥ç»ç½‘ç»œçš„è®­ç»ƒå¿…ç„¶æ˜¯éœ€è¦å¤šä¸ªepochçš„ï¼ŒåŒæ—¶åœ¨æ¯è½®epochä¸­ç”±äºç‰©ç†ç©ºé—´çš„é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®batchsizeæ¥åˆ†æ‰¹çš„å°†æ•°æ®é€å…¥ç½‘ç»œï¼Œå½“æ‰€æœ‰çš„batchèµ°å®Œè¯´æ˜æˆ‘ä»¬å®Œæˆä¸€ä¸ªepochï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦è®°å½•è®­ç»ƒæŸå¤±ï¼ˆtrain-lossï¼‰ï¼Œè®­ç»ƒç²¾åº¦ï¼ˆtrain-accï¼‰å’ŒéªŒè¯ç²¾åº¦ï¼ˆvalid- accï¼‰ã€‚æ‰€ä»¥æ­¥éª¤åˆ†ä¸ºï¼š</p><ul><li>ç¬¬ä¸€éƒ¨åˆ†<br />è¾“å…¥ï¼šåŸå§‹æ•°æ®é›†ï¼Œbatchsize<br />è¾“å‡ºï¼šè®­ç»ƒæ•°æ®é›†ï¼ˆå¯è¿­ä»£å½¢å¼ï¼‰ã€éªŒè¯æ•°æ®é›†ï¼ˆå¯è¿­ä»£å½¢å¼ï¼‰</li><li>ç¬¬äºŒéƒ¨åˆ†<br />è¾“å…¥ï¼šç½‘ç»œç»“æ„ã€å­¦ä¹ ç‡lr<br />è¾“å‡ºï¼šç½‘ç»œç»“æ„netã€æŸå¤±å‡½æ•°lossã€ä¼˜åŒ–ç®—æ³•trainer</li><li>ç¬¬ä¸‰éƒ¨åˆ†<br />è¾“å…¥ï¼šepochæ•°é‡num- epochesï¼Œè®­ç»ƒæ•°æ®é›†ã€éªŒè¯æ•°æ®é›†ã€netã€lossã€trainerç­‰<br />è¾“å‡ºï¼šè®­ç»ƒå¥½çš„ç½‘ç»œï¼Œè¯„ä¼°æŒ‡æ ‡</li></ul><h3 id="22-pytorché«˜æ•ˆapi"><a class="markdownIt-Anchor" href="#22-pytorché«˜æ•ˆapi"></a> 2.2 PyTorché«˜æ•ˆAPI</h3><p>è¿™ä¸ªçœ‹å®˜ç½‘ï¼Œæˆ–è€…çœ‹åˆ«äººçš„ä»£ç å¤šæ‚Ÿå°±è¡Œ</p><ul><li><p><a href="https://pytorch.org/tutorials/beginner/basics/data_tutorial.html#">åŠ è½½æ•°æ®é›†</a><br />dataset<br />dataloader</p></li><li><p><a href="https://pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html">å®šä¹‰ç½‘ç»œ</a><br />torch.nn.module<br />Torch.nn.sequential</p></li><li><p><a href="https://pytorch.org/tutorials/recipes/recipes/what_is_state_dict.html">è®¿é—®ä¸åˆå§‹åŒ–å‚æ•°</a><br />net.apply()</p><p>def <em>init_weigths</em>(self)</p></li></ul><h2 id="0x03-code-of-lenet"><a class="markdownIt-Anchor" href="#0x03-code-of-lenet"></a> 0x03 Code of LeNet</h2><h3 id="30-lenetç®€ä»‹"><a class="markdownIt-Anchor" href="#30-lenetç®€ä»‹"></a> 3.0 <a href="http://vision.stanford.edu/cs598_spring07/papers/Lecun98.pdf">LeNetç®€ä»‹</a></h3><p>LeNetæ˜¯æœ€æ—©å‘å¸ƒçš„å·ç§¯ç¥ç»ç½‘ç»œï¼Œèµ·æºäº89å¹´ï¼Œåœ¨å½“æ—¶è¿˜æ²¡æœ‰å¼ºç®—åŠ›çš„æ—¶ä»£ï¼Œè¢«å¹¿æ³›åº”ç”¨äºATMæœºå™¨ä¸­ï¼Œå¸®åŠ©å¤„ç†æ”¯ç¥¨ä¸­çš„æ•°å­—</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h68t728nuaj211w0ciq4r.jpg" alt="image-20220916222118334" /></p><p>è¿™é‡Œå› ä¸ºFashion-MNISTæ˜¯ï¼ˆ28ï¼Œ28ï¼‰çš„æ•°æ®é›†ï¼Œå› æ­¤åœ¨è¿™ä¸ªåŸºç¡€ä¸Šç¨å¾®æ›´æ”¹ä¸€ä¸‹</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h68t9c7iw3j214k0i4gng.jpg" alt="image-20220916222329819" /></p><p>å„å±‚å‚æ•°è®¾ç½®ï¼š</p><p>è¾“å…¥ï¼šï¼ˆ28ï¼Œ28ï¼‰<br />ç¬¬ä¸€å±‚ï¼šï¼ˆ5ï¼Œ5ï¼‰å·ç§¯ï¼Œè¾“å‡º6é€šé“ï¼Œå¡«å……=2 -&gt;è¾“å‡ºï¼ˆ6ï¼Œ28ï¼Œ28ï¼‰<br />ç¬¬äºŒå±‚ï¼šï¼ˆ2ï¼Œ2ï¼‰æ± åŒ–ï¼Œæ­¥é•¿=2 -&gt; è¾“å‡ºï¼ˆ6ï¼Œ14ï¼Œ14ï¼‰<br />ç¬¬ä¸‰å±‚ï¼šï¼ˆ5ï¼Œ5ï¼‰å·ç§¯ï¼Œè¾“å‡º16é€šé“ï¼Œ-&gt;è¾“å‡ºï¼ˆ16ï¼Œ10ï¼Œ10ï¼‰<br />ç¬¬å››å±‚ï¼šï¼ˆ2ï¼Œ2ï¼‰æ± åŒ–ï¼Œæ­¥é•¿=2 -&gt;è¾“å‡ºï¼ˆ16ï¼Œ5ï¼Œ5ï¼‰<br />ä¹‹åå±•å¹³</p><h3 id="31-æ•°æ®é›†è·å–"><a class="markdownIt-Anchor" href="#31-æ•°æ®é›†è·å–"></a> 3.1 æ•°æ®é›†è·å–</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># è¯»å–fashionæ•°æ®é›†</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_fashion_mnist</span>(<span class="hljs-params">batchsize</span>):<br>    <span class="hljs-keyword">import</span> torch<br>    <span class="hljs-keyword">from</span> torch.utils <span class="hljs-keyword">import</span> data<br>    <span class="hljs-keyword">import</span> torchvision<br>    <span class="hljs-keyword">from</span> torchvision <span class="hljs-keyword">import</span> transforms<br><br>    trans=transforms.ToTensor()<br>    train_mnist=torchvision.datasets.FashionMNIST(root=<span class="hljs-string">&#x27;../data/FashionMNIST&#x27;</span>,train=<span class="hljs-literal">True</span>,transform=trans,download=<span class="hljs-literal">True</span>)<br>    test_mnist=torchvision.datasets.FashionMNIST(root=<span class="hljs-string">&#x27;../data/FashionMNIST&#x27;</span>,train=<span class="hljs-literal">False</span>,transform=trans,download=<span class="hljs-literal">True</span>)<br>    train_iter=data.DataLoader(train_mnist,batch_size=batchsize,shuffle=<span class="hljs-literal">True</span>,num_workers=<span class="hljs-number">4</span>)<br>    test_iter=data.DataLoader(test_mnist,batch_size=batchsize,shuffle=<span class="hljs-literal">True</span>,num_workers=<span class="hljs-number">4</span>)<br>    <span class="hljs-keyword">return</span> train_iter,test_iter<br>    <br>batchsize=<span class="hljs-number">256</span><br>train_iter,test_iter=load_fashion_mnist(batchsize)<br></code></pre></td></tr></table></figure><h3 id="32-æ¨¡å‹å®šä¹‰"><a class="markdownIt-Anchor" href="#32-æ¨¡å‹å®šä¹‰"></a> 3.2 æ¨¡å‹å®šä¹‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch <br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br>net=nn.Sequential(<br>    nn.Conv2d(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>,kernel_size=<span class="hljs-number">5</span>,padding=<span class="hljs-number">2</span>),nn.Sigmoid(),<br>    nn.AvgPool2d(kernel_size=<span class="hljs-number">2</span>,stride=<span class="hljs-number">2</span>),<br>    nn.Conv2d(<span class="hljs-number">6</span>,<span class="hljs-number">16</span>,kernel_size=<span class="hljs-number">5</span>),nn.Sigmoid(),<br>    nn.AvgPool2d(kernel_size=<span class="hljs-number">2</span>,stride=<span class="hljs-number">2</span>),<br>    nn.Flatten(),<br>    nn.Linear(<span class="hljs-number">16</span>*<span class="hljs-number">5</span>*<span class="hljs-number">5</span>,<span class="hljs-number">120</span>),nn.ReLU(),<br>    nn.Linear(<span class="hljs-number">120</span>,<span class="hljs-number">84</span>),nn.ReLU(),<br>    nn.Linear(<span class="hljs-number">84</span>,<span class="hljs-number">10</span>)<br>)<br></code></pre></td></tr></table></figure><h3 id="33-è®­ç»ƒè¿‡ç¨‹"><a class="markdownIt-Anchor" href="#33-è®­ç»ƒè¿‡ç¨‹"></a> 3.3 è®­ç»ƒè¿‡ç¨‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">accuracy</span>(<span class="hljs-params">y_hat,y</span>):<br>    <span class="hljs-comment"># æ•°æ­£ç¡®çš„æ•°é‡</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(y_hat.shape)&gt;<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> y_hat.shape[<span class="hljs-number">1</span>]&gt;<span class="hljs-number">1</span>:<br>        y_hat=y_hat.argmax(axis=<span class="hljs-number">1</span>)<br>    cmp=y_hat.<span class="hljs-built_in">type</span>(y.dtype)==y<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">float</span>(cmp.<span class="hljs-built_in">type</span>(y.dtype).<span class="hljs-built_in">sum</span>())<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gpu_acc</span>(<span class="hljs-params">model,data_iter,device=<span class="hljs-literal">None</span></span>):<br>    acc=<span class="hljs-number">0</span><br>    num=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(net,nn.Module):<br>        net.<span class="hljs-built_in">eval</span>()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> device:<br>            device=<span class="hljs-built_in">next</span>(<span class="hljs-built_in">iter</span>(net.parameters())).device<br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        <span class="hljs-keyword">for</span> X,y <span class="hljs-keyword">in</span> data_iter:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(X,<span class="hljs-built_in">list</span>):<br>                <span class="hljs-comment"># è¿™é‡Œçš„ifä»…ä»…æ˜¯ä¸ºä¹‹åbertå¾®è°ƒæ‰€éœ€çš„</span><br>                X=[x.to(device) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> X]<br>            <span class="hljs-keyword">else</span>:<br>                X=X.to(device)<br>            y=y.to(device)<br>            acc+=accuracy(net(X),y)<br>            num+=y.numel()<br>    <span class="hljs-keyword">return</span> acc/num<br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">trainer</span>(<span class="hljs-params">net,train_iter,test_iter,num_epoches,lr,device</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;ç”¨GPUè®­ç»ƒæ¨¡å‹&#x27;&#x27;&#x27;</span><br>    <span class="hljs-comment">#åˆå§‹åŒ–å‚æ•°</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">init_weights</span>(<span class="hljs-params">m</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(m)==nn.Linear <span class="hljs-keyword">or</span> <span class="hljs-built_in">type</span>(m)==nn.Conv2d:<br>            nn.init.xavier_uniform_(m.weight)<br>            <span class="hljs-comment">#nn.init.normal_(m.weight,std=0.01)</span><br>    net.apply(init_weights)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;training on&#x27;</span>,device)<br>    <span class="hljs-built_in">print</span>(torch.cuda.get_device_name(<span class="hljs-number">0</span>))<br>    net.to(device)<br>    optimizer=torch.optim.SGD(net.parameters(),lr=lr)<br>    loss=nn.CrossEntropyLoss()<br><br>    train_acc=[]<br>    test_acc=[]<br>    loss_epoches=[]<br>    <span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_epoches):<br>        temp_train_acc=<span class="hljs-number">0</span><br>        loss_epoch=<span class="hljs-number">0</span><br>        num=<span class="hljs-number">0</span><br>        net.train()<br>        <span class="hljs-keyword">for</span> i,(X,y) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(train_iter):<br>            optimizer.zero_grad()<br>            X,y=X.to(device),y.to(device)<br>            <span class="hljs-keyword">with</span> torch.no_grad():<br>                temp_train_acc+=accuracy(net(X),y)<br>            y_hat=net(X)<br>            l=loss(y_hat,y)<br>            l.backward()<br>            optimizer.step()<br>            loss_epoch+=l*X.shape[<span class="hljs-number">0</span>]<br>            num+=y.numel()<br>        train_acc.append(<span class="hljs-built_in">float</span>(temp_train_acc/num))<br>        test_acc.append(gpu_acc(net,test_iter))<br>        loss_epoches.append(<span class="hljs-built_in">float</span>(loss_epoch)/num)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æœ¬è½®&#123;&#125;è®­ç»ƒçš„ç»“æœï¼Œtestâ€”acc:&#123;&#125;,train-acc:&#123;&#125;,train-loss:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(epoch+<span class="hljs-number">1</span>),<span class="hljs-built_in">str</span>(test_acc[-<span class="hljs-number">1</span>]),<span class="hljs-built_in">str</span>(train_acc[-<span class="hljs-number">1</span>]),<span class="hljs-built_in">str</span>(loss_epoches[-<span class="hljs-number">1</span>])))<br>    <span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>    plt.plot(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>+num_epoches)),test_acc,label=<span class="hljs-string">&#x27;test_acc&#x27;</span>)<br>    plt.plot(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>+num_epoches)),train_acc,label=<span class="hljs-string">&#x27;train_acc&#x27;</span>)<br>    plt.plot(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>+num_epoches)),loss_epoches,label=<span class="hljs-string">&#x27;loss&#x27;</span>)<br>    plt.legend()<br>    plt.show()<br>    <br>        <br>lr,num_epoches=<span class="hljs-number">0.2</span>,<span class="hljs-number">20</span><br><br><br>device = torch.device(<span class="hljs-string">&quot;cuda:0&quot;</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;cpu&quot;</span>)<br>trainer(net,train_iter,test_iter,num_epoches,lr,device)<br></code></pre></td></tr></table></figure><h3 id="34-è®­ç»ƒç»“æœ"><a class="markdownIt-Anchor" href="#34-è®­ç»ƒç»“æœ"></a> 3.4 è®­ç»ƒç»“æœ</h3><p>ï¼ˆç§€ä¸€ä¸‹3090ï½ï¼‰</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h68tekxc64j21540rigut.jpg" alt="image-20220916222831979" /></p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h68teqwf2cj20vo0nuaba.jpg" alt="image-20220916222841744" /></p><p>CS229ä¸­å…³äºæ¨¡å‹é€‰æ‹©ä¸­çš„bias- variance trade offåœ¨è¿™é‡Œä¾æ—§é€‚ç”¨</p><h2 id="0x04-discussion-and-conclusion"><a class="markdownIt-Anchor" href="#0x04-discussion-and-conclusion"></a> 0x04 Discussion and conclusion</h2><h3 id="41-moduleå’Œsequentialä¹‹é—´çš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#41-moduleå’Œsequentialä¹‹é—´çš„åŒºåˆ«"></a> 4.1 moduleå’Œsequentialä¹‹é—´çš„åŒºåˆ«ï¼Ÿ</h3><p><a href="https://stackoverflow.com/questions/68606661/what-is-difference-between-nn-module-and-nn-sequential">What is difference between nn.Module and nn.Sequential</a></p><p>ä½¿ç”¨moduleå®šä¹‰æ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦é¢å¤–def forwardï¼Œå¯¹äºå·ç§¯ç¥ç»ç½‘ç»œè¿™ç§æŒ‰ç…§é¡ºåºçš„ç»“æ„å¹¶ä¸éœ€è¦å…³å¿ƒï¼Œæ‰€ä»¥å‰å‘ä¼ æ’­æ˜¯æŒ‰ç…§sequentialè¿›è¡Œçš„ï¼Œä½†æ˜¯åœ¨åé¢çš„å­¦ä¹ ä¸­æ›´ç°ä»£åŒ–çš„CNNæˆ–è€…RNNç­‰ä¼šè¿›è¡Œè¾“å‡ºçš„è¿ç§»ï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨moduleä¼šæ›´å¥½</p><h3 id="42-å½’ä¸€åŒ–-normalizationå’Œæ ‡å‡†åŒ–standardizationä¹‹é—´çš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#42-å½’ä¸€åŒ–-normalizationå’Œæ ‡å‡†åŒ–standardizationä¹‹é—´çš„åŒºåˆ«"></a> 4.2 å½’ä¸€åŒ– normalizationå’Œæ ‡å‡†åŒ–standardizationä¹‹é—´çš„åŒºåˆ«ï¼Ÿ</h3><p>ä¸å¤ªæ‡‚ï¼Œå…ˆç•™ç€</p><p><a href="https://blog.csdn.net/qq_35290785/article/details/89322289">å¯ä»¥å‚è€ƒè¿™ä¸ª</a></p><p>è¿˜æœ‰<a href="https://www.analyticsvidhya.com/blog/2020/04/feature-scaling-machine-learning-normalization-standardization/">è¿™ä¸ª</a></p><h3 id="43-å¦‚ä½•å†™å‡ºè§„èŒƒçš„ä»£ç "><a class="markdownIt-Anchor" href="#43-å¦‚ä½•å†™å‡ºè§„èŒƒçš„ä»£ç "></a> 4.3 å¦‚ä½•å†™å‡ºè§„èŒƒçš„ä»£ç ï¼Ÿ</h3><p>å¤šçœ‹åˆ«äººçš„ä»£ç </p><p>çœ‹å®Œè‡ªå·±æ•²å‡ºæ¥</p><h3 id="44-ä¸ºä»€ä¹ˆlossä¼šå¤§äº1"><a class="markdownIt-Anchor" href="#44-ä¸ºä»€ä¹ˆlossä¼šå¤§äº1"></a> 4.4 ä¸ºä»€ä¹ˆlossä¼šå¤§äº1</h3><p>è™½ç„¶è¯´çœ‹lossåªéœ€è¦ä¸‹é™å°±å¥½äº†ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆåœ¨meanä¹‹åè¿˜æ˜¯å¤§äº1</p><p>åœ¨æ‰‹æ•²å‡ºæ¥ä¸Šé¢çš„ä»£ç èƒ½å¤Ÿæ¸…æ™°çš„æ„Ÿå—åˆ°ï¼Œå·¥ç¨‹å¯¹äºè½¯ä»¶æ„å»ºçš„é‡è¦æ€§ï¼Œå¯èƒ½éœ€è¦å…ˆåšè§„åˆ’ï¼Ÿäº†è§£å¥½APIæ‰èƒ½ç”¨åˆ«äººçš„æŠ½è±¡å¥½çš„å·¥å…·å®ç°æ›´å¤šçš„åŠŸèƒ½ã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªç®€å•çš„wheelï¼Œä½†æ˜¯åœ¨åˆå§‹è§£çš„åŸºç¡€ä¸Šå¯ä»¥å†æ¬¡ä¼˜åŒ–</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä»‹ç»ä¸€ä¸ªåŸºæœ¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹çº¿æ€§å›å½’å®ç°çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œå°†å…¶æ­¥éª¤åˆ†ä¸ºå…«ä¸ªéƒ¨åˆ†ã€‚ä¹‹åD2Lä¸­ä»‹ç»äº†soft Maxã€MLPç­‰ç®€å•çš„æ¨¡å‹ã€‚è¿™é‡Œè¿ˆå‘æ·±åº¦å­¦ä¹ ï¼Œåˆ©ç”¨ç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œæ¥ä»‹ç»æ·±åº¦å­¦ä¹ APIçš„ä½¿ç”¨è¿‡ç¨‹ï¼Œä»é›¶å¼€å§‹æ­å»ºæ¨¡å‹ï¼Œå°†å…¶åˆ†ä¸ºæ•°æ®é›†é¢„å¤„ç†ã€æ„å»ºæ¨¡å‹å’Œè®­ç»ƒåŠè¯„ä¼°ä¸‰ä¸ªæ­¥éª¤ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="ML&amp;DL" scheme="https://blog.tjdata.site/categories/ML-DL/"/>
    
    
    <category term="D2L" scheme="https://blog.tjdata.site/tags/D2L/"/>
    
  </entry>
  
</feed>
